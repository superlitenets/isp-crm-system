isp_crm_freeradius  | (1) # Executing group from file /etc/freeradius/sites-enabled/default
isp_crm_freeradius  | (1)   Auth-Type PAP {
isp_crm_freeradius  | (1) pap: Login attempt with password
isp_crm_freeradius  | (1) pap: Comparing with "known good" Cleartext-Password
isp_crm_freeradius  | (1) pap: ERROR: Cleartext password does not match "known good" password
isp_crm_freeradius  | (1) pap: Passwords don't match
isp_crm_freeradius  | (1)     [pap] = reject
isp_crm_freeradius  | (1)   } # Auth-Type PAP = reject
isp_crm_freeradius  | (1) Failed to authenticate the user
isp_crm_freeradius  | (1) Using Post-Auth-Type Reject
isp_crm_freeradius  | (1) # Executing group from file /etc/freeradius/sites-enabled/default
isp_crm_freeradius  | (1)   Post-Auth-Type REJECT {
isp_crm_freeradius  | (1) sql: EXPAND .query
isp_crm_freeradius  | (1) sql:    --> .query
isp_crm_freeradius  | (1) sql: Using query template 'query'
isp_crm_freeradius  | rlm_sql (sql): Reserved connection (3)
isp_crm_freeradius  | (1) sql: EXPAND %{%{Stripped-User-Name}:-%{%{User-Name}:-DEFAULT}}
isp_crm_freeradius  | (1) sql:    --> SFL002
isp_crm_freeradius  | (1) sql: SQL-User-Name set to 'SFL002'
isp_crm_freeradius  | (1) sql: EXPAND INSERT INTO radius_auth_logs (subscription_id, username, nas_ip_address, mac_address, auth_result, reject_reason, created_at) SELECT rs.id, '%{SQL-User-Name}', '%{NAS-IP-Address}', '%{Calling-Station-Id}', CASE WHEN '%{reply:Packet-Type}' = 'Access-Accept' THEN 'Accept' ELSE 'Reject' END, CASE WHEN '%{reply:Packet-Type}' = 'Access-Accept' THEN 'Active user' WHEN '%{reply:Reply-Message}' != '' THEN '%{reply:Reply-Message}' ELSE 'Authentication failed' END, NOW() FROM radius_subscriptions rs WHERE rs.username = '%{SQL-User-Name}' UNION ALL SELECT NULL, '%{SQL-User-Name}', '%{NAS-IP-Address}', '%{Calling-Station-Id}', CASE WHEN '%{reply:Packet-Type}' = 'Access-Accept' THEN 'Accept' ELSE 'Reject' END, CASE WHEN '%{reply:Packet-Type}' = 'Access-Accept' THEN 'Unknown user - allowed' ELSE 'User not found' END, NOW() WHERE NOT EXISTS (SELECT 1 FROM radius_subscriptions WHERE username = '%{SQL-User-Name}') LIMIT 1
isp_crm_freeradius  | (1) sql:    --> INSERT INTO radius_auth_logs (subscription_id, username, nas_ip_address, mac_address, auth_result, reject_reason, created_at) SELECT rs.id, 'SFL002', '10.200.0.5', '04:33:89:74:47:08', CASE WHEN 'Access-Reject' = 'Access-Accept' THEN 'Accept' ELSE 'Reject' END, CASE WHEN 'Access-Reject' = 'Access-Accept' THEN 'Active user' WHEN '' != '' THEN '' ELSE 'Authentication failed' END, NOW() FROM radius_subscriptions rs WHERE rs.username = 'SFL002' UNION ALL SELECT NULL, 'SFL002', '10.200.0.5', '04:33:89:74:47:08', CASE WHEN 'Access-Reject' = 'Access-Accept' THEN 'Accept' ELSE 'Reject' END, CASE WHEN 'Access-Reject' = 'Access-Accept' THEN 'Unknown user - allowed' ELSE 'User not found' END, NOW() WHERE NOT EXISTS (SELECT 1 FROM radius_subscriptions WHERE username = 'SFL002') LIMIT 1
isp_crm_freeradius  | (1) sql: Executing query: INSERT INTO radius_auth_logs (subscription_id, username, nas_ip_address, mac_address, auth_result, reject_reason, created_at) SELECT rs.id, 'SFL002', '10.200.0.5', '04:33:89:74:47:08', CASE WHEN 'Access-Reject' = 'Access-Accept' THEN 'Accept' ELSE 'Reject' END, CASE WHEN 'Access-Reject' = 'Access-Accept' THEN 'Active user' WHEN '' != '' THEN '' ELSE 'Authentication failed' END, NOW() FROM radius_subscriptions rs WHERE rs.username = 'SFL002' UNION ALL SELECT NULL, 'SFL002', '10.200.0.5', '04:33:89:74:47:08', CASE WHEN 'Access-Reject' = 'Access-Accept' THEN 'Accept' ELSE 'Reject' END, CASE WHEN 'Access-Reject' = 'Access-Accept' THEN 'Unknown user - allowed' ELSE 'User not found' END, NOW() WHERE NOT EXISTS (SELECT 1 FROM radius_subscriptions WHERE username = 'SFL002') LIMIT 1
isp_crm_freeradius  | rlm_sql_postgresql: Status: PGRES_COMMAND_OK
isp_crm_freeradius  | rlm_sql_postgresql: query affected rows = 1
isp_crm_freeradius  | (1) sql: SQL query returned: success
isp_crm_freeradius  | (1) sql: 1 record(s) updated
isp_crm_freeradius  | rlm_sql (sql): Released connection (3)
isp_crm_freeradius  | (1)     [sql] = ok
isp_crm_freeradius  | (1)     if (&reply:Framed-Pool) {
isp_crm_freeradius  | (1)     if (&reply:Framed-Pool)  -> FALSE
isp_crm_freeradius  | (1)   } # Post-Auth-Type REJECT = ok
isp_crm_freeradius  | (1) Login incorrect (pap: Cleartext password does not match "known good" password): [SFL002/Kenya] (from client vpn_clients port 15729132 cli 04:33:89:74:47:08)
isp_crm_freeradius  | (1) Delaying response for 1.000000 seconds
isp_crm_freeradius  | Waking up in 0.2 seconds.
isp_crm_freeradius  | Waking up in 0.7 seconds.
isp_crm_freeradius  | (1) Sending delayed response
isp_crm_freeradius  | (1) Sent Access-Reject Id 136 from 172.18.0.4:1812 to 10.200.0.5:36948 length 40
isp_crm_freeradius  | (1)   Mikrotik-Rate-Limit = "5M/10M"
isp_crm_freeradius  | (1)   Session-Timeout = 2592000
isp_crm_freeradius  | Waking up in 3.9 seconds.
isp_crm_freeradius  | (1) Sending duplicate reply to client vpn_clients port 36948 - ID: 136
isp_crm_freeradius  | Waking up in 8.9 seconds.
