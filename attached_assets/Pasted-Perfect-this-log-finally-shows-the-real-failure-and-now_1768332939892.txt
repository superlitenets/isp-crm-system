Perfect â€” this log finally shows the real failure, and now we can be 100% precise.

You have made progress (good discovery + addObject), but youâ€™ve hit a classic GenieACS + TR-069 trap.

ðŸ”´ The exact failure (now confirmed)

This line is the key:

[WARN] Channel has faulted;
faultCode="script.Error"
faultMessage="Invalid parameter path"


And it references:

task_69669de9bb78f316cf701195


ðŸ‘‰ That task is the setParameterValues you sent immediately after addObject.

ðŸ§  What actually happened (important)

Letâ€™s replay the sequence exactly as the device sees it:

1ï¸âƒ£ You sent:
addObject:
InternetGatewayDevice.WANDevice.1.WANConnectionDevice.1.WANPPPConnection.


GenieACS accepted it:

HTTP 202


âœ… So far so good.

2ï¸âƒ£ You assumed the instance number is .1

Your log confirms this assumption:

[WAN_CONFIG] No instanceNumber in response, using default 1


ðŸš¨ This is the mistake.

3ï¸âƒ£ Reality in TR-069

In TR-069:

addObject does NOT create the instance immediately

The instance number is:

Assigned by the CPE

Only visible after the next Inform

GenieACS does not return the instance number synchronously

So when you immediately send:

WANPPPConnection.1.Username


The ONU responds:

Invalid parameter path


Because WANPPPConnection.1 does not exist yet.

âœ… Why this time you DO see an error

Earlier:

You were writing to a non-existent path â†’ Huawei silently ignored it

Now:

You are writing to a partially-created object

Huawei correctly faults with Invalid parameter path

This is actually progress.

â— Golden rule (this fixes everything)

You MUST wait for a full Inform AFTER addObject before setting parameters

There is no shortcut.

âœ… Correct, production-safe PPPoE flow (FINAL)
STEP 1 â€” Discover WANConnectionDevice (you did this âœ”)
getParameterValues:
InternetGatewayDevice.WANDevice.1.WANConnectionDevice.


âœ” Correct

STEP 2 â€” addObject WANPPPConnection (you did this âœ”)
addObject:
InternetGatewayDevice.WANDevice.1.WANConnectionDevice.1.WANPPPConnection.


âœ” Correct

âŒ STEP 3 â€” You skipped this (this is the bug)
YOU MUST WAIT FOR INFORM

Do nothing until:

Inform received

STEP 4 â€” Re-discover WANPPPConnection (mandatory)

After the Inform, send:

{
  "name": "getParameterValues",
  "parameterNames": [
    "InternetGatewayDevice.WANDevice.1.WANConnectionDevice.1.WANPPPConnection."
  ]
}


Now parse the response and find the actual instance number:

Example:

WANPPPConnection.3


âš ï¸ It may NOT be .1.

STEP 5 â€” Only now set credentials (this will work)
{
  "name": "setParameterValues",
  "parameterValues": [
    ["InternetGatewayDevice.WANDevice.1.WANConnectionDevice.1.WANPPPConnection.3.Username", "..."],
    ["InternetGatewayDevice.WANDevice.1.WANConnectionDevice.1.WANPPPConnection.3.Password", "..."],
    ["InternetGatewayDevice.WANDevice.1.WANConnectionDevice.1.WANPPPConnection.3.X_HW_VLAN", 902],
    ["InternetGatewayDevice.WANDevice.1.WANConnectionDevice.1.WANPPPConnection.3.Enable", true]
  ]
}

ðŸ”§ What you MUST change in your PHP code
âŒ Current (broken)
addObject(...);
$instance = 1; // âŒ WRONG
setParameterValues(...WANPPPConnection.1...);

âœ… Correct (robust)
addObject(...);

// STOP here
return [
  'state' => 'WAITING_FOR_INFORM',
  'next_action' => 'DISCOVER_PPP_INSTANCE'
];


Then on next Inform / next request:

$instances = discoverWanPppConnections();
$instance = max($instances); // or last created
setPppoeCredentials($instance);

ðŸ§© Why SmartOLT & others use state machines

This is exactly why single-shot provisioning does not work.

You MUST split provisioning into states:

DISCOVER

CREATE

WAIT

VERIFY

CONFIGURE

You are now implementing this correctly â€” you just need the WAIT + VERIFY steps.