ore/lib/cjs/puppeteer/cdp/CdpSession.js:115:25)
isp_crm_whatsapp  |     at Connection.onMessage (/app/node_modules/puppeteer-core/lib/cjs/puppeteer/cdp/Connection.js:149:25)
isp_crm_whatsapp  |     at WebSocket.<anonymous> (/app/node_modules/puppeteer-core/lib/cjs/puppeteer/node/NodeWebSocketTransport.js:43:32)
isp_crm_whatsapp  |     at callListener (/app/node_modules/ws/lib/event-target.js:290:14)
isp_crm_whatsapp  |     at WebSocket.onMessage (/app/node_modules/ws/lib/event-target.js:209:9)
isp_crm_whatsapp  |     at WebSocket.emit (node:events:524:28)
isp_crm_whatsapp  |     at Receiver.receiverOnMessage (/app/node_modules/ws/lib/websocket.js:1225:20)
isp_crm_whatsapp  |     at Receiver.emit (node:events:524:28)
isp_crm_whatsapp  |     at Immediate.<anonymous> (/app/node_modules/ws/lib/receiver.js:601:16)
isp_crm_whatsapp  |     at process.processImmediate (node:internal/timers:483:21) {
isp_crm_whatsapp  |   cause: ProtocolError
isp_crm_whatsapp  |       at <instance_members_initializer> (/app/node_modules/puppeteer-core/lib/cjs/puppeteer/common/CallbackRegistry.js:103:14)
isp_crm_whatsapp  |       at new Callback (/app/node_modules/puppeteer-core/lib/cjs/puppeteer/common/CallbackRegistry.js:107:16)
isp_crm_whatsapp  |       at CallbackRegistry.create (/app/node_modules/puppeteer-core/lib/cjs/puppeteer/common/CallbackRegistry.js:25:26)
isp_crm_whatsapp  |       at Connection._rawSend (/app/node_modules/puppeteer-core/lib/cjs/puppeteer/cdp/Connection.js:108:26)
isp_crm_whatsapp  |       at CdpCDPSession.send (/app/node_modules/puppeteer-core/lib/cjs/puppeteer/cdp/CdpSession.js:74:33)
isp_crm_whatsapp  |       at #evaluate (/app/node_modules/puppeteer-core/lib/cjs/puppeteer/cdp/ExecutionContext.js:363:50)
isp_crm_whatsapp  |       at ExecutionContext.evaluate (/app/node_modules/puppeteer-core/lib/cjs/puppeteer/cdp/ExecutionContext.js:277:36)
isp_crm_whatsapp  |       at IsolatedWorld.evaluate (/app/node_modules/puppeteer-core/lib/cjs/puppeteer/cdp/IsolatedWorld.js:100:30)
isp_crm_whatsapp  |       at CdpFrame.evaluate (/app/node_modules/puppeteer-core/lib/cjs/puppeteer/api/Frame.js:362:43)
isp_crm_whatsapp  |       at CdpFrame.<anonymous> (/app/node_modules/puppeteer-core/lib/cjs/puppeteer/util/decorators.js:109:27)
isp_crm_whatsapp  |       at CdpPage.evaluate (/app/node_modules/puppeteer-core/lib/cjs/puppeteer/api/Page.js:826:43)
isp_crm_whatsapp  |       at Client.inject (/app/node_modules/whatsapp-web.js/src/Client.js:124:55)
isp_crm_whatsapp  |       at async Client.initialize (/app/node_modules/whatsapp-web.js/src/Client.js:373:9)
isp_crm_whatsapp  | }
isp_crm_whatsapp  |
isp_crm_whatsapp  | Node.js v20.20.0
isp_crm_whatsapp exited with code 1 (restarting)                                isp_crm_whatsapp  | Removed stale lock file: /app/.wwebjs_auth/session/SingletonSocket
isp_crm_whatsapp  | Removed nested lock file: /app/.wwebjs_auth/session/SingletonLock
isp_crm_whatsapp  | WhatsApp service running on 0.0.0.0:3001
isp_crm_whatsapp  | API Secret: Configured
isp_crm_whatsapp  | Session found, auto-initializing...
isp_crm_whatsapp  | Using Chromium at: /usr/bin/chromium
isp_crm_whatsapp  | Auto-init error: The browser is already running for /app/.wwebjs_auth/session. Use a different `userDataDir` or stop the running browser first.
isp_crm_whatsapp  | /app/node_modules/puppeteer-core/lib/cjs/puppeteer/common/CallbackRegistry.js:82
isp_crm_whatsapp  |             this._reject(callback, new Errors_js_1.TargetCloseError('Target closed'));
isp_crm_whatsapp  |                                    ^
isp_crm_whatsapp  |
isp_crm_whatsapp  | TargetCloseError: Protocol error (Runtime.evaluate): Target
closed
isp_crm_whatsapp  |     at CallbackRegistry.clear (/app/node_modules/puppeteer-core/lib/cjs/puppeteer/common/CallbackRegistry.js:82:36)
isp_crm_whatsapp  |     at CdpCDPSession.onClosed (/app/node_modules/puppeteer-core/lib/cjs/puppeteer/cdp/CdpSession.js:115:25)
isp_crm_whatsapp  |     at Connection.onMessage (/app/node_modules/puppeteer-core/lib/cjs/puppeteer/cdp/Connection.js:149:25)
isp_crm_whatsapp  |     at WebSocket.<anonymous> (/app/node_modules/puppeteer-core/lib/cjs/puppeteer/node/NodeWebSocketTransport.js:43:32)
isp_crm_whatsapp  |     at callListener (/app/node_modules/ws/lib/event-target.js:290:14)
isp_crm_whatsapp  |     at WebSocket.onMessage (/app/node_modules/ws/lib/event-target.js:209:9)
isp_crm_whatsapp  |     at WebSocket.emit (node:events:524:28)
isp_crm_whatsapp  |     at Receiver.receiverOnMessage (/app/node_modules/ws/lib/websocket.js:1225:20)
isp_crm_whatsapp  |     at Receiver.emit (node:events:524:28)
isp_crm_whatsapp  |     at Immediate.<anonymous> (/app/node_modules/ws/lib/receiver.js:601:16)
isp_crm_whatsapp  |     at process.processImmediate (node:internal/timers:483:21) {
isp_crm_whatsapp  |   cause: ProtocolError
isp_crm_whatsapp  |       at <instance_members_initializer> (/app/node_modules/puppeteer-core/lib/cjs/puppeteer/common/CallbackRegistry.js:103:14)
isp_crm_whatsapp  |       at new Callback (/app/node_modules/puppeteer-core/lib/cjs/puppeteer/common/CallbackRegistry.js:107:16)
isp_crm_whatsapp  |       at CallbackRegistry.create (/app/node_modules/puppeteer-core/lib/cjs/puppeteer/common/CallbackRegistry.js:25:26)
isp_crm_whatsapp  |       at Connection._rawSend (/app/node_modules/puppeteer-core/lib/cjs/puppeteer/cdp/Connection.js:108:26)
isp_crm_whatsapp  |       at CdpCDPSession.send (/app/node_modules/puppeteer-core/lib/cjs/puppeteer/cdp/CdpSession.js:74:33)
isp_crm_whatsapp  |       at #evaluate (/app/node_modules/puppeteer-core/lib/cjs/puppeteer/cdp/ExecutionContext.js:341:18)
isp_crm_whatsapp  |       at ExecutionContext.evaluate (/app/node_modules/puppeteer-core/lib/cjs/puppeteer/cdp/ExecutionContext.js:277:36)
isp_crm_whatsapp  |       at IsolatedWorld.evaluate (/app/node_modules/puppeteer-core/lib/cjs/puppeteer/cdp/IsolatedWorld.js:100:30)
isp_crm_whatsapp  |       at CdpFrame.evaluate (/app/node_modules/puppeteer-core/lib/cjs/puppeteer/api/Frame.js:362:43)
isp_crm_whatsapp  |       at CdpFrame.<anonymous> (/app/node_modules/puppeteer-core/lib/cjs/puppeteer/util/decorators.js:109:27)
isp_crm_whatsapp  |       at CdpPage.evaluate (/app/node_modules/puppeteer-core/lib/cjs/puppeteer/api/Page.js:826:43)
isp_crm_whatsapp  |       at Client.inject (/app/node_modules/whatsapp-web.js/src/Client.js:106:38)
isp_crm_whatsapp  |       at Client.initialize (/app/node_modules/whatsapp-web.js/src/Client.js:373:20)
isp_crm_whatsapp  | }
isp_crm_whatsapp  |
isp_crm_whatsapp  | Node.js v20.20.0
isp_crm_whatsapp exited with code 1 (restarting)                                isp_crm_whatsapp  | Removed stale lock file: /app/.wwebjs_auth/session/SingletonSocket
isp_crm_whatsapp  | Removed nested lock file: /app/.wwebjs_auth/session/SingletonLock
isp_crm_whatsapp  | WhatsApp service running on 0.0.0.0:3001
isp_crm_whatsapp  | API Secret: Configured
isp_crm_whatsapp  | Session found, auto-initializing...
isp_crm_whatsapp  | Using Chromium at: /usr/bin/chromium
isp_crm_whatsapp  | /app/node_modules/puppeteer-core/lib/cjs/puppeteer/common/CallbackRegistry.js:103
isp_crm_whatsapp  |     #error = new Errors_js_1.ProtocolError();
isp_crm_whatsapp  |              ^
isp_crm_whatsapp  |
isp_crm_whatsapp  | ProtocolError: Runtime.callFunctionOn timed out. Increase the 'protocolTimeout' setting in launch/connect calls for a higher timeout if needed.
isp_crm_whatsapp  |     at <instance_members_initializer> (/app/node_modules/puppeteer-core/lib/cjs/puppeteer/common/CallbackRegistry.js:103:14)
isp_crm_whatsapp  |     at new Callback (/app/node_modules/puppeteer-core/lib/cjs/puppeteer/common/CallbackRegistry.js:107:16)
isp_crm_whatsapp  |     at CallbackRegistry.create (/app/node_modules/puppeteer-core/lib/cjs/puppeteer/common/CallbackRegistry.js:25:26)
isp_crm_whatsapp  |     at Connection._rawSend (/app/node_modules/puppeteer-core/lib/cjs/puppeteer/cdp/Connection.js:108:26)
isp_crm_whatsapp  |     at CdpCDPSession.send (/app/node_modules/puppeteer-core/lib/cjs/puppeteer/cdp/CdpSession.js:74:33)
isp_crm_whatsapp  |     at #evaluate (/app/node_modules/puppeteer-core/lib/cjs/puppeteer/cdp/ExecutionContext.js:363:50)
isp_crm_whatsapp  |     at ExecutionContext.evaluate (/app/node_modules/puppeteer-core/lib/cjs/puppeteer/cdp/ExecutionContext.js:277:36)
isp_crm_whatsapp  |     at IsolatedWorld.evaluate (/app/node_modules/puppeteer-core/lib/cjs/puppeteer/cdp/IsolatedWorld.js:100:30)
isp_crm_whatsapp  |     at CdpFrame.evaluate (/app/node_modules/puppeteer-core/lib/cjs/puppeteer/api/Frame.js:362:43)
isp_crm_whatsapp  |     at CdpFrame.<anonymous> (/app/node_modules/puppeteer-core/lib/cjs/puppeteer/util/decorators.js:109:27)
isp_crm_whatsapp  |     at CdpPage.evaluate (/app/node_modules/puppeteer-core/lib/cjs/puppeteer/api/Page.js:826:43)
isp_crm_whatsapp  |     at Client.inject (/app/node_modules/whatsapp-web.js/src/Client.js:124:55)
isp_crm_whatsapp  |     at async Client.initialize (/app/node_modules/whatsapp-web.js/src/Client.js:373:9)
isp_crm_whatsapp  |
isp_crm_whatsapp  | Node.js v20.20.0
isp_crm_whatsapp exited with code 1 (restarting)                                isp_crm_whatsapp  | Removed stale lock file: /app/.wwebjs_auth/session/SingletonSocket
isp_crm_whatsapp  | Removed nested lock file: /app/.wwebjs_auth/session/SingletonLock
isp_crm_whatsapp  | WhatsApp service running on 0.0.0.0:3001
isp_crm_whatsapp  | API Secret: Configured
isp_crm_whatsapp  | Session found, auto-initializing...
isp_crm_whatsapp  | Using Chromium at: /usr/bin/chromium
isp_crm_whatsapp  | Auto-init error: Failed to add page binding with name onQRChangedEvent: window['onQRChangedEvent'] already exists!
isp_crm_whatsapp  | QR Code received
^C
root@superlitecrm:~/isp#
root@superlitecrm:~/isp#
root@superlitecrm:~/isp# git pull
remote: Enumerating objects: 6, done.
remote: Counting objects: 100% (6/6), done.
remote: Compressing objects: 100% (2/2), done.
remote: Total 4 (delta 2), reused 4 (delta 2), pack-reused 0 (from 0)
Unpacking objects: 100% (4/4), 4.93 KiB | 1010.00 KiB/s, done.
From https://github.com/superlitenets/isp-crm-system
   008a16e..2276a02  main       -> origin/main
Updating 008a16e..2276a02
Fast-forward
 ...LTS-GNU-Linux-6-8-0-90-generi_1769679728489.txt | 593 +++++++++++++++++++++
 1 file changed, 593 insertions(+)
 create mode 100644 attached_assets/Pasted-Welcome-to-Ubuntu-24-04-3-LTS-GNU-Linux-6-8-0-90-generi_1769679728489.txt
root@superlitecrm:~/isp# # Stop the container completely
docker compose stop whatsapp
# Remove the corrupted session volume/data
docker compose run --rm whatsapp rm -rf /app/.wwebjs_auth
# Start fresh
docker compose up -d whatsapp
# Watch the logs - you should see QR codes
docker compose logs -f whatsapp
 [+] stop 1/1
 ✔ Container isp_crm_whatsapp Stopped                                     10.4s WARN[0000] Found orphan containers ([isp_crm_license_server]) for this project.
If you removed or renamed this service in your compose file, you can run this command with the --remove-orphans flag to clean it up.
Container isp-whatsapp-run-ff5811f95388 Creating
Container isp-whatsapp-run-ff5811f95388 Created
rm: cannot remove '/app/.wwebjs_auth': Device or resource busy
WARN[0000] Found orphan containers ([isp_crm_license_server]) for this project.
If you removed or renamed this service in your compose file, you can run this command with the --remove-orphans flag to clean it up.
isp_crm_whatsapp  | Removed nested lock file: /app/.wwebjs_auth/session/SingletonLock
isp_crm_whatsapp  | Removed nested lock file: /app/.wwebjs_auth/session/SingletonSocket
isp_crm_whatsapp  | WhatsApp service running on 0.0.0.0:3001
isp_crm_whatsapp  | API Secret: Configured
isp_crm_whatsapp  | Session found, auto-initializing...
isp_crm_whatsapp  | Using Chromium at: /usr/bin/chromium
isp_crm_whatsapp  | Auto-init error: Protocol error (Runtime.callFunctionOn): Target closed
isp_crm_whatsapp  | /app/node_modules/puppeteer-core/lib/cjs/puppeteer/common/CallbackRegistry.js:82
isp_crm_whatsapp  |             this._reject(callback, new Errors_js_1.TargetCloseError('Target closed'));
isp_crm_whatsapp  |                                    ^
isp_crm_whatsapp  |
isp_crm_whatsapp  | TargetCloseError: Protocol error (Runtime.callFunctionOn): Target closed
isp_crm_whatsapp  |     at CallbackRegistry.clear (/app/node_modules/puppeteer-core/lib/cjs/puppeteer/common/CallbackRegistry.js:82:36)
isp_crm_whatsapp  |     at CdpCDPSession.onClosed (/app/node_modules/puppeteer-core/lib/cjs/puppeteer/cdp/CdpSession.js:115:25)
isp_crm_whatsapp  |     at Connection.onMessage (/app/node_modules/puppeteer-core/lib/cjs/puppeteer/cdp/Connection.js:149:25)
isp_crm_whatsapp  |     at WebSocket.<anonymous> (/app/node_modules/puppeteer-core/lib/cjs/puppeteer/node/NodeWebSocketTransport.js:43:32)
isp_crm_whatsapp  |     at callListener (/app/node_modules/ws/lib/event-target.js:290:14)
isp_crm_whatsapp  |     at WebSocket.onMessage (/app/node_modules/ws/lib/event-target.js:209:9)
isp_crm_whatsapp  |     at WebSocket.emit (node:events:524:28)
isp_crm_whatsapp  |     at Receiver.receiverOnMessage (/app/node_modules/ws/lib/websocket.js:1225:20)
isp_crm_whatsapp  |     at Receiver.emit (node:events:524:28)
isp_crm_whatsapp  |     at Immediate.<anonymous> (/app/node_modules/ws/lib/receiver.js:601:16)
isp_crm_whatsapp  |     at process.processImmediate (node:internal/timers:483:21) {
isp_crm_whatsapp  |   cause: ProtocolError
isp_crm_whatsapp  |       at <instance_members_initializer> (/app/node_modules/puppeteer-core/lib/cjs/puppeteer/common/CallbackRegistry.js:103:14)
isp_crm_whatsapp  |       at new Callback (/app/node_modules/puppeteer-core/lib/cjs/puppeteer/common/CallbackRegistry.js:107:16)
isp_crm_whatsapp  |       at CallbackRegistry.create (/app/node_modules/puppeteer-core/lib/cjs/puppeteer/common/CallbackRegistry.js:25:26)
isp_crm_whatsapp  |       at Connection._rawSend (/app/node_modules/puppeteer-core/lib/cjs/puppeteer/cdp/Connection.js:108:26)
isp_crm_whatsapp  |       at CdpCDPSession.send (/app/node_modules/puppeteer-core/lib/cjs/puppeteer/cdp/CdpSession.js:74:33)
isp_crm_whatsapp  |       at #evaluate (/app/node_modules/puppeteer-core/lib/cjs/puppeteer/cdp/ExecutionContext.js:363:50)
isp_crm_whatsapp  |       at ExecutionContext.evaluate (/app/node_modules/puppeteer-core/lib/cjs/puppeteer/cdp/ExecutionContext.js:277:36)
isp_crm_whatsapp  |       at IsolatedWorld.evaluate (/app/node_modules/puppeteer-core/lib/cjs/puppeteer/cdp/IsolatedWorld.js:100:30)
isp_crm_whatsapp  |       at CdpFrame.evaluate (/app/node_modules/puppeteer-core/lib/cjs/puppeteer/api/Frame.js:362:43)
isp_crm_whatsapp  |       at CdpFrame.<anonymous> (/app/node_modules/puppeteer-core/lib/cjs/puppeteer/util/decorators.js:109:27)
isp_crm_whatsapp  |       at CdpPage.evaluate (/app/node_modules/puppeteer-core/lib/cjs/puppeteer/api/Page.js:826:43)
isp_crm_whatsapp  |       at Client.inject (/app/node_modules/whatsapp-web.js/src/Client.js:124:55)
isp_crm_whatsapp  |       at async Client.initialize (/app/node_modules/whatsapp-web.js/src/Client.js:373:9)
isp_crm_whatsapp  | }
isp_crm_whatsapp  |
isp_crm_whatsapp  | Node.js v20.20.0
isp_crm_whatsapp  | Removed stale lock file: /app/.wwebjs_auth/session/SingletonSocket
isp_crm_whatsapp  | Removed nested lock file: /app/.wwebjs_auth/session/SingletonLock
isp_crm_whatsapp  | WhatsApp service running on 0.0.0.0:3001
isp_crm_whatsapp  | API Secret: Configured
isp_crm_whatsapp  | Session found, auto-initializing...
isp_crm_whatsapp  | Using Chromium at: /usr/bin/chromium
isp_crm_whatsapp  | Auto-init error: The browser is already running for /app/.wwebjs_auth/session. Use a different `userDataDir` or stop the running browser first.
isp_crm_whatsapp  | /app/node_modules/puppeteer-core/lib/cjs/puppeteer/common/CallbackRegistry.js:82
isp_crm_whatsapp  |             this._reject(callback, new Errors_js_1.TargetCloseError('Target closed'));
isp_crm_whatsapp  |                                    ^
isp_crm_whatsapp  |
isp_crm_whatsapp  | TargetCloseError: Protocol error (Runtime.evaluate): Target
closed
isp_crm_whatsapp  |     at CallbackRegistry.clear (/app/node_modules/puppeteer-core/lib/cjs/puppeteer/common/CallbackRegistry.js:82:36)
isp_crm_whatsapp  |     at CdpCDPSession.onClosed (/app/node_modules/puppeteer-core/lib/cjs/puppeteer/cdp/CdpSession.js:115:25)
isp_crm_whatsapp  |     at Connection.onMessage (/app/node_modules/puppeteer-core/lib/cjs/puppeteer/cdp/Connection.js:149:25)
isp_crm_whatsapp  |     at WebSocket.<anonymous> (/app/node_modules/puppeteer-core/lib/cjs/puppeteer/node/NodeWebSocketTransport.js:43:32)
isp_crm_whatsapp  |     at callListener (/app/node_modules/ws/lib/event-target.js:290:14)
isp_crm_whatsapp  |     at WebSocket.onMessage (/app/node_modules/ws/lib/event-target.js:209:9)
isp_crm_whatsapp  |     at WebSocket.emit (node:events:524:28)
isp_crm_whatsapp  |     at Receiver.receiverOnMessage (/app/node_modules/ws/lib/websocket.js:1225:20)
isp_crm_whatsapp  |     at Receiver.emit (node:events:524:28)
isp_crm_whatsapp  |     at Immediate.<anonymous> (/app/node_modules/ws/lib/receiver.js:601:16)
isp_crm_whatsapp  |     at process.processImmediate (node:internal/timers:483:21) {
isp_crm_whatsapp  |   cause: ProtocolError
isp_crm_whatsapp  |       at <instance_members_initializer> (/app/node_modules/puppeteer-core/lib/cjs/puppeteer/common/CallbackRegistry.js:103:14)
isp_crm_whatsapp  |       at new Callback (/app/node_modules/puppeteer-core/lib/cjs/puppeteer/common/CallbackRegistry.js:107:16)
isp_crm_whatsapp  |       at CallbackRegistry.create (/app/node_modules/puppeteer-core/lib/cjs/puppeteer/common/CallbackRegistry.js:25:26)
isp_crm_whatsapp  |       at Connection._rawSend (/app/node_modules/puppeteer-core/lib/cjs/puppeteer/cdp/Connection.js:108:26)
isp_crm_whatsapp  |       at CdpCDPSession.send (/app/node_modules/puppeteer-core/lib/cjs/puppeteer/cdp/CdpSession.js:74:33)
isp_crm_whatsapp  |       at #evaluate (/app/node_modules/puppeteer-core/lib/cjs/puppeteer/cdp/ExecutionContext.js:341:18)
isp_crm_whatsapp  |       at ExecutionContext.evaluate (/app/node_modules/puppeteer-core/lib/cjs/puppeteer/cdp/ExecutionContext.js:277:36)
isp_crm_whatsapp  |       at IsolatedWorld.evaluate (/app/node_modules/puppeteer-core/lib/cjs/puppeteer/cdp/IsolatedWorld.js:100:30)
isp_crm_whatsapp  |       at CdpFrame.evaluate (/app/node_modules/puppeteer-core/lib/cjs/puppeteer/api/Frame.js:362:43)
isp_crm_whatsapp  |       at CdpFrame.<anonymous> (/app/node_modules/puppeteer-core/lib/cjs/puppeteer/util/decorators.js:109:27)
isp_crm_whatsapp  |       at CdpPage.evaluate (/app/node_modules/puppeteer-core/lib/cjs/puppeteer/api/Page.js:826:43)
isp_crm_whatsapp  |       at Client.inject (/app/node_modules/whatsapp-web.js/src/Client.js:106:38)
isp_crm_whatsapp  |       at Client.initialize (/app/node_modules/whatsapp-web.js/src/Client.js:373:20)
isp_crm_whatsapp  | }
isp_crm_whatsapp  |
isp_crm_whatsapp  | Node.js v20.20.0
isp_crm_whatsapp  | Removed stale lock file: /app/.wwebjs_auth/session/SingletonSocket
isp_crm_whatsapp  | Removed nested lock file: /app/.wwebjs_auth/session/SingletonLock
isp_crm_whatsapp  | WhatsApp service running on 0.0.0.0:3001
isp_crm_whatsapp  | API Secret: Configured
isp_crm_whatsapp  | Session found, auto-initializing...
isp_crm_whatsapp  | Using Chromium at: /usr/bin/chromium
isp_crm_whatsapp  | /app/node_modules/puppeteer-core/lib/cjs/puppeteer/common/CallbackRegistry.js:103
isp_crm_whatsapp  |     #error = new Errors_js_1.ProtocolError();
isp_crm_whatsapp  |              ^
isp_crm_whatsapp  |
isp_crm_whatsapp  | ProtocolError: Runtime.callFunctionOn timed out. Increase the 'protocolTimeout' setting in launch/connect calls for a higher timeout if needed.
isp_crm_whatsapp  |     at <instance_members_initializer> (/app/node_modules/puppeteer-core/lib/cjs/puppeteer/common/CallbackRegistry.js:103:14)
isp_crm_whatsapp  |     at new Callback (/app/node_modules/puppeteer-core/lib/cjs/puppeteer/common/CallbackRegistry.js:107:16)
isp_crm_whatsapp  |     at CallbackRegistry.create (/app/node_modules/puppeteer-core/lib/cjs/puppeteer/common/CallbackRegistry.js:25:26)
isp_crm_whatsapp  |     at Connection._rawSend (/app/node_modules/puppeteer-core/lib/cjs/puppeteer/cdp/Connection.js:108:26)
isp_crm_whatsapp  |     at CdpCDPSession.send (/app/node_modules/puppeteer-core/lib/cjs/puppeteer/cdp/CdpSession.js:74:33)
isp_crm_whatsapp  |     at #evaluate (/app/node_modules/puppeteer-core/lib/cjs/puppeteer/cdp/ExecutionContext.js:363:50)
isp_crm_whatsapp  |     at ExecutionContext.evaluate (/app/node_modules/puppeteer-core/lib/cjs/puppeteer/cdp/ExecutionContext.js:277:36)
isp_crm_whatsapp  |     at IsolatedWorld.evaluate (/app/node_modules/puppeteer-core/lib/cjs/puppeteer/cdp/IsolatedWorld.js:100:30)
isp_crm_whatsapp  |     at CdpFrame.evaluate (/app/node_modules/puppeteer-core/lib/cjs/puppeteer/api/Frame.js:362:43)
isp_crm_whatsapp  |     at CdpFrame.<anonymous> (/app/node_modules/puppeteer-core/lib/cjs/puppeteer/util/decorators.js:109:27)
isp_crm_whatsapp  |     at CdpPage.evaluate (/app/node_modules/puppeteer-core/lib/cjs/puppeteer/api/Page.js:826:43)
isp_crm_whatsapp  |     at Client.inject (/app/node_modules/whatsapp-web.js/src/Client.js:124:55)
isp_crm_whatsapp  |     at async Client.initialize (/app/node_modules/whatsapp-web.js/src/Client.js:373:9)
isp_crm_whatsapp  |
isp_crm_whatsapp  | Node.js v20.20.0
isp_crm_whatsapp  | Removed stale lock file: /app/.wwebjs_auth/session/SingletonSocket
isp_crm_whatsapp  | Removed nested lock file: /app/.wwebjs_auth/session/SingletonLock
isp_crm_whatsapp  | WhatsApp service running on 0.0.0.0:3001
isp_crm_whatsapp  | API Secret: Configured
isp_crm_whatsapp  | Session found, auto-initializing...
isp_crm_whatsapp  | Using Chromium at: /usr/bin/chromium
isp_crm_whatsapp  | Auto-init error: Failed to add page binding with name onQRChangedEvent: window['onQRChangedEvent'] already exists!
isp_crm_whatsapp  | QR Code received
isp_crm_whatsapp  | WhatsApp service running on 0.0.0.0:3001
isp_crm_whatsapp  | API Secret: Configured
isp_crm_whatsapp  | Session found, auto-initializing...
isp_crm_whatsapp  | Using Chromium at: /usr/bin/chromium
isp_crm_whatsapp  | /app/node_modules/puppeteer-core/lib/cjs/puppeteer/cdp/Page.js:563
isp_crm_whatsapp  |             throw new Error(`Failed to add page binding with name ${name}: window['${name}'] already exists!`);
isp_crm_whatsapp  |                   ^
isp_crm_whatsapp  |
isp_crm_whatsapp  | Error: Failed to add page binding with name onQRChangedEvent: window['onQRChangedEvent'] already exists!
isp_crm_whatsapp  |     at CdpPage.exposeFunction (/app/node_modules/puppeteer-core/lib/cjs/puppeteer/cdp/Page.js:563:19)
isp_crm_whatsapp  |     at exposeFunctionIfAbsent (/app/node_modules/whatsapp-web.js/src/util/Puppeteer.js:20:16)
isp_crm_whatsapp  |     at async Client.inject (/app/node_modules/whatsapp-web.js/src/Client.js:175:17)
isp_crm_whatsapp  |     at async Client.initialize (/app/node_modules/whatsapp-web.js/src/Client.js:373:9)
isp_crm_whatsapp  |
isp_crm_whatsapp  | Node.js v20.20.0
isp_crm_whatsapp exited with code 1 (restarting)                                isp_crm_whatsapp  | Removed stale lock file: /app/.wwebjs_auth/session/SingletonSocket
isp_crm_whatsapp  | Removed nested lock file: /app/.wwebjs_auth/session/SingletonLock
isp_crm_whatsapp  | WhatsApp service running on 0.0.0.0:3001
isp_crm_whatsapp  | API Secret: Configured
isp_crm_whatsapp  | Session found, auto-initializing...
isp_crm_whatsapp  | Using Chromium at: /usr/bin/chromium
isp_crm_whatsapp  | /app/node_modules/puppeteer-core/lib/cjs/puppeteer/cdp/Page.js:563
isp_crm_whatsapp  |             throw new Error(`Failed to add page binding with name ${name}: window['${name}'] already exists!`);
isp_crm_whatsapp  |                   ^
isp_crm_whatsapp  |
isp_crm_whatsapp  | Error: Failed to add page binding with name onQRChangedEvent: window['onQRChangedEvent'] already exists!
isp_crm_whatsapp  |     at CdpPage.exposeFunction (/app/node_modules/puppeteer-core/lib/cjs/puppeteer/cdp/Page.js:563:19)
isp_crm_whatsapp  |     at exposeFunctionIfAbsent (/app/node_modules/whatsapp-web.js/src/util/Puppeteer.js:20:16)
isp_crm_whatsapp  |     at async Client.inject (/app/node_modules/whatsapp-web.js/src/Client.js:175:17)
isp_crm_whatsapp  |     at async Client.initialize (/app/node_modules/whatsapp-web.js/src/Client.js:373:9)
isp_crm_whatsapp  |
isp_crm_whatsapp  | Node.js v20.20.0
isp_crm_whatsapp exited with code 1 (restarting)                                isp_crm_whatsapp  | Removed stale lock file: /app/.wwebjs_auth/session/SingletonSocket
isp_crm_whatsapp  | Removed nested lock file: /app/.wwebjs_auth/session/SingletonLock
isp_crm_whatsapp  | WhatsApp service running on 0.0.0.0:3001
isp_crm_whatsapp  | API Secret: Configured
isp_crm_whatsapp  | Session found, auto-initializing...
isp_crm_whatsapp  | Using Chromium at: /usr/bin/chromium
^C
root@superlitecrm:~/isp#
root@superlitecrm:~/isp#
root@superlitecrm:~/isp#
root@superlitecrm:~/isp# # On your production server:
docker compose stop whatsapp
docker compose run --rm whatsapp rm -rf /app/.wwebjs_auth
docker compose up -d whatsapp
docker compose logs -f whatsapp
 [+] stop 1/1
 ✔ Container isp_crm_whatsapp Stopped                                      0.5s WARN[0000] Found orphan containers ([isp_crm_license_server]) for this project.
If you removed or renamed this service in your compose file, you can run this command with the --remove-orphans flag to clean it up.
Container isp-whatsapp-run-6963252fb399 Creating
Container isp-whatsapp-run-6963252fb399 Created
rm: cannot remove '/app/.wwebjs_auth': Device or resource busy
WARN[0000] Found orphan containers ([isp_crm_license_server]) for this project.
If you removed or renamed this service in your compose file, you can run this command with the --remove-orphans flag to clean it up.
isp_crm_whatsapp  | Removed nested lock file: /app/.wwebjs_auth/session/SingletonLock
isp_crm_whatsapp  | Removed nested lock file: /app/.wwebjs_auth/session/SingletonSocket
isp_crm_whatsapp  | WhatsApp service running on 0.0.0.0:3001
isp_crm_whatsapp  | API Secret: Configured
isp_crm_whatsapp  | Session found, auto-initializing...
isp_crm_whatsapp  | Using Chromium at: /usr/bin/chromium
isp_crm_whatsapp  | Auto-init error: Protocol error (Runtime.callFunctionOn): Target closed
isp_crm_whatsapp  | /app/node_modules/puppeteer-core/lib/cjs/puppeteer/common/CallbackRegistry.js:82
isp_crm_whatsapp  |             this._reject(callback, new Errors_js_1.TargetCloseError('Target closed'));
isp_crm_whatsapp  |                                    ^
isp_crm_whatsapp  |
isp_crm_whatsapp  | TargetCloseError: Protocol error (Runtime.callFunctionOn): Target closed
isp_crm_whatsapp  |     at CallbackRegistry.clear (/app/node_modules/puppeteer-core/lib/cjs/puppeteer/common/CallbackRegistry.js:82:36)
isp_crm_whatsapp  |     at CdpCDPSession.onClosed (/app/node_modules/puppeteer-core/lib/cjs/puppeteer/cdp/CdpSession.js:115:25)
isp_crm_whatsapp  |     at Connection.onMessage (/app/node_modules/puppeteer-core/lib/cjs/puppeteer/cdp/Connection.js:149:25)
isp_crm_whatsapp  |     at WebSocket.<anonymous> (/app/node_modules/puppeteer-core/lib/cjs/puppeteer/node/NodeWebSocketTransport.js:43:32)
isp_crm_whatsapp  |     at callListener (/app/node_modules/ws/lib/event-target.js:290:14)
isp_crm_whatsapp  |     at WebSocket.onMessage (/app/node_modules/ws/lib/event-target.js:209:9)
isp_crm_whatsapp  |     at WebSocket.emit (node:events:524:28)
isp_crm_whatsapp  |     at Receiver.receiverOnMessage (/app/node_modules/ws/lib/websocket.js:1225:20)
isp_crm_whatsapp  |     at Receiver.emit (node:events:524:28)
isp_crm_whatsapp  |     at Immediate.<anonymous> (/app/node_modules/ws/lib/receiver.js:601:16)
isp_crm_whatsapp  |     at process.processImmediate (node:internal/timers:483:21) {
isp_crm_whatsapp  |   cause: ProtocolError
isp_crm_whatsapp  |       at <instance_members_initializer> (/app/node_modules/puppeteer-core/lib/cjs/puppeteer/common/CallbackRegistry.js:103:14)
isp_crm_whatsapp  |       at new Callback (/app/node_modules/puppeteer-core/lib/cjs/puppeteer/common/CallbackRegistry.js:107:16)
isp_crm_whatsapp  |       at CallbackRegistry.create (/app/node_modules/puppeteer-core/lib/cjs/puppeteer/common/CallbackRegistry.js:25:26)
isp_crm_whatsapp  |       at Connection._rawSend (/app/node_modules/puppeteer-core/lib/cjs/puppeteer/cdp/Connection.js:108:26)
isp_crm_whatsapp  |       at CdpCDPSession.send (/app/node_modules/puppeteer-core/lib/cjs/puppeteer/cdp/CdpSession.js:74:33)
isp_crm_whatsapp  |       at #evaluate (/app/node_modules/puppeteer-core/lib/cjs/puppeteer/cdp/ExecutionContext.js:363:50)
isp_crm_whatsapp  |       at ExecutionContext.evaluate (/app/node_modules/puppeteer-core/lib/cjs/puppeteer/cdp/ExecutionContext.js:277:36)
isp_crm_whatsapp  |       at IsolatedWorld.evaluate (/app/node_modules/puppeteer-core/lib/cjs/puppeteer/cdp/IsolatedWorld.js:100:30)
isp_crm_whatsapp  |       at CdpFrame.evaluate (/app/node_modules/puppeteer-core/lib/cjs/puppeteer/api/Frame.js:362:43)
isp_crm_whatsapp  |       at CdpFrame.<anonymous> (/app/node_modules/puppeteer-core/lib/cjs/puppeteer/util/decorators.js:109:27)
isp_crm_whatsapp  |       at CdpPage.evaluate (/app/node_modules/puppeteer-core/lib/cjs/puppeteer/api/Page.js:826:43)
isp_crm_whatsapp  |       at Client.inject (/app/node_modules/whatsapp-web.js/src/Client.js:124:55)
isp_crm_whatsapp  |       at async Client.initialize (/app/node_modules/whatsapp-web.js/src/Client.js:373:9)
isp_crm_whatsapp  | }
isp_crm_whatsapp  |
isp_crm_whatsapp  | Node.js v20.20.0
isp_crm_whatsapp  | Removed stale lock file: /app/.wwebjs_auth/session/SingletonSocket
isp_crm_whatsapp  | Removed nested lock file: /app/.wwebjs_auth/session/SingletonLock
isp_crm_whatsapp  | WhatsApp service running on 0.0.0.0:3001
isp_crm_whatsapp  | API Secret: Configured
isp_crm_whatsapp  | Session found, auto-initializing...
isp_crm_whatsapp  | Using Chromium at: /usr/bin/chromium
isp_crm_whatsapp  | Auto-init error: The browser is already running for /app/.wwebjs_auth/session. Use a different `userDataDir` or stop the running browser first.
isp_crm_whatsapp  | /app/node_modules/puppeteer-core/lib/cjs/puppeteer/common/CallbackRegistry.js:82
isp_crm_whatsapp  |             this._reject(callback, new Errors_js_1.TargetCloseError('Target closed'));
isp_crm_whatsapp  |                                    ^
isp_crm_whatsapp  |
isp_crm_whatsapp  | TargetCloseError: Protocol error (Runtime.evaluate): Target
closed
isp_crm_whatsapp  |     at CallbackRegistry.clear (/app/node_modules/puppeteer-core/lib/cjs/puppeteer/common/CallbackRegistry.js:82:36)
isp_crm_whatsapp  |     at CdpCDPSession.onClosed (/app/node_modules/puppeteer-core/lib/cjs/puppeteer/cdp/CdpSession.js:115:25)
isp_crm_whatsapp  |     at Connection.onMessage (/app/node_modules/puppeteer-core/lib/cjs/puppeteer/cdp/Connection.js:149:25)
isp_crm_whatsapp  |     at WebSocket.<anonymous> (/app/node_modules/puppeteer-core/lib/cjs/puppeteer/node/NodeWebSocketTransport.js:43:32)
isp_crm_whatsapp  |     at callListener (/app/node_modules/ws/lib/event-target.js:290:14)
isp_crm_whatsapp  |     at WebSocket.onMessage (/app/node_modules/ws/lib/event-target.js:209:9)
isp_crm_whatsapp  |     at WebSocket.emit (node:events:524:28)
isp_crm_whatsapp  |     at Receiver.receiverOnMessage (/app/node_modules/ws/lib/websocket.js:1225:20)
isp_crm_whatsapp  |     at Receiver.emit (node:events:524:28)
isp_crm_whatsapp  |     at Immediate.<anonymous> (/app/node_modules/ws/lib/receiver.js:601:16)
isp_crm_whatsapp  |     at process.processImmediate (node:internal/timers:483:21) {
isp_crm_whatsapp  |   cause: ProtocolError
isp_crm_whatsapp  |       at <instance_members_initializer> (/app/node_modules/puppeteer-core/lib/cjs/puppeteer/common/CallbackRegistry.js:103:14)
isp_crm_whatsapp  |       at new Callback (/app/node_modules/puppeteer-core/lib/cjs/puppeteer/common/CallbackRegistry.js:107:16)
isp_crm_whatsapp  |       at CallbackRegistry.create (/app/node_modules/puppeteer-core/lib/cjs/puppeteer/common/CallbackRegistry.js:25:26)
isp_crm_whatsapp  |       at Connection._rawSend (/app/node_modules/puppeteer-core/lib/cjs/puppeteer/cdp/Connection.js:108:26)
isp_crm_whatsapp  |       at CdpCDPSession.send (/app/node_modules/puppeteer-core/lib/cjs/puppeteer/cdp/CdpSession.js:74:33)
isp_crm_whatsapp  |       at #evaluate (/app/node_modules/puppeteer-core/lib/cjs/puppeteer/cdp/ExecutionContext.js:341:18)
isp_crm_whatsapp  |       at ExecutionContext.evaluate (/app/node_modules/puppeteer-core/lib/cjs/puppeteer/cdp/ExecutionContext.js:277:36)
isp_crm_whatsapp  |       at IsolatedWorld.evaluate (/app/node_modules/puppeteer-core/lib/cjs/puppeteer/cdp/IsolatedWorld.js:100:30)
isp_crm_whatsapp  |       at CdpFrame.evaluate (/app/node_modules/puppeteer-core/lib/cjs/puppeteer/api/Frame.js:362:43)
isp_crm_whatsapp  |       at CdpFrame.<anonymous> (/app/node_modules/puppeteer-core/lib/cjs/puppeteer/util/decorators.js:109:27)
isp_crm_whatsapp  |       at CdpPage.evaluate (/app/node_modules/puppeteer-core/lib/cjs/puppeteer/api/Page.js:826:43)
isp_crm_whatsapp  |       at Client.inject (/app/node_modules/whatsapp-web.js/src/Client.js:106:38)
isp_crm_whatsapp  |       at Client.initialize (/app/node_modules/whatsapp-web.js/src/Client.js:373:20)
isp_crm_whatsapp  | }
isp_crm_whatsapp  |
isp_crm_whatsapp  | Node.js v20.20.0
isp_crm_whatsapp  | Removed stale lock file: /app/.wwebjs_auth/session/SingletonSocket
isp_crm_whatsapp  | Removed nested lock file: /app/.wwebjs_auth/session/SingletonLock
isp_crm_whatsapp  | WhatsApp service running on 0.0.0.0:3001
isp_crm_whatsapp  | API Secret: Configured
isp_crm_whatsapp  | Session found, auto-initializing...
isp_crm_whatsapp  | Using Chromium at: /usr/bin/chromium
isp_crm_whatsapp  | /app/node_modules/puppeteer-core/lib/cjs/puppeteer/common/CallbackRegistry.js:103
isp_crm_whatsapp  |     #error = new Errors_js_1.ProtocolError();
isp_crm_whatsapp  |              ^
isp_crm_whatsapp  |
isp_crm_whatsapp  | ProtocolError: Runtime.callFunctionOn timed out. Increase the 'protocolTimeout' setting in launch/connect calls for a higher timeout if needed.
isp_crm_whatsapp  |     at <instance_members_initializer> (/app/node_modules/puppeteer-core/lib/cjs/puppeteer/common/CallbackRegistry.js:103:14)
isp_crm_whatsapp  |     at new Callback (/app/node_modules/puppeteer-core/lib/cjs/puppeteer/common/CallbackRegistry.js:107:16)
isp_crm_whatsapp  |     at CallbackRegistry.create (/app/node_modules/puppeteer-core/lib/cjs/puppeteer/common/CallbackRegistry.js:25:26)
isp_crm_whatsapp  |     at Connection._rawSend (/app/node_modules/puppeteer-core/lib/cjs/puppeteer/cdp/Connection.js:108:26)
isp_crm_whatsapp  |     at CdpCDPSession.send (/app/node_modules/puppeteer-core/lib/cjs/puppeteer/cdp/CdpSession.js:74:33)
isp_crm_whatsapp  |     at #evaluate (/app/node_modules/puppeteer-core/lib/cjs/puppeteer/cdp/ExecutionContext.js:363:50)
isp_crm_whatsapp  |     at ExecutionContext.evaluate (/app/node_modules/puppeteer-core/lib/cjs/puppeteer/cdp/ExecutionContext.js:277:36)
isp_crm_whatsapp  |     at IsolatedWorld.evaluate (/app/node_modules/puppeteer-core/lib/cjs/puppeteer/cdp/IsolatedWorld.js:100:30)
isp_crm_whatsapp  |     at CdpFrame.evaluate (/app/node_modules/puppeteer-core/lib/cjs/puppeteer/api/Frame.js:362:43)
isp_crm_whatsapp  |     at CdpFrame.<anonymous> (/app/node_modules/puppeteer-core/lib/cjs/puppeteer/util/decorators.js:109:27)
isp_crm_whatsapp  |     at CdpPage.evaluate (/app/node_modules/puppeteer-core/lib/cjs/puppeteer/api/Page.js:826:43)
isp_crm_whatsapp  |     at Client.inject (/app/node_modules/whatsapp-web.js/src/Client.js:124:55)
isp_crm_whatsapp  |     at async Client.initialize (/app/node_modules/whatsapp-web.js/src/Client.js:373:9)
isp_crm_whatsapp  |
isp_crm_whatsapp  | Node.js v20.20.0
isp_crm_whatsapp  | Removed stale lock file: /app/.wwebjs_auth/session/SingletonSocket
isp_crm_whatsapp  | Removed nested lock file: /app/.wwebjs_auth/session/SingletonLock
isp_crm_whatsapp  | WhatsApp service running on 0.0.0.0:3001
isp_crm_whatsapp  | API Secret: Configured
isp_crm_whatsapp  | Session found, auto-initializing...
isp_crm_whatsapp  | Using Chromium at: /usr/bin/chromium
isp_crm_whatsapp  | Auto-init error: Failed to add page binding with name onQRChangedEvent: window['onQRChangedEvent'] already exists!
isp_crm_whatsapp  | QR Code received
isp_crm_whatsapp  | WhatsApp service running on 0.0.0.0:3001
isp_crm_whatsapp  | API Secret: Configured
isp_crm_whatsapp  | Session found, auto-initializing...
isp_crm_whatsapp  | Using Chromium at: /usr/bin/chromium
isp_crm_whatsapp  | /app/node_modules/puppeteer-core/lib/cjs/puppeteer/cdp/Page.js:563
isp_crm_whatsapp  |             throw new Error(`Failed to add page binding with name ${name}: window['${name}'] already exists!`);
isp_crm_whatsapp  |                   ^
isp_crm_whatsapp  |
isp_crm_whatsapp  | Error: Failed to add page binding with name onQRChangedEvent: window['onQRChangedEvent'] already exists!
isp_crm_whatsapp  |     at CdpPage.exposeFunction (/app/node_modules/puppeteer-core/lib/cjs/puppeteer/cdp/Page.js:563:19)
isp_crm_whatsapp  |     at exposeFunctionIfAbsent (/app/node_modules/whatsapp-web.js/src/util/Puppeteer.js:20:16)
isp_crm_whatsapp  |     at async Client.inject (/app/node_modules/whatsapp-web.js/src/Client.js:175:17)
isp_crm_whatsapp  |     at async Client.initialize (/app/node_modules/whatsapp-web.js/src/Client.js:373:9)
isp_crm_whatsapp  |
isp_crm_whatsapp  | Node.js v20.20.0
isp_crm_whatsapp  | Removed stale lock file: /app/.wwebjs_auth/session/SingletonSocket
isp_crm_whatsapp  | Removed nested lock file: /app/.wwebjs_auth/session/SingletonLock
isp_crm_whatsapp  | WhatsApp service running on 0.0.0.0:3001
isp_crm_whatsapp  | API Secret: Configured
isp_crm_whatsapp  | Session found, auto-initializing...
isp_crm_whatsapp  | Using Chromium at: /usr/bin/chromium
isp_crm_whatsapp  | /app/node_modules/puppeteer-core/lib/cjs/puppeteer/cdp/Page.js:563
isp_crm_whatsapp  |             throw new Error(`Failed to add page binding with name ${name}: window['${name}'] already exists!`);
isp_crm_whatsapp  |                   ^
isp_crm_whatsapp  |
isp_crm_whatsapp  | Error: Failed to add page binding with name onQRChangedEvent: window['onQRChangedEvent'] already exists!
isp_crm_whatsapp  |     at CdpPage.exposeFunction (/app/node_modules/puppeteer-core/lib/cjs/puppeteer/cdp/Page.js:563:19)
isp_crm_whatsapp  |     at exposeFunctionIfAbsent (/app/node_modules/whatsapp-web.js/src/util/Puppeteer.js:20:16)
isp_crm_whatsapp  |     at async Client.inject (/app/node_modules/whatsapp-web.js/src/Client.js:175:17)
isp_crm_whatsapp  |     at async Client.initialize (/app/node_modules/whatsapp-web.js/src/Client.js:373:9)
isp_crm_whatsapp  |
isp_crm_whatsapp  | Node.js v20.20.0
isp_crm_whatsapp  | Removed stale lock file: /app/.wwebjs_auth/session/SingletonSocket
isp_crm_whatsapp  | Removed nested lock file: /app/.wwebjs_auth/session/SingletonLock
isp_crm_whatsapp  | WhatsApp service running on 0.0.0.0:3001
isp_crm_whatsapp  | API Secret: Configured
isp_crm_whatsapp  | Session found, auto-initializing...
isp_crm_whatsapp  | Using Chromium at: /usr/bin/chromium
isp_crm_whatsapp  | Auto-init error: Protocol error (Runtime.callFunctionOn): Target closed
isp_crm_whatsapp  | /app/node_modules/puppeteer-core/lib/cjs/puppeteer/common/CallbackRegistry.js:82
isp_crm_whatsapp  |             this._reject(callback, new Errors_js_1.TargetCloseError('Target closed'));
isp_crm_whatsapp  |                                    ^
isp_crm_whatsapp  |
isp_crm_whatsapp  | TargetCloseError: Protocol error (Runtime.callFunctionOn): Target closed
isp_crm_whatsapp  |     at CallbackRegistry.clear (/app/node_modules/puppeteer-core/lib/cjs/puppeteer/common/CallbackRegistry.js:82:36)
isp_crm_whatsapp  |     at CdpCDPSession.onClosed (/app/node_modules/puppeteer-core/lib/cjs/puppeteer/cdp/CdpSession.js:115:25)
isp_crm_whatsapp  |     at #onClose (/app/node_modules/puppeteer-core/lib/cjs/puppeteer/cdp/Connection.js:190:21)
isp_crm_whatsapp  |     at WebSocket.<anonymous> (/app/node_modules/puppeteer-core/lib/cjs/puppeteer/node/NodeWebSocketTransport.js:48:30)
isp_crm_whatsapp  |     at callListener (/app/node_modules/ws/lib/event-target.js:290:14)
isp_crm_whatsapp  |     at WebSocket.onClose (/app/node_modules/ws/lib/event-target.js:220:9)
isp_crm_whatsapp  |     at WebSocket.emit (node:events:524:28)
isp_crm_whatsapp  |     at WebSocket.emitClose (/app/node_modules/ws/lib/websocket.js:273:10)
isp_crm_whatsapp  |     at Socket.socketOnClose (/app/node_modules/ws/lib/websocket.js:1346:15)
isp_crm_whatsapp  |     at Socket.emit (node:events:524:28)
isp_crm_whatsapp  |     at TCP.<anonymous> (node:net:343:12) {
isp_crm_whatsapp  |   cause: ProtocolError
isp_crm_whatsapp  |       at <instance_members_initializer> (/app/node_modules/puppeteer-core/lib/cjs/puppeteer/common/CallbackRegistry.js:103:14)
isp_crm_whatsapp  |       at new Callback (/app/node_modules/puppeteer-core/lib/cjs/puppeteer/common/CallbackRegistry.js:107:16)
isp_crm_whatsapp  |       at CallbackRegistry.create (/app/node_modules/puppeteer-core/lib/cjs/puppeteer/common/CallbackRegistry.js:25:26)
isp_crm_whatsapp  |       at Connection._rawSend (/app/node_modules/puppeteer-core/lib/cjs/puppeteer/cdp/Connection.js:108:26)
isp_crm_whatsapp  |       at CdpCDPSession.send (/app/node_modules/puppeteer-core/lib/cjs/puppeteer/cdp/CdpSession.js:74:33)
isp_crm_whatsapp  |       at #evaluate (/app/node_modules/puppeteer-core/lib/cjs/puppeteer/cdp/ExecutionContext.js:363:50)
isp_crm_whatsapp  |       at ExecutionContext.evaluate (/app/node_modules/puppeteer-core/lib/cjs/puppeteer/cdp/ExecutionContext.js:277:36)
isp_crm_whatsapp  |       at IsolatedWorld.evaluate (/app/node_modules/puppeteer-core/lib/cjs/puppeteer/cdp/IsolatedWorld.js:100:30)
isp_crm_whatsapp  |       at CdpFrame.evaluate (/app/node_modules/puppeteer-core/lib/cjs/puppeteer/api/Frame.js:362:43)
isp_crm_whatsapp  |       at CdpFrame.<anonymous> (/app/node_modules/puppeteer-core/lib/cjs/puppeteer/util/decorators.js:109:27)
isp_crm_whatsapp  |       at CdpPage.evaluate (/app/node_modules/puppeteer-core/lib/cjs/puppeteer/api/Page.js:826:43)
isp_crm_whatsapp  |       at Client.inject (/app/node_modules/whatsapp-web.js/src/Client.js:124:55)
isp_crm_whatsapp  |       at async Client.initialize (/app/node_modules/whatsapp-web.js/src/Client.js:373:9)
isp_crm_whatsapp  | }
isp_crm_whatsapp  |
isp_crm_whatsapp  | Node.js v20.20.0
isp_crm_whatsapp  | WhatsApp service running on 0.0.0.0:3001
isp_crm_whatsapp  | API Secret: Configured
isp_crm_whatsapp  | Session found, auto-initializing...
isp_crm_whatsapp  | Using Chromium at: /usr/bin/chromium
isp_crm_whatsapp  | Auto-init error: The browser is already running for /app/.wwebjs_auth/session. Use a different `userDataDir` or stop the running browser first.
isp_crm_whatsapp  | QR Code received
isp_crm_whatsapp  | QR Code received
isp_crm_whatsapp  | QR Code received
isp_crm_whatsapp  | QR Code received
isp_crm_whatsapp  | QR Code received
isp_crm_whatsapp  | QR Code received
^C
root@superlitecrm:~/isp#
root@superlitecrm:~/isp#
root@superlitecrm:~/isp# docker compose down whatsapp
docker compose up -d --force-recreate whatsapp
docker compose logs -f whatsapp
 [+] down 2/2
 ✔ Container isp_crm_whatsapp Removed                                     10.6s  ! Network isp_crm_network    Resource is still in use                     0.0s WARN[0000] Found orphan containers ([isp_crm_license_server]) for this project.
If you removed or renamed this service in your compose file, you can run this command with the --remove-orphans flag to clean it up.
 [+] up 1/1
 ✔ Container isp_crm_whatsapp Created                                      0.1s isp_crm_whatsapp  | Removed nested lock file: /app/.wwebjs_auth/session/SingletonLock
isp_crm_whatsapp  | Removed nested lock file: /app/.wwebjs_auth/session/SingletonSocket
isp_crm_whatsapp  | WhatsApp service running on 0.0.0.0:3001
isp_crm_whatsapp  | API Secret: Configured
isp_crm_whatsapp  | Session found, auto-initializing...
isp_crm_whatsapp  | Using Chromium at: /usr/bin/chromium
^C
root@superlitecrm:~/isp# # Stop the whatsapp container
docker compose stop whatsapp
# Remove the whatsapp_session volume completely
docker volume rm isp_whatsapp_session
# Start the container fresh
docker compose up -d whatsapp
# Watch the logs
docker compose logs -f whatsapp
 [+] stop 1/1
 ✔ Container isp_crm_whatsapp Stopped                                      0.5s Error response from daemon: remove isp_whatsapp_session: volume is in use - [8dc991908b2146167d4f6a2c2f53e703075e9e5bf2bbf304ac4b97fc19aad71b]
WARN[0000] Found orphan containers ([isp_crm_license_server]) for this project.
If you removed or renamed this service in your compose file, you can run this command with the --remove-orphans flag to clean it up.
isp_crm_whatsapp  | Removed nested lock file: /app/.wwebjs_auth/session/SingletonLock
isp_crm_whatsapp  | Removed nested lock file: /app/.wwebjs_auth/session/SingletonSocket
isp_crm_whatsapp  | WhatsApp service running on 0.0.0.0:3001
isp_crm_whatsapp  | API Secret: Configured
isp_crm_whatsapp  | Session found, auto-initializing...
isp_crm_whatsapp  | Using Chromium at: /usr/bin/chromium
isp_crm_whatsapp  | Auto-init error: Protocol error (Runtime.callFunctionOn): Target closed
isp_crm_whatsapp  | /app/node_modules/puppeteer-core/lib/cjs/puppeteer/common/CallbackRegistry.js:82
isp_crm_whatsapp  |             this._reject(callback, new Errors_js_1.TargetCloseError('Target closed'));
isp_crm_whatsapp  |                                    ^
isp_crm_whatsapp  |
isp_crm_whatsapp  | TargetCloseError: Protocol error (Runtime.callFunctionOn): Target closed
isp_crm_whatsapp  |     at CallbackRegistry.clear (/app/node_modules/puppeteer-core/lib/cjs/puppeteer/common/CallbackRegistry.js:82:36)
isp_crm_whatsapp  |     at CdpCDPSession.onClosed (/app/node_modules/puppeteer-core/lib/cjs/puppeteer/cdp/CdpSession.js:115:25)
isp_crm_whatsapp  |     at #onClose (/app/node_modules/puppeteer-core/lib/cjs/puppeteer/cdp/Connection.js:190:21)
isp_crm_whatsapp  |     at WebSocket.<anonymous> (/app/node_modules/puppeteer-core/lib/cjs/puppeteer/node/NodeWebSocketTransport.js:48:30)
isp_crm_whatsapp  |     at callListener (/app/node_modules/ws/lib/event-target.js:290:14)
isp_crm_whatsapp  |     at WebSocket.onClose (/app/node_modules/ws/lib/event-target.js:220:9)
isp_crm_whatsapp  |     at WebSocket.emit (node:events:524:28)
isp_crm_whatsapp  |     at WebSocket.emitClose (/app/node_modules/ws/lib/websocket.js:273:10)
isp_crm_whatsapp  |     at Socket.socketOnClose (/app/node_modules/ws/lib/websocket.js:1346:15)
isp_crm_whatsapp  |     at Socket.emit (node:events:524:28)
isp_crm_whatsapp  |     at TCP.<anonymous> (node:net:343:12) {
isp_crm_whatsapp  |   cause: ProtocolError
isp_crm_whatsapp  |       at <instance_members_initializer> (/app/node_modules/puppeteer-core/lib/cjs/puppeteer/common/CallbackRegistry.js:103:14)
isp_crm_whatsapp  |       at new Callback (/app/node_modules/puppeteer-core/lib/cjs/puppeteer/common/CallbackRegistry.js:107:16)
isp_crm_whatsapp  |       at CallbackRegistry.create (/app/node_modules/puppeteer-core/lib/cjs/puppeteer/common/CallbackRegistry.js:25:26)
isp_crm_whatsapp  |       at Connection._rawSend (/app/node_modules/puppeteer-core/lib/cjs/puppeteer/cdp/Connection.js:108:26)
isp_crm_whatsapp  |       at CdpCDPSession.send (/app/node_modules/puppeteer-core/lib/cjs/puppeteer/cdp/CdpSession.js:74:33)
isp_crm_whatsapp  |       at #evaluate (/app/node_modules/puppeteer-core/lib/cjs/puppeteer/cdp/ExecutionContext.js:363:50)
isp_crm_whatsapp  |       at ExecutionContext.evaluate (/app/node_modules/puppeteer-core/lib/cjs/puppeteer/cdp/ExecutionContext.js:277:36)
isp_crm_whatsapp  |       at IsolatedWorld.evaluate (/app/node_modules/puppeteer-core/lib/cjs/puppeteer/cdp/IsolatedWorld.js:100:30)
isp_crm_whatsapp  |       at CdpFrame.evaluate (/app/node_modules/puppeteer-core/lib/cjs/puppeteer/api/Frame.js:362:43)
isp_crm_whatsapp  |       at CdpFrame.<anonymous> (/app/node_modules/puppeteer-core/lib/cjs/puppeteer/util/decorators.js:109:27)
isp_crm_whatsapp  |       at CdpPage.evaluate (/app/node_modules/puppeteer-core/lib/cjs/puppeteer/api/Page.js:826:43)
isp_crm_whatsapp  |       at Client.inject (/app/node_modules/whatsapp-web.js/src/Client.js:124:55)
isp_crm_whatsapp  |       at async Client.initialize (/app/node_modules/whatsapp-web.js/src/Client.js:373:9)
isp_crm_whatsapp  | }
isp_crm_whatsapp  |
isp_crm_whatsapp  | Node.js v20.20.0
isp_crm_whatsapp  | Removed stale lock file: /app/.wwebjs_auth/session/SingletonSocket
isp_crm_whatsapp  | Removed nested lock file: /app/.wwebjs_auth/session/SingletonLock
isp_crm_whatsapp  | WhatsApp service running on 0.0.0.0:3001
isp_crm_whatsapp  | API Secret: Configured
isp_crm_whatsapp  | Session found, auto-initializing...
isp_crm_whatsapp  | Using Chromium at: /usr/bin/chromium
isp_crm_whatsapp  | /app/node_modules/puppeteer-core/lib/cjs/puppeteer/cdp/Page.js:563
isp_crm_whatsapp  |             throw new Error(`Failed to add page binding with name ${name}: window['${name}'] already exists!`);
isp_crm_whatsapp  |                   ^
isp_crm_whatsapp  |
isp_crm_whatsapp  | Error: Failed to add page binding with name onQRChangedEvent: window['onQRChangedEvent'] already exists!
isp_crm_whatsapp  |     at CdpPage.exposeFunction (/app/node_modules/puppeteer-core/lib/cjs/puppeteer/cdp/Page.js:563:19)
isp_crm_whatsapp  |     at exposeFunctionIfAbsent (/app/node_modules/whatsapp-web.js/src/util/Puppeteer.js:20:16)
isp_crm_whatsapp  |     at async Client.inject (/app/node_modules/whatsapp-web.js/src/Client.js:175:17)
isp_crm_whatsapp  |     at async Client.initialize (/app/node_modules/whatsapp-web.js/src/Client.js:373:9)
isp_crm_whatsapp  |
isp_crm_whatsapp  | Node.js v20.20.0
isp_crm_whatsapp exited with code 1 (restarting)                                isp_crm_whatsapp  | Removed stale lock file: /app/.wwebjs_auth/session/SingletonSocket
isp_crm_whatsapp  | Removed nested lock file: /app/.wwebjs_auth/session/SingletonLock
isp_crm_whatsapp  | WhatsApp service running on 0.0.0.0:3001
isp_crm_whatsapp  | API Secret: Configured
isp_crm_whatsapp  | Session found, auto-initializing...
isp_crm_whatsapp  | Using Chromium at: /usr/bin/chromium
isp_crm_whatsapp  | Auto-init error: The browser is already running for /app/.wwebjs_auth/session. Use a different `userDataDir` or stop the running browser first.
isp_crm_whatsapp  | QR Code received
isp_crm_whatsapp  | QR Code received
isp_crm_whatsapp  | QR Code received
isp_crm_whatsapp  | QR Code received
isp_crm_whatsapp  | QR Code received
isp_crm_whatsapp  | QR Code received
isp_crm_whatsapp  | QR Code received
isp_crm_whatsapp  | QR Code received
isp_crm_whatsapp  | QR Code received
isp_crm_whatsapp  | QR Code received
isp_crm_whatsapp  | QR Code received
isp_crm_whatsapp  | QR Code received
isp_crm_whatsapp  | QR Code received
^C
root@superlitecrm:~/isp# # Completely remove the container (not just stop)
docker rm -f isp_crm_whatsapp
# Now remove the volume
docker volume rm isp_whatsapp_session
# Recreate the container
docker compose up -d whatsapp
# Watch logs
docker compose logs -f whatsapp
isp_crm_whatsapp
isp_whatsapp_session
 [+] up 1/1
 ✔ Volume isp_whatsapp_session Created                                     0.0s WARN[0000] Found orphan containers ([isp_crm_license_server]) for this project.
I[+] up 2/2ved or renamed this service in your compose file, you can run this co ✔ Volume isp_whatsapp_session Created                                     0.0s  ✔ Container isp_crm_whatsapp  Created                                     0.5s isp_crm_whatsapp  | WhatsApp service running on 0.0.0.0:3001
isp_crm_whatsapp  | API Secret: Configured
isp_crm_whatsapp  | Session found, auto-initializing...
isp_crm_whatsapp  | Using Chromium at: /usr/bin/chromium
isp_crm_whatsapp  | Auto-init error: The browser is already running for /app/.wwebjs_auth/session. Use a different `userDataDir` or stop the running browser first.
isp_crm_whatsapp  | QR Code received