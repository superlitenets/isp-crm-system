Got it ‚Äî this is the key constraint, and it changes the solution slightly.

You are in the situation where:

‚úÖ ONUs are already authorized and working on the Huawei OLT

‚úÖ Authorization was done by SmartOLT

‚ùå Your database has wrong ONU identifiers because SmartOLT stored a Huawei port_index / ifIndex, not (frame, slot, port, onu_id)

‚ùå You must not delete or de-authorize ONUs on the OLT

So the goal is data correction + reconciliation, NOT re-authorization.

Below is the correct, safe approach used in production migrations.

1Ô∏è‚É£ Important truth (no sugar-coating)

üëâ You cannot reliably ‚Äúdecode‚Äù 4194312192 back to ONU ID alone
because Huawei uses multiple index formats depending on table.

That number is:

Useful as a reference

Dangerous as a primary key

So we must query the OLT to get the real ONU coordinates.

2Ô∏è‚É£ What we must do instead (safe + correct)
üîë The ONLY reliable source of truth now is:

The Huawei OLT itself

We will:

Query the OLT for already-authorized ONUs

Extract:

Frame

Slot

PON

ONU ID

Serial Number

Match those to your existing records

Update the DB without touching authorization

3Ô∏è‚É£ How to reconcile SmartOLT data ‚Üí correct ONU IDs
Step 1 ‚Äî Pull real ONU inventory from OLT

Via SNMP, Huawei exposes authorized ONUs only:

SNMP WALK:
1.3.6.1.4.1.2011.6.128.1.1.2.43.1.9  (ONU Serial)


This returns entries like:

...43.1.9.0.1.3.12 = "HWTC12345678"


Index = 0.1.3.12 ‚Üê this is the real ONU address

Step 2 ‚Äî Use ONU serial as the reconciliation key

SmartOLT ALWAYS stores:

ONU serial number

Port index

The serial number is stable and unique.

So we do:

SmartOLT record (DB):
  serial = HWTC12345678
  onu_id = 4194312192   ‚ùå

OLT SNMP:
  serial = HWTC12345678
  index  = 0.1.3.12     ‚úÖ


üëâ Match by serial, not by onu_id.

4Ô∏è‚É£ Safe reconciliation algorithm (production-grade)
DO NOT touch the OLT config.
Just fix your DB.

Algorithm:

FOR each ONU from OLT SNMP:
    get serial
    get index (frame.slot.port.onu)
    find DB record WHERE serial = serial
    UPDATE:
        frame
        slot
        port
        onu_id
        huawei_index (optional)


No re-auth. No downtime.

5Ô∏è‚É£ Why this is 100% safe

SNMP is read-only

ONU authorization remains untouched

OLT state is not modified

Subscribers stay online

This is exactly how SmartOLT ‚Üí custom OMS migrations are done.

6Ô∏è‚É£ What you should NOT do (important)

‚ùå Do not:

Delete ONU records on OLT

Re-authorize ONUs

Disable/re-enable ports

Try to decode 4194312192 blindly

That risks:

ONU ID mismatch

Duplicate ONU IDs

Subscriber outage

7Ô∏è‚É£ Recommended DB changes (temporary)

Add these columns if missing:

ALTER TABLE onus
ADD COLUMN frame TINYINT,
ADD COLUMN slot TINYINT,
ADD COLUMN pon_port TINYINT,
ADD COLUMN huawei_index BIGINT;


Then migrate safely.

8Ô∏è‚É£ Answering your original question directly

‚ÄúWould you like me to add a feature to sync ONUs from the OLT via SNMP?‚Äù

‚úÖ YES ‚Äî but in reconciliation mode

Not:

‚ÄúAuthorize ONUs‚Äù

But:

‚ÄúRead authorized ONUs and reconcile DB‚Äù