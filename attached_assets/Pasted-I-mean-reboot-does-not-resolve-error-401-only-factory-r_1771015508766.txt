I mean reboot does not resolve error 401, only factory reset

Ahhh â€” thatâ€™s a very different situation ğŸ‘‡

If:

âŒ Normal reboot does NOT fix 401
âœ… Factory reset DOES fix 401

Then this is not an OMCI sync issue.
This is persistent TR-069 credential mismatch stored inside the ONU flash.

ğŸ” What Error 401 Means in TR-069

401 Unauthorized in TR-069 means:

The ACS rejected the ONUâ€™s authentication credentials.

So one of these is wrong:

CWMP username

CWMP password

Connection-request credentials

Digest auth mismatch

Cached auth session inside ONU

ğŸ§  Why Reboot Does NOT Fix It

Huawei ONUs store TR-069 credentials in:

NVRAM / flash configuration


When you do:

ont tr069-server-config ...


You are modifying OLT-side profile.

But the ONU may already have:

Old ACS username/password stored

Old CWMP auth settings

Old inform credentials

Reboot:

Reloads same stored credentials

Reconnects using wrong credentials

Still gets 401

Factory reset:

Clears NVRAM

Deletes stored ACS credentials

Forces ONU to accept OLT OMCI profile cleanly

Then works

Thatâ€™s why only factory reset fixes it.

ğŸ”¥ What Is Really Happening

Your flow likely:

ONU was provisioned previously

It stored TR-069 credentials locally

You changed TR-069 profile on OLT

ONU still uses old credentials

ACS rejects â†’ 401

Reboot reloads same wrong creds

Factory reset clears them

âš ï¸ Very Important Detail

If you are doing this:

ont tr069-server-profile modify profile-id 3 connection-request-username "" connection-request-password ""


You are modifying profile globally.

But:

ONU may still hold old CWMP credentials internally

Profile change does not override internal stored values fully

Some firmware versions donâ€™t overwrite existing TR-069 settings unless blank first

ğŸ§ª How To Confirm This

On OLT:

display ont tr069-server-config 0 2 1


On ACS (GenieACS?):

Check what username the ONU is presenting

Compare with profile 3 credentials

They likely do NOT match.

ğŸ Proper Fix (No Factory Reset Required)
âœ… Option 1 â€” Force clear TR-069 on ONU via OMCI

Try this sequence:

interface gpon 0/2
ont tr069-server-config 0 1 profile-id 0
quit


Then:

interface gpon 0/2
ont tr069-server-config 0 1 profile-id 3
ont reset 0 1


This forces profile detach + reattach.

âœ… Option 2 â€” Ensure Profile Contains Correct ACS Auth

Instead of blank:

connection-request-username ""
connection-request-password ""


Use proper credentials matching ACS.

Blank credentials can cause digest mismatch loops.

âœ… Option 3 â€” Do NOT Modify Profile Globally

Instead:

Create a new profile

Assign per-ONU

Avoid modifying active profile

Example:

ont tr069-server-profile add profile-id 10 ...

ğŸš¨ Common Huawei Bug

Some HG8546M firmware versions:

Do NOT overwrite TR-069 auth fields if already set

Require explicit clear

Or require factory reset to clear internal flags

If thatâ€™s the case â†’ firmware issue.

ğŸ¯ Real Diagnosis

Since factory reset fixes it:

The ONU is retaining old TR-069 authentication credentials in flash.
Reboot does not clear them.
Only factory reset wipes them.

This is device-level persistent configuration behavior.

ğŸ”¥ Clean Production Solution

For stable ISP automation:

Always provision TR-069 at first ont add

Avoid modifying TR-069 after activation

If changing ACS credentials:

Detach profile

Reattach new profile

Reset ONU

Do not use blank credentials unless intentional