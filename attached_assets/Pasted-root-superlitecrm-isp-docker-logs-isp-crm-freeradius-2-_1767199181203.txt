root@superlitecrm:~/isp# docker logs isp_crm_freeradius 2>&1 | grep -i "sql\|rlm_sql\|client"
including configuration file /etc/freeradius/clients.conf
including configuration file /etc/freeradius/mods-enabled/dynamic_clients
including configuration file /etc/freeradius/mods-enabled/sql
including configuration file /etc/freeradius/mods-config/sql/main/postgresql/queries.conf
including configuration file /etc/freeradius/sites-enabled/dynamic_clients
        postauth_client_lost = no
radiusd: #### Loading Clients ####
 client localhost {
 client localhost_ipv6 {
 client dynamic {
        dynamic_clients = "dynamic_clients"
  # Loaded module rlm_dynamic_clients
  # Loading module "dynamic_clients" from file /etc/freeradius/mods-enabled/dynamic_clients
  # Loaded module rlm_sql
  # Loading module "sql" from file /etc/freeradius/mods-enabled/sql
  sql {
        driver = "rlm_sql_postgresql"
        read_clients = yes
        sql_user_name = "%{%{Stripped-User-Name}:-%{%{User-Name}:-DEFAULT}}"
        client_query = "SELECT id as id, ip_address as nasname, secret as secret, COALESCE(nas_type, 'mikrotik') as type, NULL as server, NULL as community, name as shortname, description as description, NULL as virtual_server, COALESCE(nas_type, 'mikrotik') as nas_type FROM radius_nas WHERE is_active = true"
        authorize_check_query = "SELECT id, username, 'Cleartext-Password' as attribute, password as value, ':=' as op FROM radius_subscriptions WHERE username = '%{SQL-User-Name}' AND status = 'active' AND (expires_at IS NULL OR expires_at > NOW())"
        authorize_reply_query = "SELECT rs.id, rs.username, CASE WHEN rp.download_speed > 0 THEN 'Mikrotik-Rate-Limit' ELSE NULL END as attribute, CASE WHEN rp.download_speed > 0 THEN CONCAT(rp.upload_speed::text, 'M/', rp.download_speed::text, 'M') ELSE NULL END as value, '=' as op FROM radius_subscriptions rs JOIN radius_packages rp ON rs.package_id = rp.id WHERE rs.username = '%{SQL-User-Name}' AND rs.status = 'active' AND (rs.expires_at IS NULL OR rs.expires_at > NOW()) AND rp.download_speed > 0 UNION ALL SELECT rs.id, rs.username, 'Session-Timeout' as attribute, CASE WHEN rp.validity_value > 0 THEN (rp.validity_value * CASE rp.validity_unit WHEN 'hours' THEN 3600 WHEN 'days' THEN 86400 WHEN 'weeks' THEN 604800 WHEN 'months' THEN 2592000 ELSE 86400 END )::text ELSE '86400' END as value, '=' as op FROM radius_subscriptions rs JOIN radius_packages rp ON rs.package_id = rp.id WHERE rs.username = '%{SQL-User-Name}' AND rs.status = 'active' AND (rs.expires_at IS NULL OR rs.expires_at > NOW()) UNION ALL SELECT rs.id, rs.username, 'Simultaneous-Use' as attribute, rp.max_sessions::text as value, ':=' as op FROM radius_subscriptions rs JOIN radius_packages rp ON rs.package_id = rp.id WHERE rs.username = '%{SQL-User-Name}' AND rs.status = 'active' AND (rs.expires_at IS NULL OR rs.expires_at > NOW()) AND rp.max_sessions > 0 UNION ALL SELECT rs.id, rs.username, 'Framed-IP-Address' as attribute, rs.static_ip as value, '=' as op FROM radius_subscriptions rs WHERE rs.username = '%{SQL-User-Name}' AND rs.status = 'active' AND (rs.expires_at IS NULL OR rs.expires_at > NOW()) AND rs.static_ip IS NOT NULL AND rs.static_ip != ''"
        group_membership_query = "SELECT rp.name as groupname FROM radius_subscriptions rs JOIN radius_packages rp ON rs.package_id = rp.id WHERE rs.username = '%{SQL-User-Name}' AND rs.status = 'active' ORDER BY rp.id"
        simul_count_query = "SELECT COUNT(*) FROM radius_sessions WHERE subscription_id = ( SELECT id FROM radius_subscriptions WHERE username = '%{SQL-User-Name}' ) AND stopped_at IS NULL"
        simul_verify_query = "SELECT framed_ip as framedipaddress, session_id as acctsessionid, nas_ip as nasipaddress, nas_port as nasportid, mac_address as callingstationid, (SELECT username FROM radius_subscriptions WHERE id = subscription_id) as username, '' as framedprotocol FROM radius_sessions WHERE subscription_id = ( SELECT id FROM radius_subscriptions WHERE username = '%{SQL-User-Name}' ) AND stopped_at IS NULL ORDER BY started_at DESC"
        query = "INSERT INTO radpostauth (username, pass, reply, authdate, nasipaddress, calledstationid, callingstationid) VALUES ( '%{SQL-User-Name}', '%{%{User-Password}:-%{Chap-Password}}', '%{reply:Packet-Type}', NOW(), '%{NAS-IP-Address}', '%{Called-Station-Id}', '%{Calling-Station-Id}')"
rlm_sql (sql): Driver rlm_sql_postgresql (module rlm_sql_postgresql) loaded and linked
Creating attribute SQL-Group
including configuration file /etc/freeradius/clients.conf
including configuration file /etc/freeradius/mods-enabled/dynamic_clients
including configuration file /etc/freeradius/mods-enabled/sql
including configuration file /etc/freeradius/mods-config/sql/main/postgresql/queries.conf
including configuration file /etc/freeradius/sites-enabled/dynamic_clients
        postauth_client_lost = no
radiusd: #### Loading Clients ####
 client localhost {
 client localhost_ipv6 {
 client dynamic {
        dynamic_clients = "dynamic_clients"
  # Loaded module rlm_dynamic_clients
  # Loading module "dynamic_clients" from file /etc/freeradius/mods-enabled/dynamic_clients
  # Loaded module rlm_sql
  # Loading module "sql" from file /etc/freeradius/mods-enabled/sql
  sql {
        driver = "rlm_sql_postgresql"
        read_clients = yes
        sql_user_name = "%{%{Stripped-User-Name}:-%{%{User-Name}:-DEFAULT}}"
        client_query = "SELECT id as id, ip_address as nasname, secret as secret, COALESCE(nas_type, 'mikrotik') as type, NULL as server, NULL as community, name as shortname, description as description, NULL as virtual_server, COALESCE(nas_type, 'mikrotik') as nas_type FROM radius_nas WHERE is_active = true"
        authorize_check_query = "SELECT id, username, 'Cleartext-Password' as attribute, password as value, ':=' as op FROM radius_subscriptions WHERE username = '%{SQL-User-Name}' AND status = 'active' AND (expires_at IS NULL OR expires_at > NOW())"
        authorize_reply_query = "SELECT rs.id, rs.username, CASE WHEN rp.download_speed > 0 THEN 'Mikrotik-Rate-Limit' ELSE NULL END as attribute, CASE WHEN rp.download_speed > 0 THEN CONCAT(rp.upload_speed::text, 'M/', rp.download_speed::text, 'M') ELSE NULL END as value, '=' as op FROM radius_subscriptions rs JOIN radius_packages rp ON rs.package_id = rp.id WHERE rs.username = '%{SQL-User-Name}' AND rs.status = 'active' AND (rs.expires_at IS NULL OR rs.expires_at > NOW()) AND rp.download_speed > 0 UNION ALL SELECT rs.id, rs.username, 'Session-Timeout' as attribute, CASE WHEN rp.validity_value > 0 THEN (rp.validity_value * CASE rp.validity_unit WHEN 'hours' THEN 3600 WHEN 'days' THEN 86400 WHEN 'weeks' THEN 604800 WHEN 'months' THEN 2592000 ELSE 86400 END )::text ELSE '86400' END as value, '=' as op FROM radius_subscriptions rs JOIN radius_packages rp ON rs.package_id = rp.id WHERE rs.username = '%{SQL-User-Name}' AND rs.status = 'active' AND (rs.expires_at IS NULL OR rs.expires_at > NOW()) UNION ALL SELECT rs.id, rs.username, 'Simultaneous-Use' as attribute, rp.max_sessions::text as value, ':=' as op FROM radius_subscriptions rs JOIN radius_packages rp ON rs.package_id = rp.id WHERE rs.username = '%{SQL-User-Name}' AND rs.status = 'active' AND (rs.expires_at IS NULL OR rs.expires_at > NOW()) AND rp.max_sessions > 0 UNION ALL SELECT rs.id, rs.username, 'Framed-IP-Address' as attribute, rs.static_ip as value, '=' as op FROM radius_subscriptions rs WHERE rs.username = '%{SQL-User-Name}' AND rs.status = 'active' AND (rs.expires_at IS NULL OR rs.expires_at > NOW()) AND rs.static_ip IS NOT NULL AND rs.static_ip != ''"
        group_membership_query = "SELECT rp.name as groupname FROM radius_subscriptions rs JOIN radius_packages rp ON rs.package_id = rp.id WHERE rs.username = '%{SQL-User-Name}' AND rs.status = 'active' ORDER BY rp.id"
        simul_count_query = "SELECT COUNT(*) FROM radius_sessions WHERE subscription_id = ( SELECT id FROM radius_subscriptions WHERE username = '%{SQL-User-Name}' ) AND stopped_at IS NULL"
        simul_verify_query = "SELECT framed_ip as framedipaddress, session_id as acctsessionid, nas_ip as nasipaddress, nas_port as nasportid, mac_address as callingstationid, (SELECT username FROM radius_subscriptions WHERE id = subscription_id) as username, '' as framedprotocol FROM radius_sessions WHERE subscription_id = ( SELECT id FROM radius_subscriptions WHERE username = '%{SQL-User-Name}' ) AND stopped_at IS NULL ORDER BY started_at DESC"
        query = "INSERT INTO radpostauth (username, pass, reply, authdate, nasipaddress, calledstationid, callingstationid) VALUES ( '%{SQL-User-Name}', '%{%{User-Password}:-%{Chap-Password}}', '%{reply:Packet-Type}', NOW(), '%{NAS-IP-Address}', '%{Called-Station-Id}', '%{Calling-Station-Id}')"
rlm_sql (sql): Driver rlm_sql_postgresql (module rlm_sql_postgresql) loaded and linked
Creating attribute SQL-Group
including configuration file /etc/freeradius/clients.conf
including configuration file /etc/freeradius/mods-enabled/dynamic_clients
including configuration file /etc/freeradius/mods-enabled/sql
including configuration file /etc/freeradius/mods-config/sql/main/postgresql/queries.conf
including configuration file /etc/freeradius/sites-enabled/dynamic_clients
        postauth_client_lost = no
radiusd: #### Loading Clients ####
 client localhost {
 client localhost_ipv6 {
 client dynamic {
        dynamic_clients = "dynamic_clients"
  # Loaded module rlm_dynamic_clients
  # Loading module "dynamic_clients" from file /etc/freeradius/mods-enabled/dynamic_clients
  # Loaded module rlm_sql
  # Loading module "sql" from file /etc/freeradius/mods-enabled/sql
  sql {
        driver = "rlm_sql_postgresql"
        read_clients = yes
        sql_user_name = "%{%{Stripped-User-Name}:-%{%{User-Name}:-DEFAULT}}"
        client_query = "SELECT id as id, ip_address as nasname, secret as secret, COALESCE(nas_type, 'mikrotik') as type, NULL as server, NULL as community, name as shortname, description as description, NULL as virtual_server, COALESCE(nas_type, 'mikrotik') as nas_type FROM radius_nas WHERE is_active = true"
        authorize_check_query = "SELECT id, username, 'Cleartext-Password' as attribute, password as value, ':=' as op FROM radius_subscriptions WHERE username = '%{SQL-User-Name}' AND status = 'active' AND (expires_at IS NULL OR expires_at > NOW())"
        authorize_reply_query = "SELECT rs.id, rs.username, CASE WHEN rp.download_speed > 0 THEN 'Mikrotik-Rate-Limit' ELSE NULL END as attribute, CASE WHEN rp.download_speed > 0 THEN CONCAT(rp.upload_speed::text, 'M/', rp.download_speed::text, 'M') ELSE NULL END as value, '=' as op FROM radius_subscriptions rs JOIN radius_packages rp ON rs.package_id = rp.id WHERE rs.username = '%{SQL-User-Name}' AND rs.status = 'active' AND (rs.expires_at IS NULL OR rs.expires_at > NOW()) AND rp.download_speed > 0 UNION ALL SELECT rs.id, rs.username, 'Session-Timeout' as attribute, CASE WHEN rp.validity_value > 0 THEN (rp.validity_value * CASE rp.validity_unit WHEN 'hours' THEN 3600 WHEN 'days' THEN 86400 WHEN 'weeks' THEN 604800 WHEN 'months' THEN 2592000 ELSE 86400 END )::text ELSE '86400' END as value, '=' as op FROM radius_subscriptions rs JOIN radius_packages rp ON rs.package_id = rp.id WHERE rs.username = '%{SQL-User-Name}' AND rs.status = 'active' AND (rs.expires_at IS NULL OR rs.expires_at > NOW()) UNION ALL SELECT rs.id, rs.username, 'Simultaneous-Use' as attribute, rp.max_sessions::text as value, ':=' as op FROM radius_subscriptions rs JOIN radius_packages rp ON rs.package_id = rp.id WHERE rs.username = '%{SQL-User-Name}' AND rs.status = 'active' AND (rs.expires_at IS NULL OR rs.expires_at > NOW()) AND rp.max_sessions > 0 UNION ALL SELECT rs.id, rs.username, 'Framed-IP-Address' as attribute, rs.static_ip as value, '=' as op FROM radius_subscriptions rs WHERE rs.username = '%{SQL-User-Name}' AND rs.status = 'active' AND (rs.expires_at IS NULL OR rs.expires_at > NOW()) AND rs.static_ip IS NOT NULL AND rs.static_ip != ''"
        group_membership_query = "SELECT rp.name as groupname FROM radius_subscriptions rs JOIN radius_packages rp ON rs.package_id = rp.id WHERE rs.username = '%{SQL-User-Name}' AND rs.status = 'active' ORDER BY rp.id"
        simul_count_query = "SELECT COUNT(*) FROM radius_sessions WHERE subscription_id = ( SELECT id FROM radius_subscriptions WHERE username = '%{SQL-User-Name}' ) AND stopped_at IS NULL"
        simul_verify_query = "SELECT framed_ip as framedipaddress, session_id as acctsessionid, nas_ip as nasipaddress, nas_port as nasportid, mac_address as callingstationid, (SELECT username FROM radius_subscriptions WHERE id = subscription_id) as username, '' as framedprotocol FROM radius_sessions WHERE subscription_id = ( SELECT id FROM radius_subscriptions WHERE username = '%{SQL-User-Name}' ) AND stopped_at IS NULL ORDER BY started_at DESC"
        query = "INSERT INTO radpostauth (username, pass, reply, authdate, nasipaddress, calledstationid, callingstationid) VALUES ( '%{SQL-User-Name}', '%{%{User-Password}:-%{Chap-Password}}', '%{reply:Packet-Type}', NOW(), '%{NAS-IP-Address}', '%{Called-Station-Id}', '%{Calling-Station-Id}')"
rlm_sql (sql): Driver rlm_sql_postgresql (module rlm_sql_postgresql) loaded and linked
Creating attribute SQL-Group
including configuration file /etc/freeradius/clients.conf
including configuration file /etc/freeradius/mods-enabled/dynamic_clients
including configuration file /etc/freeradius/mods-enabled/sql
including configuration file /etc/freeradius/mods-config/sql/main/postgresql/queries.conf
including configuration file /etc/freeradius/sites-enabled/dynamic_clients
        postauth_client_lost = no
radiusd: #### Loading Clients ####
 client localhost {
 client localhost_ipv6 {
 client dynamic {
        dynamic_clients = "dynamic_clients"
  # Loaded module rlm_dynamic_clients
  # Loading module "dynamic_clients" from file /etc/freeradius/mods-enabled/dynamic_clients
  # Loaded module rlm_sql
  # Loading module "sql" from file /etc/freeradius/mods-enabled/sql
  sql {
        driver = "rlm_sql_postgresql"
        read_clients = yes
        sql_user_name = "%{%{Stripped-User-Name}:-%{%{User-Name}:-DEFAULT}}"
        client_query = "SELECT id as id, ip_address as nasname, secret as secret, COALESCE(nas_type, 'mikrotik') as type, NULL as server, NULL as community, name as shortname, description as description, NULL as virtual_server, COALESCE(nas_type, 'mikrotik') as nas_type FROM radius_nas WHERE is_active = true"
        authorize_check_query = "SELECT id, username, 'Cleartext-Password' as attribute, password as value, ':=' as op FROM radius_subscriptions WHERE username = '%{SQL-User-Name}' AND status = 'active' AND (expires_at IS NULL OR expires_at > NOW())"
        authorize_reply_query = "SELECT rs.id, rs.username, CASE WHEN rp.download_speed > 0 THEN 'Mikrotik-Rate-Limit' ELSE NULL END as attribute, CASE WHEN rp.download_speed > 0 THEN CONCAT(rp.upload_speed::text, 'M/', rp.download_speed::text, 'M') ELSE NULL END as value, '=' as op FROM radius_subscriptions rs JOIN radius_packages rp ON rs.package_id = rp.id WHERE rs.username = '%{SQL-User-Name}' AND rs.status = 'active' AND (rs.expires_at IS NULL OR rs.expires_at > NOW()) AND rp.download_speed > 0 UNION ALL SELECT rs.id, rs.username, 'Session-Timeout' as attribute, CASE WHEN rp.validity_value > 0 THEN (rp.validity_value * CASE rp.validity_unit WHEN 'hours' THEN 3600 WHEN 'days' THEN 86400 WHEN 'weeks' THEN 604800 WHEN 'months' THEN 2592000 ELSE 86400 END )::text ELSE '86400' END as value, '=' as op FROM radius_subscriptions rs JOIN radius_packages rp ON rs.package_id = rp.id WHERE rs.username = '%{SQL-User-Name}' AND rs.status = 'active' AND (rs.expires_at IS NULL OR rs.expires_at > NOW()) UNION ALL SELECT rs.id, rs.username, 'Simultaneous-Use' as attribute, rp.max_sessions::text as value, ':=' as op FROM radius_subscriptions rs JOIN radius_packages rp ON rs.package_id = rp.id WHERE rs.username = '%{SQL-User-Name}' AND rs.status = 'active' AND (rs.expires_at IS NULL OR rs.expires_at > NOW()) AND rp.max_sessions > 0 UNION ALL SELECT rs.id, rs.username, 'Framed-IP-Address' as attribute, rs.static_ip as value, '=' as op FROM radius_subscriptions rs WHERE rs.username = '%{SQL-User-Name}' AND rs.status = 'active' AND (rs.expires_at IS NULL OR rs.expires_at > NOW()) AND rs.static_ip IS NOT NULL AND rs.static_ip != ''"
        group_membership_query = "SELECT rp.name as groupname FROM radius_subscriptions rs JOIN radius_packages rp ON rs.package_id = rp.id WHERE rs.username = '%{SQL-User-Name}' AND rs.status = 'active' ORDER BY rp.id"
        simul_count_query = "SELECT COUNT(*) FROM radius_sessions WHERE subscription_id = ( SELECT id FROM radius_subscriptions WHERE username = '%{SQL-User-Name}' ) AND stopped_at IS NULL"
        simul_verify_query = "SELECT framed_ip as framedipaddress, session_id as acctsessionid, nas_ip as nasipaddress, nas_port as nasportid, mac_address as callingstationid, (SELECT username FROM radius_subscriptions WHERE id = subscription_id) as username, '' as framedprotocol FROM radius_sessions WHERE subscription_id = ( SELECT id FROM radius_subscriptions WHERE username = '%{SQL-User-Name}' ) AND stopped_at IS NULL ORDER BY started_at DESC"
        query = "INSERT INTO radpostauth (username, pass, reply, authdate, nasipaddress, calledstationid, callingstationid) VALUES ( '%{SQL-User-Name}', '%{%{User-Password}:-%{Chap-Password}}', '%{reply:Packet-Type}', NOW(), '%{NAS-IP-Address}', '%{Called-Station-Id}', '%{Calling-Station-Id}')"
rlm_sql (sql): Driver rlm_sql_postgresql (module rlm_sql_postgresql) loaded and linked
Creating attribute SQL-Group
including configuration file /etc/freeradius/clients.conf
including configuration file /etc/freeradius/mods-enabled/dynamic_clients
including configuration file /etc/freeradius/mods-enabled/sql
including configuration file /etc/freeradius/mods-config/sql/main/postgresql/queries.conf
including configuration file /etc/freeradius/sites-enabled/dynamic_clients
        postauth_client_lost = no
radiusd: #### Loading Clients ####
 client localhost {
 client localhost_ipv6 {
 client dynamic {
        dynamic_clients = "dynamic_clients"
  # Loaded module rlm_dynamic_clients
  # Loading module "dynamic_clients" from file /etc/freeradius/mods-enabled/dynamic_clients
  # Loaded module rlm_sql
  # Loading module "sql" from file /etc/freeradius/mods-enabled/sql
  sql {
        driver = "rlm_sql_postgresql"
        read_clients = yes
        sql_user_name = "%{%{Stripped-User-Name}:-%{%{User-Name}:-DEFAULT}}"
        client_query = "SELECT id as id, ip_address as nasname, secret as secret, COALESCE(nas_type, 'mikrotik') as type, NULL as server, NULL as community, name as shortname, description as description, NULL as virtual_server, COALESCE(nas_type, 'mikrotik') as nas_type FROM radius_nas WHERE is_active = true"
        authorize_check_query = "SELECT id, username, 'Cleartext-Password' as attribute, password as value, ':=' as op FROM radius_subscriptions WHERE username = '%{SQL-User-Name}' AND status = 'active' AND (expires_at IS NULL OR expires_at > NOW())"
        authorize_reply_query = "SELECT rs.id, rs.username, CASE WHEN rp.download_speed > 0 THEN 'Mikrotik-Rate-Limit' ELSE NULL END as attribute, CASE WHEN rp.download_speed > 0 THEN CONCAT(rp.upload_speed::text, 'M/', rp.download_speed::text, 'M') ELSE NULL END as value, '=' as op FROM radius_subscriptions rs JOIN radius_packages rp ON rs.package_id = rp.id WHERE rs.username = '%{SQL-User-Name}' AND rs.status = 'active' AND (rs.expires_at IS NULL OR rs.expires_at > NOW()) AND rp.download_speed > 0 UNION ALL SELECT rs.id, rs.username, 'Session-Timeout' as attribute, CASE WHEN rp.validity_value > 0 THEN (rp.validity_value * CASE rp.validity_unit WHEN 'hours' THEN 3600 WHEN 'days' THEN 86400 WHEN 'weeks' THEN 604800 WHEN 'months' THEN 2592000 ELSE 86400 END )::text ELSE '86400' END as value, '=' as op FROM radius_subscriptions rs JOIN radius_packages rp ON rs.package_id = rp.id WHERE rs.username = '%{SQL-User-Name}' AND rs.status = 'active' AND (rs.expires_at IS NULL OR rs.expires_at > NOW()) UNION ALL SELECT rs.id, rs.username, 'Simultaneous-Use' as attribute, rp.max_sessions::text as value, ':=' as op FROM radius_subscriptions rs JOIN radius_packages rp ON rs.package_id = rp.id WHERE rs.username = '%{SQL-User-Name}' AND rs.status = 'active' AND (rs.expires_at IS NULL OR rs.expires_at > NOW()) AND rp.max_sessions > 0 UNION ALL SELECT rs.id, rs.username, 'Framed-IP-Address' as attribute, rs.static_ip as value, '=' as op FROM radius_subscriptions rs WHERE rs.username = '%{SQL-User-Name}' AND rs.status = 'active' AND (rs.expires_at IS NULL OR rs.expires_at > NOW()) AND rs.static_ip IS NOT NULL AND rs.static_ip != ''"
        group_membership_query = "SELECT rp.name as groupname FROM radius_subscriptions rs JOIN radius_packages rp ON rs.package_id = rp.id WHERE rs.username = '%{SQL-User-Name}' AND rs.status = 'active' ORDER BY rp.id"
        simul_count_query = "SELECT COUNT(*) FROM radius_sessions WHERE subscription_id = ( SELECT id FROM radius_subscriptions WHERE username = '%{SQL-User-Name}' ) AND stopped_at IS NULL"
        simul_verify_query = "SELECT framed_ip as framedipaddress, session_id as acctsessionid, nas_ip as nasipaddress, nas_port as nasportid, mac_address as callingstationid, (SELECT username FROM radius_subscriptions WHERE id = subscription_id) as username, '' as framedprotocol FROM radius_sessions WHERE subscription_id = ( SELECT id FROM radius_subscriptions WHERE username = '%{SQL-User-Name}' ) AND stopped_at IS NULL ORDER BY started_at DESC"
        query = "INSERT INTO radpostauth (username, pass, reply, authdate, nasipaddress, calledstationid, callingstationid) VALUES ( '%{SQL-User-Name}', '%{%{User-Password}:-%{Chap-Password}}', '%{reply:Packet-Type}', NOW(), '%{NAS-IP-Address}', '%{Called-Station-Id}', '%{Calling-Station-Id}')"
rlm_sql (sql): Driver rlm_sql_postgresql (module rlm_sql_postgresql) loaded and linked
Creating attribute SQL-Group
including configuration file /etc/freeradius/clients.conf
including configuration file /etc/freeradius/mods-enabled/dynamic_clients
including configuration file /etc/freeradius/mods-enabled/sql
including configuration file /etc/freeradius/mods-config/sql/main/postgresql/queries.conf
including configuration file /etc/freeradius/sites-enabled/dynamic_clients
        postauth_client_lost = no
radiusd: #### Loading Clients ####
 client localhost {
 client localhost_ipv6 {
 client dynamic {
        dynamic_clients = "dynamic_clients"
  # Loaded module rlm_dynamic_clients
  # Loading module "dynamic_clients" from file /etc/freeradius/mods-enabled/dynamic_clients
  # Loaded module rlm_sql
  # Loading module "sql" from file /etc/freeradius/mods-enabled/sql
  sql {
        driver = "rlm_sql_postgresql"
        read_clients = yes
        sql_user_name = "%{%{Stripped-User-Name}:-%{%{User-Name}:-DEFAULT}}"
        client_query = "SELECT id as id, ip_address as nasname, secret as secret, COALESCE(nas_type, 'mikrotik') as type, NULL as server, NULL as community, name as shortname, description as description, NULL as virtual_server, COALESCE(nas_type, 'mikrotik') as nas_type FROM radius_nas WHERE is_active = true"
        authorize_check_query = "SELECT id, username, 'Cleartext-Password' as attribute, password as value, ':=' as op FROM radius_subscriptions WHERE username = '%{SQL-User-Name}' AND status = 'active' AND (expires_at IS NULL OR expires_at > NOW())"
        authorize_reply_query = "SELECT rs.id, rs.username, CASE WHEN rp.download_speed > 0 THEN 'Mikrotik-Rate-Limit' ELSE NULL END as attribute, CASE WHEN rp.download_speed > 0 THEN CONCAT(rp.upload_speed::text, 'M/', rp.download_speed::text, 'M') ELSE NULL END as value, '=' as op FROM radius_subscriptions rs JOIN radius_packages rp ON rs.package_id = rp.id WHERE rs.username = '%{SQL-User-Name}' AND rs.status = 'active' AND (rs.expires_at IS NULL OR rs.expires_at > NOW()) AND rp.download_speed > 0 UNION ALL SELECT rs.id, rs.username, 'Session-Timeout' as attribute, CASE WHEN rp.validity_value > 0 THEN (rp.validity_value * CASE rp.validity_unit WHEN 'hours' THEN 3600 WHEN 'days' THEN 86400 WHEN 'weeks' THEN 604800 WHEN 'months' THEN 2592000 ELSE 86400 END )::text ELSE '86400' END as value, '=' as op FROM radius_subscriptions rs JOIN radius_packages rp ON rs.package_id = rp.id WHERE rs.username = '%{SQL-User-Name}' AND rs.status = 'active' AND (rs.expires_at IS NULL OR rs.expires_at > NOW()) UNION ALL SELECT rs.id, rs.username, 'Simultaneous-Use' as attribute, rp.max_sessions::text as value, ':=' as op FROM radius_subscriptions rs JOIN radius_packages rp ON rs.package_id = rp.id WHERE rs.username = '%{SQL-User-Name}' AND rs.status = 'active' AND (rs.expires_at IS NULL OR rs.expires_at > NOW()) AND rp.max_sessions > 0 UNION ALL SELECT rs.id, rs.username, 'Framed-IP-Address' as attribute, rs.static_ip as value, '=' as op FROM radius_subscriptions rs WHERE rs.username = '%{SQL-User-Name}' AND rs.status = 'active' AND (rs.expires_at IS NULL OR rs.expires_at > NOW()) AND rs.static_ip IS NOT NULL AND rs.static_ip != ''"
        group_membership_query = "SELECT rp.name as groupname FROM radius_subscriptions rs JOIN radius_packages rp ON rs.package_id = rp.id WHERE rs.username = '%{SQL-User-Name}' AND rs.status = 'active' ORDER BY rp.id"
        simul_count_query = "SELECT COUNT(*) FROM radius_sessions WHERE subscription_id = ( SELECT id FROM radius_subscriptions WHERE username = '%{SQL-User-Name}' ) AND stopped_at IS NULL"
        simul_verify_query = "SELECT framed_ip as framedipaddress, session_id as acctsessionid, nas_ip as nasipaddress, nas_port as nasportid, mac_address as callingstationid, (SELECT username FROM radius_subscriptions WHERE id = subscription_id) as username, '' as framedprotocol FROM radius_sessions WHERE subscription_id = ( SELECT id FROM radius_subscriptions WHERE username = '%{SQL-User-Name}' ) AND stopped_at IS NULL ORDER BY started_at DESC"
        query = "INSERT INTO radpostauth (username, pass, reply, authdate, nasipaddress, calledstationid, callingstationid) VALUES ( '%{SQL-User-Name}', '%{%{User-Password}:-%{Chap-Password}}', '%{reply:Packet-Type}', NOW(), '%{NAS-IP-Address}', '%{Called-Station-Id}', '%{Calling-Station-Id}')"
rlm_sql (sql): Driver rlm_sql_postgresql (module rlm_sql_postgresql) loaded and linked
Creating attribute SQL-Group
including configuration file /etc/freeradius/clients.conf
including configuration file /etc/freeradius/mods-enabled/dynamic_clients
including configuration file /etc/freeradius/mods-enabled/sql
including configuration file /etc/freeradius/mods-config/sql/main/postgresql/queries.conf
including configuration file /etc/freeradius/sites-enabled/dynamic_clients
        postauth_client_lost = no
radiusd: #### Loading Clients ####
 client localhost {
 client localhost_ipv6 {
 client dynamic {
        dynamic_clients = "dynamic_clients"
  # Loaded module rlm_dynamic_clients
  # Loading module "dynamic_clients" from file /etc/freeradius/mods-enabled/dynamic_clients
  # Loaded module rlm_sql
  # Loading module "sql" from file /etc/freeradius/mods-enabled/sql
  sql {
        driver = "rlm_sql_postgresql"
        read_clients = yes
        sql_user_name = "%{%{Stripped-User-Name}:-%{%{User-Name}:-DEFAULT}}"
        client_query = "SELECT id as id, ip_address as nasname, secret as secret, COALESCE(nas_type, 'mikrotik') as type, NULL as server, NULL as community, name as shortname, description as description, NULL as virtual_server, COALESCE(nas_type, 'mikrotik') as nas_type FROM radius_nas WHERE is_active = true"
        authorize_check_query = "SELECT id, username, 'Cleartext-Password' as attribute, password as value, ':=' as op FROM radius_subscriptions WHERE username = '%{SQL-User-Name}' AND status = 'active' AND (expires_at IS NULL OR expires_at > NOW())"
        authorize_reply_query = "SELECT rs.id, rs.username, CASE WHEN rp.download_speed > 0 THEN 'Mikrotik-Rate-Limit' ELSE NULL END as attribute, CASE WHEN rp.download_speed > 0 THEN CONCAT(rp.upload_speed::text, 'M/', rp.download_speed::text, 'M') ELSE NULL END as value, '=' as op FROM radius_subscriptions rs JOIN radius_packages rp ON rs.package_id = rp.id WHERE rs.username = '%{SQL-User-Name}' AND rs.status = 'active' AND (rs.expires_at IS NULL OR rs.expires_at > NOW()) AND rp.download_speed > 0 UNION ALL SELECT rs.id, rs.username, 'Session-Timeout' as attribute, CASE WHEN rp.validity_value > 0 THEN (rp.validity_value * CASE rp.validity_unit WHEN 'hours' THEN 3600 WHEN 'days' THEN 86400 WHEN 'weeks' THEN 604800 WHEN 'months' THEN 2592000 ELSE 86400 END )::text ELSE '86400' END as value, '=' as op FROM radius_subscriptions rs JOIN radius_packages rp ON rs.package_id = rp.id WHERE rs.username = '%{SQL-User-Name}' AND rs.status = 'active' AND (rs.expires_at IS NULL OR rs.expires_at > NOW()) UNION ALL SELECT rs.id, rs.username, 'Simultaneous-Use' as attribute, rp.max_sessions::text as value, ':=' as op FROM radius_subscriptions rs JOIN radius_packages rp ON rs.package_id = rp.id WHERE rs.username = '%{SQL-User-Name}' AND rs.status = 'active' AND (rs.expires_at IS NULL OR rs.expires_at > NOW()) AND rp.max_sessions > 0 UNION ALL SELECT rs.id, rs.username, 'Framed-IP-Address' as attribute, rs.static_ip as value, '=' as op FROM radius_subscriptions rs WHERE rs.username = '%{SQL-User-Name}' AND rs.status = 'active' AND (rs.expires_at IS NULL OR rs.expires_at > NOW()) AND rs.static_ip IS NOT NULL AND rs.static_ip != ''"
        group_membership_query = "SELECT rp.name as groupname FROM radius_subscriptions rs JOIN radius_packages rp ON rs.package_id = rp.id WHERE rs.username = '%{SQL-User-Name}' AND rs.status = 'active' ORDER BY rp.id"
        simul_count_query = "SELECT COUNT(*) FROM radius_sessions WHERE subscription_id = ( SELECT id FROM radius_subscriptions WHERE username = '%{SQL-User-Name}' ) AND stopped_at IS NULL"
        simul_verify_query = "SELECT framed_ip as framedipaddress, session_id as acctsessionid, nas_ip as nasipaddress, nas_port as nasportid, mac_address as callingstationid, (SELECT username FROM radius_subscriptions WHERE id = subscription_id) as username, '' as framedprotocol FROM radius_sessions WHERE subscription_id = ( SELECT id FROM radius_subscriptions WHERE username = '%{SQL-User-Name}' ) AND stopped_at IS NULL ORDER BY started_at DESC"
        query = "INSERT INTO radpostauth (username, pass, reply, authdate, nasipaddress, calledstationid, callingstationid) VALUES ( '%{SQL-User-Name}', '%{%{User-Password}:-%{Chap-Password}}', '%{reply:Packet-Type}', NOW(), '%{NAS-IP-Address}', '%{Called-Station-Id}', '%{Calling-Station-Id}')"
rlm_sql (sql): Driver rlm_sql_postgresql (module rlm_sql_postgresql) loaded and linked
Creating attribute SQL-Group
including configuration file /etc/freeradius/clients.conf
including configuration file /etc/freeradius/mods-enabled/dynamic_clients
including configuration file /etc/freeradius/mods-enabled/sql
including configuration file /etc/freeradius/mods-config/sql/main/postgresql/queries.conf
including configuration file /etc/freeradius/sites-enabled/dynamic_clients
        postauth_client_lost = no
radiusd: #### Loading Clients ####
 client localhost {
 client localhost_ipv6 {
 client dynamic {
        dynamic_clients = "dynamic_clients"
  # Loaded module rlm_dynamic_clients
  # Loading module "dynamic_clients" from file /etc/freeradius/mods-enabled/dynamic_clients
  # Loaded module rlm_sql
  # Loading module "sql" from file /etc/freeradius/mods-enabled/sql
  sql {
        driver = "rlm_sql_postgresql"
        read_clients = yes
        sql_user_name = "%{%{Stripped-User-Name}:-%{%{User-Name}:-DEFAULT}}"
        client_query = "SELECT id as id, ip_address as nasname, secret as secret, COALESCE(nas_type, 'mikrotik') as type, NULL as server, NULL as community, name as shortname, description as description, NULL as virtual_server, COALESCE(nas_type, 'mikrotik') as nas_type FROM radius_nas WHERE is_active = true"
        authorize_check_query = "SELECT id, username, 'Cleartext-Password' as attribute, password as value, ':=' as op FROM radius_subscriptions WHERE username = '%{SQL-User-Name}' AND status = 'active' AND (expires_at IS NULL OR expires_at > NOW())"
        authorize_reply_query = "SELECT rs.id, rs.username, CASE WHEN rp.download_speed > 0 THEN 'Mikrotik-Rate-Limit' ELSE NULL END as attribute, CASE WHEN rp.download_speed > 0 THEN CONCAT(rp.upload_speed::text, 'M/', rp.download_speed::text, 'M') ELSE NULL END as value, '=' as op FROM radius_subscriptions rs JOIN radius_packages rp ON rs.package_id = rp.id WHERE rs.username = '%{SQL-User-Name}' AND rs.status = 'active' AND (rs.expires_at IS NULL OR rs.expires_at > NOW()) AND rp.download_speed > 0 UNION ALL SELECT rs.id, rs.username, 'Session-Timeout' as attribute, CASE WHEN rp.validity_value > 0 THEN (rp.validity_value * CASE rp.validity_unit WHEN 'hours' THEN 3600 WHEN 'days' THEN 86400 WHEN 'weeks' THEN 604800 WHEN 'months' THEN 2592000 ELSE 86400 END )::text ELSE '86400' END as value, '=' as op FROM radius_subscriptions rs JOIN radius_packages rp ON rs.package_id = rp.id WHERE rs.username = '%{SQL-User-Name}' AND rs.status = 'active' AND (rs.expires_at IS NULL OR rs.expires_at > NOW()) UNION ALL SELECT rs.id, rs.username, 'Simultaneous-Use' as attribute, rp.max_sessions::text as value, ':=' as op FROM radius_subscriptions rs JOIN radius_packages rp ON rs.package_id = rp.id WHERE rs.username = '%{SQL-User-Name}' AND rs.status = 'active' AND (rs.expires_at IS NULL OR rs.expires_at > NOW()) AND rp.max_sessions > 0 UNION ALL SELECT rs.id, rs.username, 'Framed-IP-Address' as attribute, rs.static_ip as value, '=' as op FROM radius_subscriptions rs WHERE rs.username = '%{SQL-User-Name}' AND rs.status = 'active' AND (rs.expires_at IS NULL OR rs.expires_at > NOW()) AND rs.static_ip IS NOT NULL AND rs.static_ip != ''"
        group_membership_query = "SELECT rp.name as groupname FROM radius_subscriptions rs JOIN radius_packages rp ON rs.package_id = rp.id WHERE rs.username = '%{SQL-User-Name}' AND rs.status = 'active' ORDER BY rp.id"
        simul_count_query = "SELECT COUNT(*) FROM radius_sessions WHERE subscription_id = ( SELECT id FROM radius_subscriptions WHERE username = '%{SQL-User-Name}' ) AND stopped_at IS NULL"
        simul_verify_query = "SELECT framed_ip as framedipaddress, session_id as acctsessionid, nas_ip as nasipaddress, nas_port as nasportid, mac_address as callingstationid, (SELECT username FROM radius_subscriptions WHERE id = subscription_id) as username, '' as framedprotocol FROM radius_sessions WHERE subscription_id = ( SELECT id FROM radius_subscriptions WHERE username = '%{SQL-User-Name}' ) AND stopped_at IS NULL ORDER BY started_at DESC"
        query = "INSERT INTO radpostauth (username, pass, reply, authdate, nasipaddress, calledstationid, callingstationid) VALUES ( '%{SQL-User-Name}', '%{%{User-Password}:-%{Chap-Password}}', '%{reply:Packet-Type}', NOW(), '%{NAS-IP-Address}', '%{Called-Station-Id}', '%{Calling-Station-Id}')"
rlm_sql (sql): Driver rlm_sql_postgresql (module rlm_sql_postgresql) loaded and linked
Creating attribute SQL-Group
including configuration file /etc/freeradius/clients.conf
including configuration file /etc/freeradius/mods-enabled/dynamic_clients
including configuration file /etc/freeradius/mods-enabled/sql
including configuration file /etc/freeradius/mods-config/sql/main/postgresql/queries.conf
including configuration file /etc/freeradius/sites-enabled/dynamic_clients
        postauth_client_lost = no
radiusd: #### Loading Clients ####
 client localhost {
 client localhost_ipv6 {
 client dynamic {
        dynamic_clients = "dynamic_clients"
  # Loaded module rlm_dynamic_clients
  # Loading module "dynamic_clients" from file /etc/freeradius/mods-enabled/dynamic_clients
  # Loaded module rlm_sql
  # Loading module "sql" from file /etc/freeradius/mods-enabled/sql
  sql {
        driver = "rlm_sql_postgresql"
        read_clients = yes
        sql_user_name = "%{%{Stripped-User-Name}:-%{%{User-Name}:-DEFAULT}}"
        client_query = "SELECT id as id, ip_address as nasname, secret as secret, COALESCE(nas_type, 'mikrotik') as type, NULL as server, NULL as community, name as shortname, description as description, NULL as virtual_server, COALESCE(nas_type, 'mikrotik') as nas_type FROM radius_nas WHERE is_active = true"
        authorize_check_query = "SELECT id, username, 'Cleartext-Password' as attribute, password as value, ':=' as op FROM radius_subscriptions WHERE username = '%{SQL-User-Name}' AND status = 'active' AND (expires_at IS NULL OR expires_at > NOW())"
        authorize_reply_query = "SELECT rs.id, rs.username, CASE WHEN rp.download_speed > 0 THEN 'Mikrotik-Rate-Limit' ELSE NULL END as attribute, CASE WHEN rp.download_speed > 0 THEN CONCAT(rp.upload_speed::text, 'M/', rp.download_speed::text, 'M') ELSE NULL END as value, '=' as op FROM radius_subscriptions rs JOIN radius_packages rp ON rs.package_id = rp.id WHERE rs.username = '%{SQL-User-Name}' AND rs.status = 'active' AND (rs.expires_at IS NULL OR rs.expires_at > NOW()) AND rp.download_speed > 0 UNION ALL SELECT rs.id, rs.username, 'Session-Timeout' as attribute, CASE WHEN rp.validity_value > 0 THEN (rp.validity_value * CASE rp.validity_unit WHEN 'hours' THEN 3600 WHEN 'days' THEN 86400 WHEN 'weeks' THEN 604800 WHEN 'months' THEN 2592000 ELSE 86400 END )::text ELSE '86400' END as value, '=' as op FROM radius_subscriptions rs JOIN radius_packages rp ON rs.package_id = rp.id WHERE rs.username = '%{SQL-User-Name}' AND rs.status = 'active' AND (rs.expires_at IS NULL OR rs.expires_at > NOW()) UNION ALL SELECT rs.id, rs.username, 'Simultaneous-Use' as attribute, rp.max_sessions::text as value, ':=' as op FROM radius_subscriptions rs JOIN radius_packages rp ON rs.package_id = rp.id WHERE rs.username = '%{SQL-User-Name}' AND rs.status = 'active' AND (rs.expires_at IS NULL OR rs.expires_at > NOW()) AND rp.max_sessions > 0 UNION ALL SELECT rs.id, rs.username, 'Framed-IP-Address' as attribute, rs.static_ip as value, '=' as op FROM radius_subscriptions rs WHERE rs.username = '%{SQL-User-Name}' AND rs.status = 'active' AND (rs.expires_at IS NULL OR rs.expires_at > NOW()) AND rs.static_ip IS NOT NULL AND rs.static_ip != ''"
        group_membership_query = "SELECT rp.name as groupname FROM radius_subscriptions rs JOIN radius_packages rp ON rs.package_id = rp.id WHERE rs.username = '%{SQL-User-Name}' AND rs.status = 'active' ORDER BY rp.id"
        simul_count_query = "SELECT COUNT(*) FROM radius_sessions WHERE subscription_id = ( SELECT id FROM radius_subscriptions WHERE username = '%{SQL-User-Name}' ) AND stopped_at IS NULL"
        simul_verify_query = "SELECT framed_ip as framedipaddress, session_id as acctsessionid, nas_ip as nasipaddress, nas_port as nasportid, mac_address as callingstationid, (SELECT username FROM radius_subscriptions WHERE id = subscription_id) as username, '' as framedprotocol FROM radius_sessions WHERE subscription_id = ( SELECT id FROM radius_subscriptions WHERE username = '%{SQL-User-Name}' ) AND stopped_at IS NULL ORDER BY started_at DESC"
        query = "INSERT INTO radpostauth (username, pass, reply, authdate, nasipaddress, calledstationid, callingstationid) VALUES ( '%{SQL-User-Name}', '%{%{User-Password}:-%{Chap-Password}}', '%{reply:Packet-Type}', NOW(), '%{NAS-IP-Address}', '%{Called-Station-Id}', '%{Calling-Station-Id}')"
rlm_sql (sql): Driver rlm_sql_postgresql (module rlm_sql_postgresql) loaded and linked
Creating attribute SQL-Group
root@superlitecrm:~/isp#
