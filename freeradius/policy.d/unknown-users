# Policy to accept unknown users with expired-pool for captive portal
# Include this in /etc/freeradius/policy.d/

policy accept_unknown_users {
    # Only trigger if no Auth-Type is set (meaning user not found)
    if (!&control:Auth-Type) {
        update control {
            Auth-Type := Accept
        }
        update reply {
            Framed-Pool := "expired-pool"
            Mikrotik-Rate-Limit := "128k/128k"
            Session-Timeout := 300
            Acct-Interim-Interval := 60
            Reply-Message := "Unknown user - portal redirect"
        }
    }
}
