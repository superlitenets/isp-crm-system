-- ============================================================
-- ISP CRM Complete Database Migration Script
-- Generated: $(date '+%Y-%m-%d %H:%M:%S')
-- ============================================================
-- 
-- This script adds all columns that may be missing in your VPS database.
-- Safe to run multiple times (uses IF NOT EXISTS).
--
-- HOW TO RUN ON YOUR VPS:
-- Option 1: Pipe directly
--   cat complete_migration.sql | docker exec -i isp_crm_db psql -U crm -d isp_crm
--
-- Option 2: Copy file first
--   docker cp complete_migration.sql isp_crm_db:/tmp/
--   docker exec -i isp_crm_db psql -U crm -d isp_crm -f /tmp/complete_migration.sql
--
-- ============================================================

 ALTER TABLE accounting_settings ADD COLUMN IF NOT EXISTS setting_key VARCHAR(100);
 ALTER TABLE accounting_settings ADD COLUMN IF NOT EXISTS setting_value TEXT;
 ALTER TABLE accounting_settings ADD COLUMN IF NOT EXISTS updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
 ALTER TABLE activity_logs ADD COLUMN IF NOT EXISTS user_id INTEGER;
 ALTER TABLE activity_logs ADD COLUMN IF NOT EXISTS action_type VARCHAR(50);
 ALTER TABLE activity_logs ADD COLUMN IF NOT EXISTS entity_type VARCHAR(50);
 ALTER TABLE activity_logs ADD COLUMN IF NOT EXISTS entity_id INTEGER;
 ALTER TABLE activity_logs ADD COLUMN IF NOT EXISTS entity_reference VARCHAR(100);
 ALTER TABLE activity_logs ADD COLUMN IF NOT EXISTS details TEXT;
 ALTER TABLE activity_logs ADD COLUMN IF NOT EXISTS ip_address VARCHAR(45);
 ALTER TABLE activity_logs ADD COLUMN IF NOT EXISTS created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
 ALTER TABLE announcement_recipients ADD COLUMN IF NOT EXISTS announcement_id INTEGER;
 ALTER TABLE announcement_recipients ADD COLUMN IF NOT EXISTS employee_id INTEGER;
 ALTER TABLE announcement_recipients ADD COLUMN IF NOT EXISTS sms_sent BOOLEAN DEFAULT false;
 ALTER TABLE announcement_recipients ADD COLUMN IF NOT EXISTS sms_sent_at TIMESTAMP;
 ALTER TABLE announcement_recipients ADD COLUMN IF NOT EXISTS notification_sent BOOLEAN DEFAULT false;
 ALTER TABLE announcement_recipients ADD COLUMN IF NOT EXISTS notification_read BOOLEAN DEFAULT false;
 ALTER TABLE announcement_recipients ADD COLUMN IF NOT EXISTS notification_read_at TIMESTAMP;
 ALTER TABLE announcement_recipients ADD COLUMN IF NOT EXISTS created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
 ALTER TABLE announcements ADD COLUMN IF NOT EXISTS title VARCHAR(255);
 ALTER TABLE announcements ADD COLUMN IF NOT EXISTS message TEXT;
 ALTER TABLE announcements ADD COLUMN IF NOT EXISTS priority VARCHAR(20) DEFAULT 'normal'::character varying;
 ALTER TABLE announcements ADD COLUMN IF NOT EXISTS target_audience VARCHAR(50) DEFAULT 'all'::character varying;
 ALTER TABLE announcements ADD COLUMN IF NOT EXISTS target_branch_id INTEGER;
 ALTER TABLE announcements ADD COLUMN IF NOT EXISTS target_team_id INTEGER;
 ALTER TABLE announcements ADD COLUMN IF NOT EXISTS send_sms BOOLEAN DEFAULT false;
 ALTER TABLE announcements ADD COLUMN IF NOT EXISTS send_notification BOOLEAN DEFAULT true;
 ALTER TABLE announcements ADD COLUMN IF NOT EXISTS scheduled_at TIMESTAMP;
 ALTER TABLE announcements ADD COLUMN IF NOT EXISTS sent_at TIMESTAMP;
 ALTER TABLE announcements ADD COLUMN IF NOT EXISTS status VARCHAR(20) DEFAULT 'draft'::character varying;
 ALTER TABLE announcements ADD COLUMN IF NOT EXISTS created_by INTEGER;
 ALTER TABLE announcements ADD COLUMN IF NOT EXISTS created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
 ALTER TABLE announcements ADD COLUMN IF NOT EXISTS updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
 ALTER TABLE attendance ADD COLUMN IF NOT EXISTS employee_id INTEGER;
 ALTER TABLE attendance ADD COLUMN IF NOT EXISTS date DATE;
 ALTER TABLE attendance ADD COLUMN IF NOT EXISTS clock_in TIME WITHOUT TIME ZONE;
 ALTER TABLE attendance ADD COLUMN IF NOT EXISTS clock_out TIME WITHOUT TIME ZONE;
 ALTER TABLE attendance ADD COLUMN IF NOT EXISTS status VARCHAR(20) DEFAULT 'present'::character varying;
 ALTER TABLE attendance ADD COLUMN IF NOT EXISTS hours_worked NUMERIC;
 ALTER TABLE attendance ADD COLUMN IF NOT EXISTS overtime_hours NUMERIC DEFAULT 0;
 ALTER TABLE attendance ADD COLUMN IF NOT EXISTS notes TEXT;
 ALTER TABLE attendance ADD COLUMN IF NOT EXISTS created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
 ALTER TABLE attendance ADD COLUMN IF NOT EXISTS updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
 ALTER TABLE attendance ADD COLUMN IF NOT EXISTS late_minutes INTEGER DEFAULT 0;
 ALTER TABLE attendance ADD COLUMN IF NOT EXISTS source VARCHAR(50) DEFAULT 'manual'::character varying;
 ALTER TABLE attendance ADD COLUMN IF NOT EXISTS clock_in_latitude NUMERIC;
 ALTER TABLE attendance ADD COLUMN IF NOT EXISTS clock_in_longitude NUMERIC;
 ALTER TABLE attendance ADD COLUMN IF NOT EXISTS clock_out_latitude NUMERIC;
 ALTER TABLE attendance ADD COLUMN IF NOT EXISTS clock_out_longitude NUMERIC;
 ALTER TABLE attendance ADD COLUMN IF NOT EXISTS clock_in_address TEXT;
 ALTER TABLE attendance ADD COLUMN IF NOT EXISTS clock_out_address TEXT;
 ALTER TABLE attendance ADD COLUMN IF NOT EXISTS deduction NUMERIC DEFAULT 0;
 ALTER TABLE attendance_notification_logs ADD COLUMN IF NOT EXISTS employee_id INTEGER;
 ALTER TABLE attendance_notification_logs ADD COLUMN IF NOT EXISTS notification_template_id INTEGER;
 ALTER TABLE attendance_notification_logs ADD COLUMN IF NOT EXISTS attendance_date DATE;
 ALTER TABLE attendance_notification_logs ADD COLUMN IF NOT EXISTS clock_in_time TIME WITHOUT TIME ZONE;
 ALTER TABLE attendance_notification_logs ADD COLUMN IF NOT EXISTS late_minutes INTEGER DEFAULT 0;
 ALTER TABLE attendance_notification_logs ADD COLUMN IF NOT EXISTS deduction_amount NUMERIC DEFAULT 0;
 ALTER TABLE attendance_notification_logs ADD COLUMN IF NOT EXISTS notification_type VARCHAR(20) DEFAULT 'sms'::character varying;
 ALTER TABLE attendance_notification_logs ADD COLUMN IF NOT EXISTS phone VARCHAR(50);
 ALTER TABLE attendance_notification_logs ADD COLUMN IF NOT EXISTS message TEXT;
 ALTER TABLE attendance_notification_logs ADD COLUMN IF NOT EXISTS status VARCHAR(20) DEFAULT 'pending'::character varying;
 ALTER TABLE attendance_notification_logs ADD COLUMN IF NOT EXISTS response_data JSONB;
 ALTER TABLE attendance_notification_logs ADD COLUMN IF NOT EXISTS sent_at TIMESTAMP;
 ALTER TABLE attendance_notification_logs ADD COLUMN IF NOT EXISTS created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
 ALTER TABLE bill_reminders ADD COLUMN IF NOT EXISTS bill_id INTEGER;
 ALTER TABLE bill_reminders ADD COLUMN IF NOT EXISTS reminder_date DATE;
 ALTER TABLE bill_reminders ADD COLUMN IF NOT EXISTS sent_at TIMESTAMP;
 ALTER TABLE bill_reminders ADD COLUMN IF NOT EXISTS sent_to INTEGER;
 ALTER TABLE bill_reminders ADD COLUMN IF NOT EXISTS notification_type VARCHAR(20) DEFAULT 'both'::character varying;
 ALTER TABLE bill_reminders ADD COLUMN IF NOT EXISTS is_sent BOOLEAN DEFAULT false;
 ALTER TABLE bill_reminders ADD COLUMN IF NOT EXISTS created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
 ALTER TABLE biometric_attendance_logs ADD COLUMN IF NOT EXISTS device_id INTEGER;
 ALTER TABLE biometric_attendance_logs ADD COLUMN IF NOT EXISTS employee_id INTEGER;
 ALTER TABLE biometric_attendance_logs ADD COLUMN IF NOT EXISTS device_user_id VARCHAR(50);
 ALTER TABLE biometric_attendance_logs ADD COLUMN IF NOT EXISTS log_time TIMESTAMP;
 ALTER TABLE biometric_attendance_logs ADD COLUMN IF NOT EXISTS log_type VARCHAR(20) DEFAULT 'check'::character varying;
 ALTER TABLE biometric_attendance_logs ADD COLUMN IF NOT EXISTS verify_mode VARCHAR(20);
 ALTER TABLE biometric_attendance_logs ADD COLUMN IF NOT EXISTS raw_data JSONB;
 ALTER TABLE biometric_attendance_logs ADD COLUMN IF NOT EXISTS processed BOOLEAN DEFAULT false;
 ALTER TABLE biometric_attendance_logs ADD COLUMN IF NOT EXISTS attendance_id INTEGER;
 ALTER TABLE biometric_attendance_logs ADD COLUMN IF NOT EXISTS created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
 ALTER TABLE biometric_devices ADD COLUMN IF NOT EXISTS name VARCHAR(100);
 ALTER TABLE biometric_devices ADD COLUMN IF NOT EXISTS device_type VARCHAR(20);
 ALTER TABLE biometric_devices ADD COLUMN IF NOT EXISTS ip_address VARCHAR(45);
 ALTER TABLE biometric_devices ADD COLUMN IF NOT EXISTS port INTEGER DEFAULT 4370;
 ALTER TABLE biometric_devices ADD COLUMN IF NOT EXISTS username VARCHAR(100);
 ALTER TABLE biometric_devices ADD COLUMN IF NOT EXISTS password_encrypted TEXT;
 ALTER TABLE biometric_devices ADD COLUMN IF NOT EXISTS sync_interval_minutes INTEGER DEFAULT 15;
 ALTER TABLE biometric_devices ADD COLUMN IF NOT EXISTS is_active BOOLEAN DEFAULT true;
 ALTER TABLE biometric_devices ADD COLUMN IF NOT EXISTS last_sync_at TIMESTAMP;
 ALTER TABLE biometric_devices ADD COLUMN IF NOT EXISTS last_sync_status VARCHAR(50);
 ALTER TABLE biometric_devices ADD COLUMN IF NOT EXISTS last_sync_message TEXT;
 ALTER TABLE biometric_devices ADD COLUMN IF NOT EXISTS created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
 ALTER TABLE biometric_devices ADD COLUMN IF NOT EXISTS updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
 ALTER TABLE biometric_devices ADD COLUMN IF NOT EXISTS serial_number VARCHAR(100);
 ALTER TABLE biometric_devices ADD COLUMN IF NOT EXISTS api_base_url VARCHAR(255);
 ALTER TABLE biometric_devices ADD COLUMN IF NOT EXISTS last_transaction_id INTEGER;
 ALTER TABLE biometric_devices ADD COLUMN IF NOT EXISTS company_name VARCHAR(100);
 ALTER TABLE branch_employees ADD COLUMN IF NOT EXISTS branch_id INTEGER;
 ALTER TABLE branch_employees ADD COLUMN IF NOT EXISTS employee_id INTEGER;
 ALTER TABLE branch_employees ADD COLUMN IF NOT EXISTS is_primary BOOLEAN DEFAULT false;
 ALTER TABLE branch_employees ADD COLUMN IF NOT EXISTS assigned_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
 ALTER TABLE branches ADD COLUMN IF NOT EXISTS name VARCHAR(255);
 ALTER TABLE branches ADD COLUMN IF NOT EXISTS code VARCHAR(50);
 ALTER TABLE branches ADD COLUMN IF NOT EXISTS address TEXT;
 ALTER TABLE branches ADD COLUMN IF NOT EXISTS phone VARCHAR(50);
 ALTER TABLE branches ADD COLUMN IF NOT EXISTS email VARCHAR(255);
 ALTER TABLE branches ADD COLUMN IF NOT EXISTS whatsapp_group VARCHAR(255);
 ALTER TABLE branches ADD COLUMN IF NOT EXISTS manager_id INTEGER;
 ALTER TABLE branches ADD COLUMN IF NOT EXISTS is_active BOOLEAN DEFAULT true;
 ALTER TABLE branches ADD COLUMN IF NOT EXISTS created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
 ALTER TABLE branches ADD COLUMN IF NOT EXISTS updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
 ALTER TABLE chart_of_accounts ADD COLUMN IF NOT EXISTS code VARCHAR(20);
 ALTER TABLE chart_of_accounts ADD COLUMN IF NOT EXISTS name VARCHAR(100);
 ALTER TABLE chart_of_accounts ADD COLUMN IF NOT EXISTS type VARCHAR(50);
 ALTER TABLE chart_of_accounts ADD COLUMN IF NOT EXISTS category VARCHAR(50);
 ALTER TABLE chart_of_accounts ADD COLUMN IF NOT EXISTS description TEXT;
 ALTER TABLE chart_of_accounts ADD COLUMN IF NOT EXISTS parent_id INTEGER;
 ALTER TABLE chart_of_accounts ADD COLUMN IF NOT EXISTS is_system BOOLEAN DEFAULT false;
 ALTER TABLE chart_of_accounts ADD COLUMN IF NOT EXISTS is_active BOOLEAN DEFAULT true;
 ALTER TABLE chart_of_accounts ADD COLUMN IF NOT EXISTS balance NUMERIC DEFAULT 0;
 ALTER TABLE chart_of_accounts ADD COLUMN IF NOT EXISTS created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
 ALTER TABLE company_settings ADD COLUMN IF NOT EXISTS setting_key VARCHAR(100);
 ALTER TABLE company_settings ADD COLUMN IF NOT EXISTS setting_value TEXT;
 ALTER TABLE company_settings ADD COLUMN IF NOT EXISTS setting_type VARCHAR(20) DEFAULT 'text'::character varying;
 ALTER TABLE company_settings ADD COLUMN IF NOT EXISTS created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
 ALTER TABLE company_settings ADD COLUMN IF NOT EXISTS updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
 ALTER TABLE complaints ADD COLUMN IF NOT EXISTS complaint_number VARCHAR(30);
 ALTER TABLE complaints ADD COLUMN IF NOT EXISTS customer_id INTEGER;
 ALTER TABLE complaints ADD COLUMN IF NOT EXISTS customer_name VARCHAR(100);
 ALTER TABLE complaints ADD COLUMN IF NOT EXISTS customer_phone VARCHAR(20);
 ALTER TABLE complaints ADD COLUMN IF NOT EXISTS customer_email VARCHAR(100);
 ALTER TABLE complaints ADD COLUMN IF NOT EXISTS customer_location TEXT;
 ALTER TABLE complaints ADD COLUMN IF NOT EXISTS category VARCHAR(50);
 ALTER TABLE complaints ADD COLUMN IF NOT EXISTS subject VARCHAR(200);
 ALTER TABLE complaints ADD COLUMN IF NOT EXISTS description TEXT;
 ALTER TABLE complaints ADD COLUMN IF NOT EXISTS status VARCHAR(20) DEFAULT 'pending'::character varying;
 ALTER TABLE complaints ADD COLUMN IF NOT EXISTS priority VARCHAR(20) DEFAULT 'medium'::character varying;
 ALTER TABLE complaints ADD COLUMN IF NOT EXISTS reviewed_by INTEGER;
 ALTER TABLE complaints ADD COLUMN IF NOT EXISTS reviewed_at TIMESTAMP;
 ALTER TABLE complaints ADD COLUMN IF NOT EXISTS review_notes TEXT;
 ALTER TABLE complaints ADD COLUMN IF NOT EXISTS converted_ticket_id INTEGER;
 ALTER TABLE complaints ADD COLUMN IF NOT EXISTS source VARCHAR(50) DEFAULT 'public'::character varying;
 ALTER TABLE complaints ADD COLUMN IF NOT EXISTS created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
 ALTER TABLE complaints ADD COLUMN IF NOT EXISTS updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
 ALTER TABLE complaints ADD COLUMN IF NOT EXISTS created_by INTEGER;
 ALTER TABLE customer_payments ADD COLUMN IF NOT EXISTS payment_number VARCHAR(50);
 ALTER TABLE customer_payments ADD COLUMN IF NOT EXISTS customer_id INTEGER;
 ALTER TABLE customer_payments ADD COLUMN IF NOT EXISTS invoice_id INTEGER;
 ALTER TABLE customer_payments ADD COLUMN IF NOT EXISTS payment_date DATE DEFAULT CURRENT_DATE;
 ALTER TABLE customer_payments ADD COLUMN IF NOT EXISTS amount NUMERIC;
 ALTER TABLE customer_payments ADD COLUMN IF NOT EXISTS payment_method VARCHAR(50);
 ALTER TABLE customer_payments ADD COLUMN IF NOT EXISTS mpesa_transaction_id INTEGER;
 ALTER TABLE customer_payments ADD COLUMN IF NOT EXISTS mpesa_receipt VARCHAR(50);
 ALTER TABLE customer_payments ADD COLUMN IF NOT EXISTS reference VARCHAR(100);
 ALTER TABLE customer_payments ADD COLUMN IF NOT EXISTS notes TEXT;
 ALTER TABLE customer_payments ADD COLUMN IF NOT EXISTS status VARCHAR(20) DEFAULT 'completed'::character varying;
 ALTER TABLE customer_payments ADD COLUMN IF NOT EXISTS created_by INTEGER;
 ALTER TABLE customer_payments ADD COLUMN IF NOT EXISTS created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
 ALTER TABLE customer_ticket_tokens ADD COLUMN IF NOT EXISTS ticket_id INTEGER;
 ALTER TABLE customer_ticket_tokens ADD COLUMN IF NOT EXISTS customer_id INTEGER;
 ALTER TABLE customer_ticket_tokens ADD COLUMN IF NOT EXISTS token_hash VARCHAR(255);
 ALTER TABLE customer_ticket_tokens ADD COLUMN IF NOT EXISTS token_lookup VARCHAR(32);
 ALTER TABLE customer_ticket_tokens ADD COLUMN IF NOT EXISTS expires_at TIMESTAMP;
 ALTER TABLE customer_ticket_tokens ADD COLUMN IF NOT EXISTS max_uses INTEGER DEFAULT 50;
 ALTER TABLE customer_ticket_tokens ADD COLUMN IF NOT EXISTS used_count INTEGER DEFAULT 0;
 ALTER TABLE customer_ticket_tokens ADD COLUMN IF NOT EXISTS created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
 ALTER TABLE customer_ticket_tokens ADD COLUMN IF NOT EXISTS last_used_at TIMESTAMP;
 ALTER TABLE customer_ticket_tokens ADD COLUMN IF NOT EXISTS is_active BOOLEAN DEFAULT true;
 ALTER TABLE customers ADD COLUMN IF NOT EXISTS account_number VARCHAR(20);
 ALTER TABLE customers ADD COLUMN IF NOT EXISTS name VARCHAR(100);
 ALTER TABLE customers ADD COLUMN IF NOT EXISTS email VARCHAR(100);
 ALTER TABLE customers ADD COLUMN IF NOT EXISTS phone VARCHAR(20);
 ALTER TABLE customers ADD COLUMN IF NOT EXISTS address TEXT;
 ALTER TABLE customers ADD COLUMN IF NOT EXISTS service_plan VARCHAR(50);
 ALTER TABLE customers ADD COLUMN IF NOT EXISTS connection_status VARCHAR(20) DEFAULT 'active'::character varying;
 ALTER TABLE customers ADD COLUMN IF NOT EXISTS installation_date DATE;
 ALTER TABLE customers ADD COLUMN IF NOT EXISTS notes TEXT;
 ALTER TABLE customers ADD COLUMN IF NOT EXISTS created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
 ALTER TABLE customers ADD COLUMN IF NOT EXISTS updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
 ALTER TABLE customers ADD COLUMN IF NOT EXISTS created_by INTEGER;
 ALTER TABLE customers ADD COLUMN IF NOT EXISTS username VARCHAR(100);
 ALTER TABLE customers ADD COLUMN IF NOT EXISTS billing_id VARCHAR(100);
 ALTER TABLE departments ADD COLUMN IF NOT EXISTS name VARCHAR(100);
 ALTER TABLE departments ADD COLUMN IF NOT EXISTS description TEXT;
 ALTER TABLE departments ADD COLUMN IF NOT EXISTS manager_id INTEGER;
 ALTER TABLE departments ADD COLUMN IF NOT EXISTS created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
 ALTER TABLE departments ADD COLUMN IF NOT EXISTS updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
 ALTER TABLE device_interfaces ADD COLUMN IF NOT EXISTS device_id INTEGER;
 ALTER TABLE device_interfaces ADD COLUMN IF NOT EXISTS if_index INTEGER;
 ALTER TABLE device_interfaces ADD COLUMN IF NOT EXISTS if_name VARCHAR(100);
 ALTER TABLE device_interfaces ADD COLUMN IF NOT EXISTS if_descr VARCHAR(255);
 ALTER TABLE device_interfaces ADD COLUMN IF NOT EXISTS if_type VARCHAR(50);
 ALTER TABLE device_interfaces ADD COLUMN IF NOT EXISTS if_speed BIGINT;
 ALTER TABLE device_interfaces ADD COLUMN IF NOT EXISTS if_status VARCHAR(20);
 ALTER TABLE device_interfaces ADD COLUMN IF NOT EXISTS in_octets BIGINT DEFAULT 0;
 ALTER TABLE device_interfaces ADD COLUMN IF NOT EXISTS out_octets BIGINT DEFAULT 0;
 ALTER TABLE device_interfaces ADD COLUMN IF NOT EXISTS in_errors BIGINT DEFAULT 0;
 ALTER TABLE device_interfaces ADD COLUMN IF NOT EXISTS out_errors BIGINT DEFAULT 0;
 ALTER TABLE device_interfaces ADD COLUMN IF NOT EXISTS last_updated TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
 ALTER TABLE device_monitoring_log ADD COLUMN IF NOT EXISTS device_id INTEGER;
 ALTER TABLE device_monitoring_log ADD COLUMN IF NOT EXISTS metric_type VARCHAR(50);
 ALTER TABLE device_monitoring_log ADD COLUMN IF NOT EXISTS metric_name VARCHAR(100);
 ALTER TABLE device_monitoring_log ADD COLUMN IF NOT EXISTS metric_value TEXT;
 ALTER TABLE device_monitoring_log ADD COLUMN IF NOT EXISTS recorded_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
 ALTER TABLE device_onus ADD COLUMN IF NOT EXISTS device_id INTEGER;
 ALTER TABLE device_onus ADD COLUMN IF NOT EXISTS onu_id VARCHAR(50);
 ALTER TABLE device_onus ADD COLUMN IF NOT EXISTS serial_number VARCHAR(50);
 ALTER TABLE device_onus ADD COLUMN IF NOT EXISTS mac_address VARCHAR(17);
 ALTER TABLE device_onus ADD COLUMN IF NOT EXISTS pon_port VARCHAR(20);
 ALTER TABLE device_onus ADD COLUMN IF NOT EXISTS slot INTEGER;
 ALTER TABLE device_onus ADD COLUMN IF NOT EXISTS port INTEGER;
 ALTER TABLE device_onus ADD COLUMN IF NOT EXISTS onu_index INTEGER;
 ALTER TABLE device_onus ADD COLUMN IF NOT EXISTS customer_id INTEGER;
 ALTER TABLE device_onus ADD COLUMN IF NOT EXISTS status VARCHAR(20) DEFAULT 'unknown'::character varying;
 ALTER TABLE device_onus ADD COLUMN IF NOT EXISTS rx_power NUMERIC;
 ALTER TABLE device_onus ADD COLUMN IF NOT EXISTS tx_power NUMERIC;
 ALTER TABLE device_onus ADD COLUMN IF NOT EXISTS distance INTEGER;
 ALTER TABLE device_onus ADD COLUMN IF NOT EXISTS description VARCHAR(255);
 ALTER TABLE device_onus ADD COLUMN IF NOT EXISTS profile VARCHAR(100);
 ALTER TABLE device_onus ADD COLUMN IF NOT EXISTS last_online TIMESTAMP;
 ALTER TABLE device_onus ADD COLUMN IF NOT EXISTS last_offline TIMESTAMP;
 ALTER TABLE device_onus ADD COLUMN IF NOT EXISTS last_polled TIMESTAMP;
 ALTER TABLE device_onus ADD COLUMN IF NOT EXISTS created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
 ALTER TABLE device_onus ADD COLUMN IF NOT EXISTS updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
 ALTER TABLE device_user_mapping ADD COLUMN IF NOT EXISTS device_id INTEGER;
 ALTER TABLE device_user_mapping ADD COLUMN IF NOT EXISTS device_user_id VARCHAR(50);
 ALTER TABLE device_user_mapping ADD COLUMN IF NOT EXISTS employee_id INTEGER;
 ALTER TABLE device_user_mapping ADD COLUMN IF NOT EXISTS created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
 ALTER TABLE device_vlans ADD COLUMN IF NOT EXISTS device_id INTEGER;
 ALTER TABLE device_vlans ADD COLUMN IF NOT EXISTS vlan_id INTEGER;
 ALTER TABLE device_vlans ADD COLUMN IF NOT EXISTS vlan_name VARCHAR(100);
 ALTER TABLE device_vlans ADD COLUMN IF NOT EXISTS vlan_status VARCHAR(20) DEFAULT 'active'::character varying;
 ALTER TABLE device_vlans ADD COLUMN IF NOT EXISTS ports TEXT;
 ALTER TABLE device_vlans ADD COLUMN IF NOT EXISTS tagged_ports TEXT;
 ALTER TABLE device_vlans ADD COLUMN IF NOT EXISTS untagged_ports TEXT;
 ALTER TABLE device_vlans ADD COLUMN IF NOT EXISTS in_octets BIGINT DEFAULT 0;
 ALTER TABLE device_vlans ADD COLUMN IF NOT EXISTS out_octets BIGINT DEFAULT 0;
 ALTER TABLE device_vlans ADD COLUMN IF NOT EXISTS in_rate BIGINT DEFAULT 0;
 ALTER TABLE device_vlans ADD COLUMN IF NOT EXISTS out_rate BIGINT DEFAULT 0;
 ALTER TABLE device_vlans ADD COLUMN IF NOT EXISTS last_updated TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
 ALTER TABLE employee_branches ADD COLUMN IF NOT EXISTS employee_id INTEGER;
 ALTER TABLE employee_branches ADD COLUMN IF NOT EXISTS branch_id INTEGER;
 ALTER TABLE employee_branches ADD COLUMN IF NOT EXISTS is_primary BOOLEAN DEFAULT false;
 ALTER TABLE employee_branches ADD COLUMN IF NOT EXISTS assigned_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
 ALTER TABLE employee_branches ADD COLUMN IF NOT EXISTS assigned_by INTEGER;
 ALTER TABLE employees ADD COLUMN IF NOT EXISTS employee_id VARCHAR(20);
 ALTER TABLE employees ADD COLUMN IF NOT EXISTS user_id INTEGER;
 ALTER TABLE employees ADD COLUMN IF NOT EXISTS name VARCHAR(100);
 ALTER TABLE employees ADD COLUMN IF NOT EXISTS email VARCHAR(100);
 ALTER TABLE employees ADD COLUMN IF NOT EXISTS phone VARCHAR(20);
 ALTER TABLE employees ADD COLUMN IF NOT EXISTS department_id INTEGER;
 ALTER TABLE employees ADD COLUMN IF NOT EXISTS position VARCHAR(100);
 ALTER TABLE employees ADD COLUMN IF NOT EXISTS salary NUMERIC;
 ALTER TABLE employees ADD COLUMN IF NOT EXISTS hire_date DATE;
 ALTER TABLE employees ADD COLUMN IF NOT EXISTS employment_status VARCHAR(20) DEFAULT 'active'::character varying;
 ALTER TABLE employees ADD COLUMN IF NOT EXISTS emergency_contact VARCHAR(100);
 ALTER TABLE employees ADD COLUMN IF NOT EXISTS emergency_phone VARCHAR(20);
 ALTER TABLE employees ADD COLUMN IF NOT EXISTS address TEXT;
 ALTER TABLE employees ADD COLUMN IF NOT EXISTS notes TEXT;
 ALTER TABLE employees ADD COLUMN IF NOT EXISTS created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
 ALTER TABLE employees ADD COLUMN IF NOT EXISTS updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
 ALTER TABLE equipment ADD COLUMN IF NOT EXISTS category_id INTEGER;
 ALTER TABLE equipment ADD COLUMN IF NOT EXISTS name VARCHAR(200);
 ALTER TABLE equipment ADD COLUMN IF NOT EXISTS brand VARCHAR(100);
 ALTER TABLE equipment ADD COLUMN IF NOT EXISTS model VARCHAR(100);
 ALTER TABLE equipment ADD COLUMN IF NOT EXISTS serial_number VARCHAR(100);
 ALTER TABLE equipment ADD COLUMN IF NOT EXISTS mac_address VARCHAR(50);
 ALTER TABLE equipment ADD COLUMN IF NOT EXISTS purchase_date DATE;
 ALTER TABLE equipment ADD COLUMN IF NOT EXISTS purchase_price NUMERIC;
 ALTER TABLE equipment ADD COLUMN IF NOT EXISTS warranty_expiry DATE;
 ALTER TABLE equipment ADD COLUMN IF NOT EXISTS condition VARCHAR(50) DEFAULT 'new'::character varying;
 ALTER TABLE equipment ADD COLUMN IF NOT EXISTS status VARCHAR(50) DEFAULT 'available'::character varying;
 ALTER TABLE equipment ADD COLUMN IF NOT EXISTS location VARCHAR(200);
 ALTER TABLE equipment ADD COLUMN IF NOT EXISTS notes TEXT;
 ALTER TABLE equipment ADD COLUMN IF NOT EXISTS created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
 ALTER TABLE equipment ADD COLUMN IF NOT EXISTS updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
 ALTER TABLE equipment ADD COLUMN IF NOT EXISTS warehouse_id INTEGER;
 ALTER TABLE equipment ADD COLUMN IF NOT EXISTS location_id INTEGER;
 ALTER TABLE equipment ADD COLUMN IF NOT EXISTS quantity INTEGER DEFAULT 1;
 ALTER TABLE equipment ADD COLUMN IF NOT EXISTS sku VARCHAR(50);
 ALTER TABLE equipment ADD COLUMN IF NOT EXISTS barcode VARCHAR(100);
 ALTER TABLE equipment ADD COLUMN IF NOT EXISTS lifecycle_status VARCHAR(30) DEFAULT 'in_stock'::character varying;
 ALTER TABLE equipment ADD COLUMN IF NOT EXISTS last_lifecycle_change TIMESTAMP;
 ALTER TABLE equipment ADD COLUMN IF NOT EXISTS installed_customer_id INTEGER;
 ALTER TABLE equipment ADD COLUMN IF NOT EXISTS installed_at TIMESTAMP;
 ALTER TABLE equipment ADD COLUMN IF NOT EXISTS installed_by INTEGER;
 ALTER TABLE equipment ADD COLUMN IF NOT EXISTS min_stock_level INTEGER DEFAULT 0;
 ALTER TABLE equipment ADD COLUMN IF NOT EXISTS max_stock_level INTEGER DEFAULT 0;
 ALTER TABLE equipment ADD COLUMN IF NOT EXISTS reorder_point INTEGER DEFAULT 0;
 ALTER TABLE equipment ADD COLUMN IF NOT EXISTS unit_cost NUMERIC DEFAULT 0;
 ALTER TABLE equipment_assignments ADD COLUMN IF NOT EXISTS equipment_id INTEGER;
 ALTER TABLE equipment_assignments ADD COLUMN IF NOT EXISTS employee_id INTEGER;
 ALTER TABLE equipment_assignments ADD COLUMN IF NOT EXISTS assigned_date DATE DEFAULT CURRENT_DATE;
 ALTER TABLE equipment_assignments ADD COLUMN IF NOT EXISTS return_date DATE;
 ALTER TABLE equipment_assignments ADD COLUMN IF NOT EXISTS assigned_by INTEGER;
 ALTER TABLE equipment_assignments ADD COLUMN IF NOT EXISTS notes TEXT;
 ALTER TABLE equipment_assignments ADD COLUMN IF NOT EXISTS status VARCHAR(50) DEFAULT 'assigned'::character varying;
 ALTER TABLE equipment_assignments ADD COLUMN IF NOT EXISTS created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
 ALTER TABLE equipment_assignments ADD COLUMN IF NOT EXISTS customer_id INTEGER;
 ALTER TABLE equipment_categories ADD COLUMN IF NOT EXISTS name VARCHAR(100);
 ALTER TABLE equipment_categories ADD COLUMN IF NOT EXISTS description TEXT;
 ALTER TABLE equipment_categories ADD COLUMN IF NOT EXISTS created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
 ALTER TABLE equipment_categories ADD COLUMN IF NOT EXISTS parent_id INTEGER;
 ALTER TABLE equipment_categories ADD COLUMN IF NOT EXISTS item_type VARCHAR(30) DEFAULT 'serialized'::character varying;
 ALTER TABLE equipment_faults ADD COLUMN IF NOT EXISTS equipment_id INTEGER;
 ALTER TABLE equipment_faults ADD COLUMN IF NOT EXISTS reported_date DATE DEFAULT CURRENT_DATE;
 ALTER TABLE equipment_faults ADD COLUMN IF NOT EXISTS reported_by INTEGER;
 ALTER TABLE equipment_faults ADD COLUMN IF NOT EXISTS fault_description TEXT;
 ALTER TABLE equipment_faults ADD COLUMN IF NOT EXISTS severity VARCHAR(50) DEFAULT 'minor'::character varying;
 ALTER TABLE equipment_faults ADD COLUMN IF NOT EXISTS repair_status VARCHAR(50) DEFAULT 'pending'::character varying;
 ALTER TABLE equipment_faults ADD COLUMN IF NOT EXISTS repair_date DATE;
 ALTER TABLE equipment_faults ADD COLUMN IF NOT EXISTS repair_cost NUMERIC;
 ALTER TABLE equipment_faults ADD COLUMN IF NOT EXISTS repair_notes TEXT;
 ALTER TABLE equipment_faults ADD COLUMN IF NOT EXISTS created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
 ALTER TABLE equipment_faults ADD COLUMN IF NOT EXISTS updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
 ALTER TABLE equipment_lifecycle_logs ADD COLUMN IF NOT EXISTS equipment_id INTEGER;
 ALTER TABLE equipment_lifecycle_logs ADD COLUMN IF NOT EXISTS from_status VARCHAR(30);
 ALTER TABLE equipment_lifecycle_logs ADD COLUMN IF NOT EXISTS to_status VARCHAR(30);
 ALTER TABLE equipment_lifecycle_logs ADD COLUMN IF NOT EXISTS changed_by INTEGER;
 ALTER TABLE equipment_lifecycle_logs ADD COLUMN IF NOT EXISTS reference_type VARCHAR(30);
 ALTER TABLE equipment_lifecycle_logs ADD COLUMN IF NOT EXISTS reference_id INTEGER;
 ALTER TABLE equipment_lifecycle_logs ADD COLUMN IF NOT EXISTS notes TEXT;
 ALTER TABLE equipment_lifecycle_logs ADD COLUMN IF NOT EXISTS created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
 ALTER TABLE equipment_loans ADD COLUMN IF NOT EXISTS equipment_id INTEGER;
 ALTER TABLE equipment_loans ADD COLUMN IF NOT EXISTS customer_id INTEGER;
 ALTER TABLE equipment_loans ADD COLUMN IF NOT EXISTS loan_date DATE DEFAULT CURRENT_DATE;
 ALTER TABLE equipment_loans ADD COLUMN IF NOT EXISTS expected_return_date DATE;
 ALTER TABLE equipment_loans ADD COLUMN IF NOT EXISTS actual_return_date DATE;
 ALTER TABLE equipment_loans ADD COLUMN IF NOT EXISTS loaned_by INTEGER;
 ALTER TABLE equipment_loans ADD COLUMN IF NOT EXISTS deposit_amount NUMERIC DEFAULT 0;
 ALTER TABLE equipment_loans ADD COLUMN IF NOT EXISTS deposit_paid BOOLEAN DEFAULT false;
 ALTER TABLE equipment_loans ADD COLUMN IF NOT EXISTS notes TEXT;
 ALTER TABLE equipment_loans ADD COLUMN IF NOT EXISTS status VARCHAR(50) DEFAULT 'on_loan'::character varying;
 ALTER TABLE equipment_loans ADD COLUMN IF NOT EXISTS created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
 ALTER TABLE expense_categories ADD COLUMN IF NOT EXISTS name VARCHAR(100);
 ALTER TABLE expense_categories ADD COLUMN IF NOT EXISTS description TEXT;
 ALTER TABLE expense_categories ADD COLUMN IF NOT EXISTS account_id INTEGER;
 ALTER TABLE expense_categories ADD COLUMN IF NOT EXISTS is_active BOOLEAN DEFAULT true;
 ALTER TABLE expense_categories ADD COLUMN IF NOT EXISTS created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
 ALTER TABLE expenses ADD COLUMN IF NOT EXISTS expense_number VARCHAR(50);
 ALTER TABLE expenses ADD COLUMN IF NOT EXISTS category_id INTEGER;
 ALTER TABLE expenses ADD COLUMN IF NOT EXISTS vendor_id INTEGER;
 ALTER TABLE expenses ADD COLUMN IF NOT EXISTS expense_date DATE DEFAULT CURRENT_DATE;
 ALTER TABLE expenses ADD COLUMN IF NOT EXISTS amount NUMERIC;
 ALTER TABLE expenses ADD COLUMN IF NOT EXISTS tax_amount NUMERIC DEFAULT 0;
 ALTER TABLE expenses ADD COLUMN IF NOT EXISTS total_amount NUMERIC;
 ALTER TABLE expenses ADD COLUMN IF NOT EXISTS payment_method VARCHAR(50);
 ALTER TABLE expenses ADD COLUMN IF NOT EXISTS reference VARCHAR(100);
 ALTER TABLE expenses ADD COLUMN IF NOT EXISTS description TEXT;
 ALTER TABLE expenses ADD COLUMN IF NOT EXISTS receipt_url TEXT;
 ALTER TABLE expenses ADD COLUMN IF NOT EXISTS status VARCHAR(20) DEFAULT 'pending'::character varying;
 ALTER TABLE expenses ADD COLUMN IF NOT EXISTS approved_by INTEGER;
 ALTER TABLE expenses ADD COLUMN IF NOT EXISTS approved_at TIMESTAMP;
 ALTER TABLE expenses ADD COLUMN IF NOT EXISTS employee_id INTEGER;
 ALTER TABLE expenses ADD COLUMN IF NOT EXISTS created_by INTEGER;
 ALTER TABLE expenses ADD COLUMN IF NOT EXISTS created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
 ALTER TABLE hr_notification_templates ADD COLUMN IF NOT EXISTS name VARCHAR(100);
 ALTER TABLE hr_notification_templates ADD COLUMN IF NOT EXISTS category VARCHAR(50) DEFAULT 'attendance'::character varying;
 ALTER TABLE hr_notification_templates ADD COLUMN IF NOT EXISTS event_type VARCHAR(50);
 ALTER TABLE hr_notification_templates ADD COLUMN IF NOT EXISTS subject VARCHAR(255);
 ALTER TABLE hr_notification_templates ADD COLUMN IF NOT EXISTS sms_template TEXT;
 ALTER TABLE hr_notification_templates ADD COLUMN IF NOT EXISTS email_template TEXT;
 ALTER TABLE hr_notification_templates ADD COLUMN IF NOT EXISTS is_active BOOLEAN DEFAULT true;
 ALTER TABLE hr_notification_templates ADD COLUMN IF NOT EXISTS send_sms BOOLEAN DEFAULT true;
 ALTER TABLE hr_notification_templates ADD COLUMN IF NOT EXISTS send_email BOOLEAN DEFAULT false;
 ALTER TABLE hr_notification_templates ADD COLUMN IF NOT EXISTS created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
 ALTER TABLE hr_notification_templates ADD COLUMN IF NOT EXISTS updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
 ALTER TABLE huawei_alerts ADD COLUMN IF NOT EXISTS olt_id INTEGER;
 ALTER TABLE huawei_alerts ADD COLUMN IF NOT EXISTS onu_id INTEGER;
 ALTER TABLE huawei_alerts ADD COLUMN IF NOT EXISTS alert_type VARCHAR(50);
 ALTER TABLE huawei_alerts ADD COLUMN IF NOT EXISTS severity VARCHAR(20) DEFAULT 'info'::character varying;
 ALTER TABLE huawei_alerts ADD COLUMN IF NOT EXISTS title VARCHAR(255);
 ALTER TABLE huawei_alerts ADD COLUMN IF NOT EXISTS message TEXT;
 ALTER TABLE huawei_alerts ADD COLUMN IF NOT EXISTS is_read BOOLEAN DEFAULT false;
 ALTER TABLE huawei_alerts ADD COLUMN IF NOT EXISTS is_resolved BOOLEAN DEFAULT false;
 ALTER TABLE huawei_alerts ADD COLUMN IF NOT EXISTS resolved_at TIMESTAMP;
 ALTER TABLE huawei_alerts ADD COLUMN IF NOT EXISTS resolved_by INTEGER;
 ALTER TABLE huawei_alerts ADD COLUMN IF NOT EXISTS created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
 ALTER TABLE huawei_apartments ADD COLUMN IF NOT EXISTS zone_id INTEGER;
 ALTER TABLE huawei_apartments ADD COLUMN IF NOT EXISTS subzone_id INTEGER;
 ALTER TABLE huawei_apartments ADD COLUMN IF NOT EXISTS name VARCHAR(100);
 ALTER TABLE huawei_apartments ADD COLUMN IF NOT EXISTS address TEXT;
 ALTER TABLE huawei_apartments ADD COLUMN IF NOT EXISTS floors INTEGER;
 ALTER TABLE huawei_apartments ADD COLUMN IF NOT EXISTS units_count INTEGER;
 ALTER TABLE huawei_apartments ADD COLUMN IF NOT EXISTS is_active BOOLEAN DEFAULT true;
 ALTER TABLE huawei_apartments ADD COLUMN IF NOT EXISTS created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
 ALTER TABLE huawei_apartments ADD COLUMN IF NOT EXISTS updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
 ALTER TABLE huawei_boards ADD COLUMN IF NOT EXISTS olt_id INTEGER;
 ALTER TABLE huawei_boards ADD COLUMN IF NOT EXISTS slot INTEGER;
 ALTER TABLE huawei_boards ADD COLUMN IF NOT EXISTS board_name VARCHAR(100);
 ALTER TABLE huawei_boards ADD COLUMN IF NOT EXISTS board_type VARCHAR(50);
 ALTER TABLE huawei_boards ADD COLUMN IF NOT EXISTS status VARCHAR(30);
 ALTER TABLE huawei_boards ADD COLUMN IF NOT EXISTS hardware_version VARCHAR(100);
 ALTER TABLE huawei_boards ADD COLUMN IF NOT EXISTS software_version VARCHAR(100);
 ALTER TABLE huawei_boards ADD COLUMN IF NOT EXISTS onu_count INTEGER DEFAULT 0;
 ALTER TABLE huawei_boards ADD COLUMN IF NOT EXISTS synced_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
 ALTER TABLE huawei_boards ADD COLUMN IF NOT EXISTS created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
 ALTER TABLE huawei_odb_units ADD COLUMN IF NOT EXISTS zone_id INTEGER;
 ALTER TABLE huawei_odb_units ADD COLUMN IF NOT EXISTS subzone_id INTEGER;
 ALTER TABLE huawei_odb_units ADD COLUMN IF NOT EXISTS apartment_id INTEGER;
 ALTER TABLE huawei_odb_units ADD COLUMN IF NOT EXISTS code VARCHAR(50);
 ALTER TABLE huawei_odb_units ADD COLUMN IF NOT EXISTS capacity INTEGER DEFAULT 8;
 ALTER TABLE huawei_odb_units ADD COLUMN IF NOT EXISTS ports_used INTEGER DEFAULT 0;
 ALTER TABLE huawei_odb_units ADD COLUMN IF NOT EXISTS location_description TEXT;
 ALTER TABLE huawei_odb_units ADD COLUMN IF NOT EXISTS latitude NUMERIC;
 ALTER TABLE huawei_odb_units ADD COLUMN IF NOT EXISTS longitude NUMERIC;
 ALTER TABLE huawei_odb_units ADD COLUMN IF NOT EXISTS is_active BOOLEAN DEFAULT true;
 ALTER TABLE huawei_odb_units ADD COLUMN IF NOT EXISTS created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
 ALTER TABLE huawei_odb_units ADD COLUMN IF NOT EXISTS updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
 ALTER TABLE huawei_olt_boards ADD COLUMN IF NOT EXISTS olt_id INTEGER;
 ALTER TABLE huawei_olt_boards ADD COLUMN IF NOT EXISTS slot INTEGER;
 ALTER TABLE huawei_olt_boards ADD COLUMN IF NOT EXISTS board_name VARCHAR(50);
 ALTER TABLE huawei_olt_boards ADD COLUMN IF NOT EXISTS status VARCHAR(50);
 ALTER TABLE huawei_olt_boards ADD COLUMN IF NOT EXISTS subtype VARCHAR(50);
 ALTER TABLE huawei_olt_boards ADD COLUMN IF NOT EXISTS online_status VARCHAR(20);
 ALTER TABLE huawei_olt_boards ADD COLUMN IF NOT EXISTS port_count INTEGER DEFAULT 0;
 ALTER TABLE huawei_olt_boards ADD COLUMN IF NOT EXISTS created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
 ALTER TABLE huawei_olt_boards ADD COLUMN IF NOT EXISTS updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
 ALTER TABLE huawei_olt_boards ADD COLUMN IF NOT EXISTS hardware_version VARCHAR(50);
 ALTER TABLE huawei_olt_boards ADD COLUMN IF NOT EXISTS software_version VARCHAR(50);
 ALTER TABLE huawei_olt_boards ADD COLUMN IF NOT EXISTS serial_number VARCHAR(100);
 ALTER TABLE huawei_olt_boards ADD COLUMN IF NOT EXISTS board_type VARCHAR(20) DEFAULT 'unknown'::character varying;
 ALTER TABLE huawei_olt_boards ADD COLUMN IF NOT EXISTS is_enabled BOOLEAN DEFAULT true;
 ALTER TABLE huawei_olt_boards ADD COLUMN IF NOT EXISTS temperature INTEGER;
 ALTER TABLE huawei_olt_line_profiles ADD COLUMN IF NOT EXISTS olt_id INTEGER;
 ALTER TABLE huawei_olt_line_profiles ADD COLUMN IF NOT EXISTS profile_id INTEGER;
 ALTER TABLE huawei_olt_line_profiles ADD COLUMN IF NOT EXISTS profile_name VARCHAR(64);
 ALTER TABLE huawei_olt_line_profiles ADD COLUMN IF NOT EXISTS tcont_count INTEGER DEFAULT 0;
 ALTER TABLE huawei_olt_line_profiles ADD COLUMN IF NOT EXISTS gem_count INTEGER DEFAULT 0;
 ALTER TABLE huawei_olt_line_profiles ADD COLUMN IF NOT EXISTS tr069_enabled BOOLEAN DEFAULT false;
 ALTER TABLE huawei_olt_line_profiles ADD COLUMN IF NOT EXISTS raw_config TEXT;
 ALTER TABLE huawei_olt_line_profiles ADD COLUMN IF NOT EXISTS created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
 ALTER TABLE huawei_olt_line_profiles ADD COLUMN IF NOT EXISTS updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
 ALTER TABLE huawei_olt_pon_ports ADD COLUMN IF NOT EXISTS olt_id INTEGER;
 ALTER TABLE huawei_olt_pon_ports ADD COLUMN IF NOT EXISTS port_name VARCHAR(20);
 ALTER TABLE huawei_olt_pon_ports ADD COLUMN IF NOT EXISTS port_type VARCHAR(20) DEFAULT 'GPON'::character varying;
 ALTER TABLE huawei_olt_pon_ports ADD COLUMN IF NOT EXISTS admin_status VARCHAR(20) DEFAULT 'enable'::character varying;
 ALTER TABLE huawei_olt_pon_ports ADD COLUMN IF NOT EXISTS oper_status VARCHAR(20);
 ALTER TABLE huawei_olt_pon_ports ADD COLUMN IF NOT EXISTS onu_count INTEGER DEFAULT 0;
 ALTER TABLE huawei_olt_pon_ports ADD COLUMN IF NOT EXISTS created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
 ALTER TABLE huawei_olt_pon_ports ADD COLUMN IF NOT EXISTS updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
 ALTER TABLE huawei_olt_pon_ports ADD COLUMN IF NOT EXISTS description VARCHAR(255);
 ALTER TABLE huawei_olt_pon_ports ADD COLUMN IF NOT EXISTS service_profile_id INTEGER;
 ALTER TABLE huawei_olt_pon_ports ADD COLUMN IF NOT EXISTS line_profile_id INTEGER;
 ALTER TABLE huawei_olt_pon_ports ADD COLUMN IF NOT EXISTS native_vlan INTEGER;
 ALTER TABLE huawei_olt_pon_ports ADD COLUMN IF NOT EXISTS allowed_vlans TEXT;
 ALTER TABLE huawei_olt_pon_ports ADD COLUMN IF NOT EXISTS max_onus INTEGER DEFAULT 128;
 ALTER TABLE huawei_olt_pon_ports ADD COLUMN IF NOT EXISTS default_vlan INTEGER;
 ALTER TABLE huawei_olt_srv_profiles ADD COLUMN IF NOT EXISTS olt_id INTEGER;
 ALTER TABLE huawei_olt_srv_profiles ADD COLUMN IF NOT EXISTS profile_id INTEGER;
 ALTER TABLE huawei_olt_srv_profiles ADD COLUMN IF NOT EXISTS profile_name VARCHAR(64);
 ALTER TABLE huawei_olt_srv_profiles ADD COLUMN IF NOT EXISTS eth_ports INTEGER DEFAULT 0;
 ALTER TABLE huawei_olt_srv_profiles ADD COLUMN IF NOT EXISTS pots_ports INTEGER DEFAULT 0;
 ALTER TABLE huawei_olt_srv_profiles ADD COLUMN IF NOT EXISTS wifi_enabled BOOLEAN DEFAULT false;
 ALTER TABLE huawei_olt_srv_profiles ADD COLUMN IF NOT EXISTS raw_config TEXT;
 ALTER TABLE huawei_olt_srv_profiles ADD COLUMN IF NOT EXISTS created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
 ALTER TABLE huawei_olt_srv_profiles ADD COLUMN IF NOT EXISTS updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
 ALTER TABLE huawei_olt_uplinks ADD COLUMN IF NOT EXISTS olt_id INTEGER;
 ALTER TABLE huawei_olt_uplinks ADD COLUMN IF NOT EXISTS port_name VARCHAR(20);
 ALTER TABLE huawei_olt_uplinks ADD COLUMN IF NOT EXISTS port_type VARCHAR(20);
 ALTER TABLE huawei_olt_uplinks ADD COLUMN IF NOT EXISTS admin_status VARCHAR(20) DEFAULT 'enable'::character varying;
 ALTER TABLE huawei_olt_uplinks ADD COLUMN IF NOT EXISTS oper_status VARCHAR(20);
 ALTER TABLE huawei_olt_uplinks ADD COLUMN IF NOT EXISTS speed VARCHAR(20);
 ALTER TABLE huawei_olt_uplinks ADD COLUMN IF NOT EXISTS duplex VARCHAR(20);
 ALTER TABLE huawei_olt_uplinks ADD COLUMN IF NOT EXISTS vlan_mode VARCHAR(20);
 ALTER TABLE huawei_olt_uplinks ADD COLUMN IF NOT EXISTS pvid INTEGER;
 ALTER TABLE huawei_olt_uplinks ADD COLUMN IF NOT EXISTS created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
 ALTER TABLE huawei_olt_uplinks ADD COLUMN IF NOT EXISTS updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
 ALTER TABLE huawei_olt_uplinks ADD COLUMN IF NOT EXISTS description VARCHAR(255);
 ALTER TABLE huawei_olt_uplinks ADD COLUMN IF NOT EXISTS allowed_vlans TEXT;
 ALTER TABLE huawei_olt_uplinks ADD COLUMN IF NOT EXISTS native_vlan INTEGER;
 ALTER TABLE huawei_olt_uplinks ADD COLUMN IF NOT EXISTS is_enabled BOOLEAN DEFAULT true;
 ALTER TABLE huawei_olt_uplinks ADD COLUMN IF NOT EXISTS mtu INTEGER DEFAULT 1500;
 ALTER TABLE huawei_olt_uplinks ADD COLUMN IF NOT EXISTS rx_bytes BIGINT DEFAULT 0;
 ALTER TABLE huawei_olt_uplinks ADD COLUMN IF NOT EXISTS tx_bytes BIGINT DEFAULT 0;
 ALTER TABLE huawei_olt_uplinks ADD COLUMN IF NOT EXISTS rx_errors BIGINT DEFAULT 0;
 ALTER TABLE huawei_olt_uplinks ADD COLUMN IF NOT EXISTS tx_errors BIGINT DEFAULT 0;
 ALTER TABLE huawei_olt_uplinks ADD COLUMN IF NOT EXISTS stats_updated_at TIMESTAMP;
 ALTER TABLE huawei_olt_vlans ADD COLUMN IF NOT EXISTS olt_id INTEGER;
 ALTER TABLE huawei_olt_vlans ADD COLUMN IF NOT EXISTS vlan_id INTEGER;
 ALTER TABLE huawei_olt_vlans ADD COLUMN IF NOT EXISTS vlan_type VARCHAR(50) DEFAULT 'smart'::character varying;
 ALTER TABLE huawei_olt_vlans ADD COLUMN IF NOT EXISTS description VARCHAR(255);
 ALTER TABLE huawei_olt_vlans ADD COLUMN IF NOT EXISTS created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
 ALTER TABLE huawei_olt_vlans ADD COLUMN IF NOT EXISTS updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
 ALTER TABLE huawei_olts ADD COLUMN IF NOT EXISTS name VARCHAR(100);
 ALTER TABLE huawei_olts ADD COLUMN IF NOT EXISTS ip_address VARCHAR(45);
 ALTER TABLE huawei_olts ADD COLUMN IF NOT EXISTS port INTEGER DEFAULT 23;
 ALTER TABLE huawei_olts ADD COLUMN IF NOT EXISTS connection_type VARCHAR(20) DEFAULT 'telnet'::character varying;
 ALTER TABLE huawei_olts ADD COLUMN IF NOT EXISTS username VARCHAR(100);
 ALTER TABLE huawei_olts ADD COLUMN IF NOT EXISTS password_encrypted TEXT;
 ALTER TABLE huawei_olts ADD COLUMN IF NOT EXISTS snmp_community VARCHAR(100) DEFAULT 'public'::character varying;
 ALTER TABLE huawei_olts ADD COLUMN IF NOT EXISTS snmp_version VARCHAR(10) DEFAULT 'v2c'::character varying;
 ALTER TABLE huawei_olts ADD COLUMN IF NOT EXISTS snmp_port INTEGER DEFAULT 161;
 ALTER TABLE huawei_olts ADD COLUMN IF NOT EXISTS vendor VARCHAR(50) DEFAULT 'Huawei'::character varying;
 ALTER TABLE huawei_olts ADD COLUMN IF NOT EXISTS model VARCHAR(100);
 ALTER TABLE huawei_olts ADD COLUMN IF NOT EXISTS location VARCHAR(255);
 ALTER TABLE huawei_olts ADD COLUMN IF NOT EXISTS is_active BOOLEAN DEFAULT true;
 ALTER TABLE huawei_olts ADD COLUMN IF NOT EXISTS last_sync_at TIMESTAMP;
 ALTER TABLE huawei_olts ADD COLUMN IF NOT EXISTS last_status VARCHAR(20) DEFAULT 'unknown'::character varying;
 ALTER TABLE huawei_olts ADD COLUMN IF NOT EXISTS uptime VARCHAR(100);
 ALTER TABLE huawei_olts ADD COLUMN IF NOT EXISTS temperature VARCHAR(50);
 ALTER TABLE huawei_olts ADD COLUMN IF NOT EXISTS created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
 ALTER TABLE huawei_olts ADD COLUMN IF NOT EXISTS updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
 ALTER TABLE huawei_olts ADD COLUMN IF NOT EXISTS boards_synced_at TIMESTAMP;
 ALTER TABLE huawei_olts ADD COLUMN IF NOT EXISTS vlans_synced_at TIMESTAMP;
 ALTER TABLE huawei_olts ADD COLUMN IF NOT EXISTS ports_synced_at TIMESTAMP;
 ALTER TABLE huawei_olts ADD COLUMN IF NOT EXISTS uplinks_synced_at TIMESTAMP;
 ALTER TABLE huawei_olts ADD COLUMN IF NOT EXISTS firmware_version VARCHAR(100);
 ALTER TABLE huawei_olts ADD COLUMN IF NOT EXISTS hardware_model VARCHAR(100);
 ALTER TABLE huawei_olts ADD COLUMN IF NOT EXISTS software_version VARCHAR(100);
 ALTER TABLE huawei_olts ADD COLUMN IF NOT EXISTS cpu_usage INTEGER;
 ALTER TABLE huawei_olts ADD COLUMN IF NOT EXISTS memory_usage INTEGER;
 ALTER TABLE huawei_olts ADD COLUMN IF NOT EXISTS system_synced_at TIMESTAMP;
 ALTER TABLE huawei_olts ADD COLUMN IF NOT EXISTS snmp_last_poll TIMESTAMP;
 ALTER TABLE huawei_olts ADD COLUMN IF NOT EXISTS snmp_sys_name VARCHAR(255);
 ALTER TABLE huawei_olts ADD COLUMN IF NOT EXISTS snmp_sys_descr TEXT;
 ALTER TABLE huawei_olts ADD COLUMN IF NOT EXISTS snmp_sys_uptime VARCHAR(100);
 ALTER TABLE huawei_olts ADD COLUMN IF NOT EXISTS snmp_sys_location VARCHAR(255);
 ALTER TABLE huawei_olts ADD COLUMN IF NOT EXISTS snmp_status VARCHAR(20) DEFAULT 'unknown'::character varying;
 ALTER TABLE huawei_olts ADD COLUMN IF NOT EXISTS snmp_read_community VARCHAR(100);
 ALTER TABLE huawei_olts ADD COLUMN IF NOT EXISTS snmp_write_community VARCHAR(100);
 ALTER TABLE huawei_olts ADD COLUMN IF NOT EXISTS branch_id INTEGER;
 ALTER TABLE huawei_olts ADD COLUMN IF NOT EXISTS smartolt_id INTEGER;
 ALTER TABLE huawei_olts ADD COLUMN IF NOT EXISTS default_line_profile INTEGER;
 ALTER TABLE huawei_onu_mgmt_ips ADD COLUMN IF NOT EXISTS olt_id INTEGER;
 ALTER TABLE huawei_onu_mgmt_ips ADD COLUMN IF NOT EXISTS onu_id INTEGER;
 ALTER TABLE huawei_onu_mgmt_ips ADD COLUMN IF NOT EXISTS ip_address VARCHAR(45);
 ALTER TABLE huawei_onu_mgmt_ips ADD COLUMN IF NOT EXISTS subnet_mask VARCHAR(45);
 ALTER TABLE huawei_onu_mgmt_ips ADD COLUMN IF NOT EXISTS gateway VARCHAR(45);
 ALTER TABLE huawei_onu_mgmt_ips ADD COLUMN IF NOT EXISTS vlan_id INTEGER;
 ALTER TABLE huawei_onu_mgmt_ips ADD COLUMN IF NOT EXISTS ip_type VARCHAR(20) DEFAULT 'static'::character varying;
 ALTER TABLE huawei_onu_mgmt_ips ADD COLUMN IF NOT EXISTS created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
 ALTER TABLE huawei_onu_mgmt_ips ADD COLUMN IF NOT EXISTS updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
 ALTER TABLE huawei_onu_service_vlans ADD COLUMN IF NOT EXISTS onu_id INTEGER;
 ALTER TABLE huawei_onu_service_vlans ADD COLUMN IF NOT EXISTS vlan_id INTEGER;
 ALTER TABLE huawei_onu_service_vlans ADD COLUMN IF NOT EXISTS vlan_name VARCHAR(100);
 ALTER TABLE huawei_onu_service_vlans ADD COLUMN IF NOT EXISTS interface_type VARCHAR(20) DEFAULT 'wifi'::character varying;
 ALTER TABLE huawei_onu_service_vlans ADD COLUMN IF NOT EXISTS port_mode VARCHAR(20) DEFAULT 'access'::character varying;
 ALTER TABLE huawei_onu_service_vlans ADD COLUMN IF NOT EXISTS is_native BOOLEAN DEFAULT false;
 ALTER TABLE huawei_onu_service_vlans ADD COLUMN IF NOT EXISTS priority INTEGER DEFAULT 0;
 ALTER TABLE huawei_onu_service_vlans ADD COLUMN IF NOT EXISTS created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
 ALTER TABLE huawei_onu_tr069_config ADD COLUMN IF NOT EXISTS onu_id INTEGER;
 ALTER TABLE huawei_onu_tr069_config ADD COLUMN IF NOT EXISTS config_data TEXT;
 ALTER TABLE huawei_onu_tr069_config ADD COLUMN IF NOT EXISTS status VARCHAR(20) DEFAULT 'pending'::character varying;
 ALTER TABLE huawei_onu_tr069_config ADD COLUMN IF NOT EXISTS created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
 ALTER TABLE huawei_onu_tr069_config ADD COLUMN IF NOT EXISTS updated_at TIMESTAMP;
 ALTER TABLE huawei_onu_tr069_config ADD COLUMN IF NOT EXISTS applied_at TIMESTAMP;
 ALTER TABLE huawei_onu_types ADD COLUMN IF NOT EXISTS name VARCHAR(100);
 ALTER TABLE huawei_onu_types ADD COLUMN IF NOT EXISTS model VARCHAR(100);
 ALTER TABLE huawei_onu_types ADD COLUMN IF NOT EXISTS model_aliases TEXT;
 ALTER TABLE huawei_onu_types ADD COLUMN IF NOT EXISTS vendor VARCHAR(100) DEFAULT 'Huawei'::character varying;
 ALTER TABLE huawei_onu_types ADD COLUMN IF NOT EXISTS eth_ports INTEGER DEFAULT 1;
 ALTER TABLE huawei_onu_types ADD COLUMN IF NOT EXISTS pots_ports INTEGER DEFAULT 0;
 ALTER TABLE huawei_onu_types ADD COLUMN IF NOT EXISTS wifi_capable BOOLEAN DEFAULT false;
 ALTER TABLE huawei_onu_types ADD COLUMN IF NOT EXISTS wifi_dual_band BOOLEAN DEFAULT false;
 ALTER TABLE huawei_onu_types ADD COLUMN IF NOT EXISTS catv_port BOOLEAN DEFAULT false;
 ALTER TABLE huawei_onu_types ADD COLUMN IF NOT EXISTS usb_port BOOLEAN DEFAULT false;
 ALTER TABLE huawei_onu_types ADD COLUMN IF NOT EXISTS pon_type VARCHAR(20) DEFAULT 'GPON'::character varying;
 ALTER TABLE huawei_onu_types ADD COLUMN IF NOT EXISTS default_mode VARCHAR(20) DEFAULT 'bridge'::character varying;
 ALTER TABLE huawei_onu_types ADD COLUMN IF NOT EXISTS tcont_count INTEGER DEFAULT 1;
 ALTER TABLE huawei_onu_types ADD COLUMN IF NOT EXISTS gemport_count INTEGER DEFAULT 1;
 ALTER TABLE huawei_onu_types ADD COLUMN IF NOT EXISTS recommended_line_profile VARCHAR(100);
 ALTER TABLE huawei_onu_types ADD COLUMN IF NOT EXISTS recommended_srv_profile VARCHAR(100);
 ALTER TABLE huawei_onu_types ADD COLUMN IF NOT EXISTS omci_capable BOOLEAN DEFAULT true;
 ALTER TABLE huawei_onu_types ADD COLUMN IF NOT EXISTS tr069_capable BOOLEAN DEFAULT true;
 ALTER TABLE huawei_onu_types ADD COLUMN IF NOT EXISTS description TEXT;
 ALTER TABLE huawei_onu_types ADD COLUMN IF NOT EXISTS is_active BOOLEAN DEFAULT true;
 ALTER TABLE huawei_onu_types ADD COLUMN IF NOT EXISTS created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
 ALTER TABLE huawei_onu_types ADD COLUMN IF NOT EXISTS updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
 ALTER TABLE huawei_onus ADD COLUMN IF NOT EXISTS olt_id INTEGER;
 ALTER TABLE huawei_onus ADD COLUMN IF NOT EXISTS customer_id INTEGER;
 ALTER TABLE huawei_onus ADD COLUMN IF NOT EXISTS sn VARCHAR(100);
 ALTER TABLE huawei_onus ADD COLUMN IF NOT EXISTS name VARCHAR(100);
 ALTER TABLE huawei_onus ADD COLUMN IF NOT EXISTS description TEXT;
 ALTER TABLE huawei_onus ADD COLUMN IF NOT EXISTS frame BIGINT DEFAULT 0;
 ALTER TABLE huawei_onus ADD COLUMN IF NOT EXISTS slot BIGINT;
 ALTER TABLE huawei_onus ADD COLUMN IF NOT EXISTS port BIGINT;
 ALTER TABLE huawei_onus ADD COLUMN IF NOT EXISTS onu_id BIGINT;
 ALTER TABLE huawei_onus ADD COLUMN IF NOT EXISTS onu_type VARCHAR(100);
 ALTER TABLE huawei_onus ADD COLUMN IF NOT EXISTS mac_address VARCHAR(17);
 ALTER TABLE huawei_onus ADD COLUMN IF NOT EXISTS status VARCHAR(30) DEFAULT 'offline'::character varying;
 ALTER TABLE huawei_onus ADD COLUMN IF NOT EXISTS rx_power NUMERIC;
 ALTER TABLE huawei_onus ADD COLUMN IF NOT EXISTS tx_power NUMERIC;
 ALTER TABLE huawei_onus ADD COLUMN IF NOT EXISTS distance INTEGER;
 ALTER TABLE huawei_onus ADD COLUMN IF NOT EXISTS last_down_cause VARCHAR(100);
 ALTER TABLE huawei_onus ADD COLUMN IF NOT EXISTS last_down_time TIMESTAMP;
 ALTER TABLE huawei_onus ADD COLUMN IF NOT EXISTS last_up_time TIMESTAMP;
 ALTER TABLE huawei_onus ADD COLUMN IF NOT EXISTS service_profile_id INTEGER;
 ALTER TABLE huawei_onus ADD COLUMN IF NOT EXISTS line_profile VARCHAR(100);
 ALTER TABLE huawei_onus ADD COLUMN IF NOT EXISTS srv_profile VARCHAR(100);
 ALTER TABLE huawei_onus ADD COLUMN IF NOT EXISTS is_authorized BOOLEAN DEFAULT false;
 ALTER TABLE huawei_onus ADD COLUMN IF NOT EXISTS firmware_version VARCHAR(100);
 ALTER TABLE huawei_onus ADD COLUMN IF NOT EXISTS hardware_version VARCHAR(100);
 ALTER TABLE huawei_onus ADD COLUMN IF NOT EXISTS software_version VARCHAR(100);
 ALTER TABLE huawei_onus ADD COLUMN IF NOT EXISTS ip_address VARCHAR(45);
 ALTER TABLE huawei_onus ADD COLUMN IF NOT EXISTS config_state VARCHAR(50);
 ALTER TABLE huawei_onus ADD COLUMN IF NOT EXISTS run_state VARCHAR(50);
 ALTER TABLE huawei_onus ADD COLUMN IF NOT EXISTS auth_type VARCHAR(20) DEFAULT 'sn'::character varying;
 ALTER TABLE huawei_onus ADD COLUMN IF NOT EXISTS password VARCHAR(100);
 ALTER TABLE huawei_onus ADD COLUMN IF NOT EXISTS additional_info TEXT;
 ALTER TABLE huawei_onus ADD COLUMN IF NOT EXISTS created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
 ALTER TABLE huawei_onus ADD COLUMN IF NOT EXISTS updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
 ALTER TABLE huawei_onus ADD COLUMN IF NOT EXISTS vlan_id INTEGER;
 ALTER TABLE huawei_onus ADD COLUMN IF NOT EXISTS vlan_priority INTEGER DEFAULT 0;
 ALTER TABLE huawei_onus ADD COLUMN IF NOT EXISTS ip_mode VARCHAR(20) DEFAULT 'dhcp'::character varying;
 ALTER TABLE huawei_onus ADD COLUMN IF NOT EXISTS line_profile_id INTEGER;
 ALTER TABLE huawei_onus ADD COLUMN IF NOT EXISTS srv_profile_id INTEGER;
 ALTER TABLE huawei_onus ADD COLUMN IF NOT EXISTS tr069_profile_id INTEGER;
 ALTER TABLE huawei_onus ADD COLUMN IF NOT EXISTS zone VARCHAR(100);
 ALTER TABLE huawei_onus ADD COLUMN IF NOT EXISTS area VARCHAR(100);
 ALTER TABLE huawei_onus ADD COLUMN IF NOT EXISTS customer_name VARCHAR(255);
 ALTER TABLE huawei_onus ADD COLUMN IF NOT EXISTS auth_date DATE;
 ALTER TABLE huawei_onus ADD COLUMN IF NOT EXISTS apartment VARCHAR(100);
 ALTER TABLE huawei_onus ADD COLUMN IF NOT EXISTS odb VARCHAR(50);
 ALTER TABLE huawei_onus ADD COLUMN IF NOT EXISTS zone_id INTEGER;
 ALTER TABLE huawei_onus ADD COLUMN IF NOT EXISTS subzone_id INTEGER;
 ALTER TABLE huawei_onus ADD COLUMN IF NOT EXISTS apartment_id INTEGER;
 ALTER TABLE huawei_onus ADD COLUMN IF NOT EXISTS odb_id INTEGER;
 ALTER TABLE huawei_onus ADD COLUMN IF NOT EXISTS olt_sync_pending BOOLEAN DEFAULT false;
 ALTER TABLE huawei_onus ADD COLUMN IF NOT EXISTS optical_updated_at TIMESTAMP;
 ALTER TABLE huawei_onus ADD COLUMN IF NOT EXISTS onu_type_id INTEGER;
 ALTER TABLE huawei_onus ADD COLUMN IF NOT EXISTS tr069_device_id VARCHAR(255);
 ALTER TABLE huawei_onus ADD COLUMN IF NOT EXISTS tr069_serial VARCHAR(100);
 ALTER TABLE huawei_onus ADD COLUMN IF NOT EXISTS tr069_ip VARCHAR(45);
 ALTER TABLE huawei_onus ADD COLUMN IF NOT EXISTS tr069_status VARCHAR(50) DEFAULT 'pending'::character varying;
 ALTER TABLE huawei_onus ADD COLUMN IF NOT EXISTS tr069_last_inform TIMESTAMP;
 ALTER TABLE huawei_onus ADD COLUMN IF NOT EXISTS discovered_eqid VARCHAR(100);
 ALTER TABLE huawei_onus ADD COLUMN IF NOT EXISTS port_config JSONB;
 ALTER TABLE huawei_onus ADD COLUMN IF NOT EXISTS smartolt_external_id VARCHAR(100);
 ALTER TABLE huawei_pon_ports ADD COLUMN IF NOT EXISTS olt_id INTEGER;
 ALTER TABLE huawei_pon_ports ADD COLUMN IF NOT EXISTS frame INTEGER DEFAULT 0;
 ALTER TABLE huawei_pon_ports ADD COLUMN IF NOT EXISTS slot INTEGER;
 ALTER TABLE huawei_pon_ports ADD COLUMN IF NOT EXISTS port INTEGER;
 ALTER TABLE huawei_pon_ports ADD COLUMN IF NOT EXISTS admin_status VARCHAR(30);
 ALTER TABLE huawei_pon_ports ADD COLUMN IF NOT EXISTS oper_status VARCHAR(30);
 ALTER TABLE huawei_pon_ports ADD COLUMN IF NOT EXISTS onu_count INTEGER DEFAULT 0;
 ALTER TABLE huawei_pon_ports ADD COLUMN IF NOT EXISTS max_onus INTEGER DEFAULT 128;
 ALTER TABLE huawei_pon_ports ADD COLUMN IF NOT EXISTS description TEXT;
 ALTER TABLE huawei_pon_ports ADD COLUMN IF NOT EXISTS synced_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
 ALTER TABLE huawei_pon_ports ADD COLUMN IF NOT EXISTS created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
 ALTER TABLE huawei_pon_ports ADD COLUMN IF NOT EXISTS default_vlan INTEGER;
 ALTER TABLE huawei_port_vlans ADD COLUMN IF NOT EXISTS olt_id INTEGER;
 ALTER TABLE huawei_port_vlans ADD COLUMN IF NOT EXISTS port_name VARCHAR(20);
 ALTER TABLE huawei_port_vlans ADD COLUMN IF NOT EXISTS port_type VARCHAR(10) DEFAULT 'pon'::character varying;
 ALTER TABLE huawei_port_vlans ADD COLUMN IF NOT EXISTS vlan_id INTEGER;
 ALTER TABLE huawei_port_vlans ADD COLUMN IF NOT EXISTS vlan_mode VARCHAR(20) DEFAULT 'tag'::character varying;
 ALTER TABLE huawei_port_vlans ADD COLUMN IF NOT EXISTS created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
 ALTER TABLE huawei_provisioning_logs ADD COLUMN IF NOT EXISTS olt_id INTEGER;
 ALTER TABLE huawei_provisioning_logs ADD COLUMN IF NOT EXISTS onu_id INTEGER;
 ALTER TABLE huawei_provisioning_logs ADD COLUMN IF NOT EXISTS action VARCHAR(50);
 ALTER TABLE huawei_provisioning_logs ADD COLUMN IF NOT EXISTS status VARCHAR(20) DEFAULT 'pending'::character varying;
 ALTER TABLE huawei_provisioning_logs ADD COLUMN IF NOT EXISTS message TEXT;
 ALTER TABLE huawei_provisioning_logs ADD COLUMN IF NOT EXISTS details TEXT;
 ALTER TABLE huawei_provisioning_logs ADD COLUMN IF NOT EXISTS command_sent TEXT;
 ALTER TABLE huawei_provisioning_logs ADD COLUMN IF NOT EXISTS command_response TEXT;
 ALTER TABLE huawei_provisioning_logs ADD COLUMN IF NOT EXISTS user_id INTEGER;
 ALTER TABLE huawei_provisioning_logs ADD COLUMN IF NOT EXISTS created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
 ALTER TABLE huawei_service_profiles ADD COLUMN IF NOT EXISTS name VARCHAR(100);
 ALTER TABLE huawei_service_profiles ADD COLUMN IF NOT EXISTS description TEXT;
 ALTER TABLE huawei_service_profiles ADD COLUMN IF NOT EXISTS profile_type VARCHAR(50) DEFAULT 'internet'::character varying;
 ALTER TABLE huawei_service_profiles ADD COLUMN IF NOT EXISTS vlan_id INTEGER;
 ALTER TABLE huawei_service_profiles ADD COLUMN IF NOT EXISTS vlan_mode VARCHAR(20) DEFAULT 'tag'::character varying;
 ALTER TABLE huawei_service_profiles ADD COLUMN IF NOT EXISTS speed_profile_up VARCHAR(50);
 ALTER TABLE huawei_service_profiles ADD COLUMN IF NOT EXISTS speed_profile_down VARCHAR(50);
 ALTER TABLE huawei_service_profiles ADD COLUMN IF NOT EXISTS qos_profile VARCHAR(100);
 ALTER TABLE huawei_service_profiles ADD COLUMN IF NOT EXISTS gem_port INTEGER;
 ALTER TABLE huawei_service_profiles ADD COLUMN IF NOT EXISTS tcont_profile VARCHAR(100);
 ALTER TABLE huawei_service_profiles ADD COLUMN IF NOT EXISTS line_profile VARCHAR(100);
 ALTER TABLE huawei_service_profiles ADD COLUMN IF NOT EXISTS srv_profile VARCHAR(100);
 ALTER TABLE huawei_service_profiles ADD COLUMN IF NOT EXISTS native_vlan INTEGER;
 ALTER TABLE huawei_service_profiles ADD COLUMN IF NOT EXISTS additional_config TEXT;
 ALTER TABLE huawei_service_profiles ADD COLUMN IF NOT EXISTS is_default BOOLEAN DEFAULT false;
 ALTER TABLE huawei_service_profiles ADD COLUMN IF NOT EXISTS is_active BOOLEAN DEFAULT true;
 ALTER TABLE huawei_service_profiles ADD COLUMN IF NOT EXISTS created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
 ALTER TABLE huawei_service_profiles ADD COLUMN IF NOT EXISTS updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
 ALTER TABLE huawei_service_profiles ADD COLUMN IF NOT EXISTS tr069_vlan INTEGER;
 ALTER TABLE huawei_service_profiles ADD COLUMN IF NOT EXISTS tr069_profile_id INTEGER;
 ALTER TABLE huawei_service_profiles ADD COLUMN IF NOT EXISTS tr069_gem_port INTEGER DEFAULT 2;
 ALTER TABLE huawei_service_templates ADD COLUMN IF NOT EXISTS name VARCHAR(100);
 ALTER TABLE huawei_service_templates ADD COLUMN IF NOT EXISTS description TEXT;
 ALTER TABLE huawei_service_templates ADD COLUMN IF NOT EXISTS downstream_bandwidth INTEGER DEFAULT 100;
 ALTER TABLE huawei_service_templates ADD COLUMN IF NOT EXISTS upstream_bandwidth INTEGER DEFAULT 50;
 ALTER TABLE huawei_service_templates ADD COLUMN IF NOT EXISTS bandwidth_unit VARCHAR(10) DEFAULT 'mbps'::character varying;
 ALTER TABLE huawei_service_templates ADD COLUMN IF NOT EXISTS vlan_id INTEGER;
 ALTER TABLE huawei_service_templates ADD COLUMN IF NOT EXISTS vlan_mode VARCHAR(20) DEFAULT 'tag'::character varying;
 ALTER TABLE huawei_service_templates ADD COLUMN IF NOT EXISTS qos_profile VARCHAR(100);
 ALTER TABLE huawei_service_templates ADD COLUMN IF NOT EXISTS line_profile_id INTEGER;
 ALTER TABLE huawei_service_templates ADD COLUMN IF NOT EXISTS service_profile_id INTEGER;
 ALTER TABLE huawei_service_templates ADD COLUMN IF NOT EXISTS iptv_enabled BOOLEAN DEFAULT false;
 ALTER TABLE huawei_service_templates ADD COLUMN IF NOT EXISTS voip_enabled BOOLEAN DEFAULT false;
 ALTER TABLE huawei_service_templates ADD COLUMN IF NOT EXISTS tr069_enabled BOOLEAN DEFAULT false;
 ALTER TABLE huawei_service_templates ADD COLUMN IF NOT EXISTS is_default BOOLEAN DEFAULT false;
 ALTER TABLE huawei_service_templates ADD COLUMN IF NOT EXISTS created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
 ALTER TABLE huawei_service_templates ADD COLUMN IF NOT EXISTS updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
 ALTER TABLE huawei_subzones ADD COLUMN IF NOT EXISTS zone_id INTEGER;
 ALTER TABLE huawei_subzones ADD COLUMN IF NOT EXISTS name VARCHAR(100);
 ALTER TABLE huawei_subzones ADD COLUMN IF NOT EXISTS description TEXT;
 ALTER TABLE huawei_subzones ADD COLUMN IF NOT EXISTS is_active BOOLEAN DEFAULT true;
 ALTER TABLE huawei_subzones ADD COLUMN IF NOT EXISTS created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
 ALTER TABLE huawei_subzones ADD COLUMN IF NOT EXISTS updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
 ALTER TABLE huawei_uplinks ADD COLUMN IF NOT EXISTS olt_id INTEGER;
 ALTER TABLE huawei_uplinks ADD COLUMN IF NOT EXISTS frame INTEGER DEFAULT 0;
 ALTER TABLE huawei_uplinks ADD COLUMN IF NOT EXISTS slot INTEGER;
 ALTER TABLE huawei_uplinks ADD COLUMN IF NOT EXISTS port INTEGER;
 ALTER TABLE huawei_uplinks ADD COLUMN IF NOT EXISTS port_type VARCHAR(50);
 ALTER TABLE huawei_uplinks ADD COLUMN IF NOT EXISTS admin_status VARCHAR(30);
 ALTER TABLE huawei_uplinks ADD COLUMN IF NOT EXISTS oper_status VARCHAR(30);
 ALTER TABLE huawei_uplinks ADD COLUMN IF NOT EXISTS speed VARCHAR(30);
 ALTER TABLE huawei_uplinks ADD COLUMN IF NOT EXISTS duplex VARCHAR(30);
 ALTER TABLE huawei_uplinks ADD COLUMN IF NOT EXISTS vlan_mode VARCHAR(30);
 ALTER TABLE huawei_uplinks ADD COLUMN IF NOT EXISTS allowed_vlans TEXT;
 ALTER TABLE huawei_uplinks ADD COLUMN IF NOT EXISTS pvid INTEGER;
 ALTER TABLE huawei_uplinks ADD COLUMN IF NOT EXISTS description TEXT;
 ALTER TABLE huawei_uplinks ADD COLUMN IF NOT EXISTS synced_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
 ALTER TABLE huawei_uplinks ADD COLUMN IF NOT EXISTS created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
 ALTER TABLE huawei_vlans ADD COLUMN IF NOT EXISTS olt_id INTEGER;
 ALTER TABLE huawei_vlans ADD COLUMN IF NOT EXISTS vlan_id INTEGER;
 ALTER TABLE huawei_vlans ADD COLUMN IF NOT EXISTS vlan_type VARCHAR(20) DEFAULT 'smart'::character varying;
 ALTER TABLE huawei_vlans ADD COLUMN IF NOT EXISTS attribute VARCHAR(50) DEFAULT 'common'::character varying;
 ALTER TABLE huawei_vlans ADD COLUMN IF NOT EXISTS standard_port_count INTEGER DEFAULT 0;
 ALTER TABLE huawei_vlans ADD COLUMN IF NOT EXISTS service_port_count INTEGER DEFAULT 0;
 ALTER TABLE huawei_vlans ADD COLUMN IF NOT EXISTS vlan_connect_count INTEGER DEFAULT 0;
 ALTER TABLE huawei_vlans ADD COLUMN IF NOT EXISTS description VARCHAR(255);
 ALTER TABLE huawei_vlans ADD COLUMN IF NOT EXISTS is_management BOOLEAN DEFAULT false;
 ALTER TABLE huawei_vlans ADD COLUMN IF NOT EXISTS is_active BOOLEAN DEFAULT true;
 ALTER TABLE huawei_vlans ADD COLUMN IF NOT EXISTS created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
 ALTER TABLE huawei_vlans ADD COLUMN IF NOT EXISTS updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
 ALTER TABLE huawei_vlans ADD COLUMN IF NOT EXISTS is_multicast BOOLEAN DEFAULT false;
 ALTER TABLE huawei_vlans ADD COLUMN IF NOT EXISTS is_voip BOOLEAN DEFAULT false;
 ALTER TABLE huawei_vlans ADD COLUMN IF NOT EXISTS dhcp_snooping BOOLEAN DEFAULT false;
 ALTER TABLE huawei_vlans ADD COLUMN IF NOT EXISTS lan_to_lan BOOLEAN DEFAULT false;
 ALTER TABLE huawei_vlans ADD COLUMN IF NOT EXISTS is_tr069 BOOLEAN DEFAULT false;
 ALTER TABLE huawei_zones ADD COLUMN IF NOT EXISTS name VARCHAR(100);
 ALTER TABLE huawei_zones ADD COLUMN IF NOT EXISTS description TEXT;
 ALTER TABLE huawei_zones ADD COLUMN IF NOT EXISTS is_active BOOLEAN DEFAULT true;
 ALTER TABLE huawei_zones ADD COLUMN IF NOT EXISTS created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
 ALTER TABLE huawei_zones ADD COLUMN IF NOT EXISTS updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
 ALTER TABLE interface_history ADD COLUMN IF NOT EXISTS interface_id INTEGER;
 ALTER TABLE interface_history ADD COLUMN IF NOT EXISTS in_octets BIGINT DEFAULT 0;
 ALTER TABLE interface_history ADD COLUMN IF NOT EXISTS out_octets BIGINT DEFAULT 0;
 ALTER TABLE interface_history ADD COLUMN IF NOT EXISTS in_rate BIGINT DEFAULT 0;
 ALTER TABLE interface_history ADD COLUMN IF NOT EXISTS out_rate BIGINT DEFAULT 0;
 ALTER TABLE interface_history ADD COLUMN IF NOT EXISTS in_errors BIGINT DEFAULT 0;
 ALTER TABLE interface_history ADD COLUMN IF NOT EXISTS out_errors BIGINT DEFAULT 0;
 ALTER TABLE interface_history ADD COLUMN IF NOT EXISTS recorded_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
 ALTER TABLE inventory_audit_items ADD COLUMN IF NOT EXISTS audit_id INTEGER;
 ALTER TABLE inventory_audit_items ADD COLUMN IF NOT EXISTS equipment_id INTEGER;
 ALTER TABLE inventory_audit_items ADD COLUMN IF NOT EXISTS category_id INTEGER;
 ALTER TABLE inventory_audit_items ADD COLUMN IF NOT EXISTS expected_qty INTEGER DEFAULT 0;
 ALTER TABLE inventory_audit_items ADD COLUMN IF NOT EXISTS actual_qty INTEGER DEFAULT 0;
 ALTER TABLE inventory_audit_items ADD COLUMN IF NOT EXISTS variance INTEGER DEFAULT 0;
 ALTER TABLE inventory_audit_items ADD COLUMN IF NOT EXISTS notes TEXT;
 ALTER TABLE inventory_audit_items ADD COLUMN IF NOT EXISTS verified_by INTEGER;
 ALTER TABLE inventory_audit_items ADD COLUMN IF NOT EXISTS verified_at TIMESTAMP;
 ALTER TABLE inventory_audit_items ADD COLUMN IF NOT EXISTS created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
 ALTER TABLE inventory_audits ADD COLUMN IF NOT EXISTS audit_number VARCHAR(30);
 ALTER TABLE inventory_audits ADD COLUMN IF NOT EXISTS warehouse_id INTEGER;
 ALTER TABLE inventory_audits ADD COLUMN IF NOT EXISTS audit_type VARCHAR(30) DEFAULT 'full'::character varying;
 ALTER TABLE inventory_audits ADD COLUMN IF NOT EXISTS scheduled_date DATE;
 ALTER TABLE inventory_audits ADD COLUMN IF NOT EXISTS completed_date DATE;
 ALTER TABLE inventory_audits ADD COLUMN IF NOT EXISTS status VARCHAR(20) DEFAULT 'pending'::character varying;
 ALTER TABLE inventory_audits ADD COLUMN IF NOT EXISTS notes TEXT;
 ALTER TABLE inventory_audits ADD COLUMN IF NOT EXISTS created_by INTEGER;
 ALTER TABLE inventory_audits ADD COLUMN IF NOT EXISTS completed_by INTEGER;
 ALTER TABLE inventory_audits ADD COLUMN IF NOT EXISTS created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
 ALTER TABLE inventory_locations ADD COLUMN IF NOT EXISTS warehouse_id INTEGER;
 ALTER TABLE inventory_locations ADD COLUMN IF NOT EXISTS name VARCHAR(100);
 ALTER TABLE inventory_locations ADD COLUMN IF NOT EXISTS code VARCHAR(50);
 ALTER TABLE inventory_locations ADD COLUMN IF NOT EXISTS type VARCHAR(30) DEFAULT 'shelf'::character varying;
 ALTER TABLE inventory_locations ADD COLUMN IF NOT EXISTS capacity INTEGER;
 ALTER TABLE inventory_locations ADD COLUMN IF NOT EXISTS notes TEXT;
 ALTER TABLE inventory_locations ADD COLUMN IF NOT EXISTS is_active BOOLEAN DEFAULT true;
 ALTER TABLE inventory_locations ADD COLUMN IF NOT EXISTS created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
 ALTER TABLE inventory_loss_reports ADD COLUMN IF NOT EXISTS report_number VARCHAR(30);
 ALTER TABLE inventory_loss_reports ADD COLUMN IF NOT EXISTS equipment_id INTEGER;
 ALTER TABLE inventory_loss_reports ADD COLUMN IF NOT EXISTS reported_by INTEGER;
 ALTER TABLE inventory_loss_reports ADD COLUMN IF NOT EXISTS employee_id INTEGER;
 ALTER TABLE inventory_loss_reports ADD COLUMN IF NOT EXISTS loss_type VARCHAR(30) DEFAULT 'lost'::character varying;
 ALTER TABLE inventory_loss_reports ADD COLUMN IF NOT EXISTS loss_date DATE;
 ALTER TABLE inventory_loss_reports ADD COLUMN IF NOT EXISTS description TEXT;
 ALTER TABLE inventory_loss_reports ADD COLUMN IF NOT EXISTS estimated_value NUMERIC;
 ALTER TABLE inventory_loss_reports ADD COLUMN IF NOT EXISTS investigation_status VARCHAR(20) DEFAULT 'pending'::character varying;
 ALTER TABLE inventory_loss_reports ADD COLUMN IF NOT EXISTS investigation_notes TEXT;
 ALTER TABLE inventory_loss_reports ADD COLUMN IF NOT EXISTS resolved_by INTEGER;
 ALTER TABLE inventory_loss_reports ADD COLUMN IF NOT EXISTS resolved_at TIMESTAMP;
 ALTER TABLE inventory_loss_reports ADD COLUMN IF NOT EXISTS resolution VARCHAR(50);
 ALTER TABLE inventory_loss_reports ADD COLUMN IF NOT EXISTS created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
 ALTER TABLE inventory_loss_reports ADD COLUMN IF NOT EXISTS updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
 ALTER TABLE inventory_po_items ADD COLUMN IF NOT EXISTS po_id INTEGER;
 ALTER TABLE inventory_po_items ADD COLUMN IF NOT EXISTS category_id INTEGER;
 ALTER TABLE inventory_po_items ADD COLUMN IF NOT EXISTS item_name VARCHAR(200);
 ALTER TABLE inventory_po_items ADD COLUMN IF NOT EXISTS quantity INTEGER;
 ALTER TABLE inventory_po_items ADD COLUMN IF NOT EXISTS unit_price NUMERIC DEFAULT 0;
 ALTER TABLE inventory_po_items ADD COLUMN IF NOT EXISTS received_qty INTEGER DEFAULT 0;
 ALTER TABLE inventory_po_items ADD COLUMN IF NOT EXISTS notes TEXT;
 ALTER TABLE inventory_po_items ADD COLUMN IF NOT EXISTS created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
 ALTER TABLE inventory_purchase_orders ADD COLUMN IF NOT EXISTS po_number VARCHAR(30);
 ALTER TABLE inventory_purchase_orders ADD COLUMN IF NOT EXISTS supplier_name VARCHAR(200);
 ALTER TABLE inventory_purchase_orders ADD COLUMN IF NOT EXISTS supplier_contact VARCHAR(100);
 ALTER TABLE inventory_purchase_orders ADD COLUMN IF NOT EXISTS order_date DATE;
 ALTER TABLE inventory_purchase_orders ADD COLUMN IF NOT EXISTS expected_date DATE;
 ALTER TABLE inventory_purchase_orders ADD COLUMN IF NOT EXISTS status VARCHAR(20) DEFAULT 'pending'::character varying;
 ALTER TABLE inventory_purchase_orders ADD COLUMN IF NOT EXISTS total_amount NUMERIC DEFAULT 0;
 ALTER TABLE inventory_purchase_orders ADD COLUMN IF NOT EXISTS notes TEXT;
 ALTER TABLE inventory_purchase_orders ADD COLUMN IF NOT EXISTS created_by INTEGER;
 ALTER TABLE inventory_purchase_orders ADD COLUMN IF NOT EXISTS approved_by INTEGER;
 ALTER TABLE inventory_purchase_orders ADD COLUMN IF NOT EXISTS approved_at TIMESTAMP;
 ALTER TABLE inventory_purchase_orders ADD COLUMN IF NOT EXISTS created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
 ALTER TABLE inventory_purchase_orders ADD COLUMN IF NOT EXISTS updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
 ALTER TABLE inventory_receipt_items ADD COLUMN IF NOT EXISTS receipt_id INTEGER;
 ALTER TABLE inventory_receipt_items ADD COLUMN IF NOT EXISTS po_item_id INTEGER;
 ALTER TABLE inventory_receipt_items ADD COLUMN IF NOT EXISTS equipment_id INTEGER;
 ALTER TABLE inventory_receipt_items ADD COLUMN IF NOT EXISTS category_id INTEGER;
 ALTER TABLE inventory_receipt_items ADD COLUMN IF NOT EXISTS item_name VARCHAR(200);
 ALTER TABLE inventory_receipt_items ADD COLUMN IF NOT EXISTS quantity INTEGER DEFAULT 1;
 ALTER TABLE inventory_receipt_items ADD COLUMN IF NOT EXISTS serial_number VARCHAR(100);
 ALTER TABLE inventory_receipt_items ADD COLUMN IF NOT EXISTS mac_address VARCHAR(50);
 ALTER TABLE inventory_receipt_items ADD COLUMN IF NOT EXISTS condition VARCHAR(20) DEFAULT 'new'::character varying;
 ALTER TABLE inventory_receipt_items ADD COLUMN IF NOT EXISTS location_id INTEGER;
 ALTER TABLE inventory_receipt_items ADD COLUMN IF NOT EXISTS unit_cost NUMERIC DEFAULT 0;
 ALTER TABLE inventory_receipt_items ADD COLUMN IF NOT EXISTS notes TEXT;
 ALTER TABLE inventory_receipt_items ADD COLUMN IF NOT EXISTS created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
 ALTER TABLE inventory_receipts ADD COLUMN IF NOT EXISTS receipt_number VARCHAR(30);
 ALTER TABLE inventory_receipts ADD COLUMN IF NOT EXISTS po_id INTEGER;
 ALTER TABLE inventory_receipts ADD COLUMN IF NOT EXISTS warehouse_id INTEGER;
 ALTER TABLE inventory_receipts ADD COLUMN IF NOT EXISTS receipt_date DATE;
 ALTER TABLE inventory_receipts ADD COLUMN IF NOT EXISTS supplier_name VARCHAR(200);
 ALTER TABLE inventory_receipts ADD COLUMN IF NOT EXISTS delivery_note VARCHAR(100);
 ALTER TABLE inventory_receipts ADD COLUMN IF NOT EXISTS status VARCHAR(20) DEFAULT 'pending'::character varying;
 ALTER TABLE inventory_receipts ADD COLUMN IF NOT EXISTS notes TEXT;
 ALTER TABLE inventory_receipts ADD COLUMN IF NOT EXISTS received_by INTEGER;
 ALTER TABLE inventory_receipts ADD COLUMN IF NOT EXISTS verified_by INTEGER;
 ALTER TABLE inventory_receipts ADD COLUMN IF NOT EXISTS verified_at TIMESTAMP;
 ALTER TABLE inventory_receipts ADD COLUMN IF NOT EXISTS created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
 ALTER TABLE inventory_return_items ADD COLUMN IF NOT EXISTS return_id INTEGER;
 ALTER TABLE inventory_return_items ADD COLUMN IF NOT EXISTS equipment_id INTEGER;
 ALTER TABLE inventory_return_items ADD COLUMN IF NOT EXISTS request_item_id INTEGER;
 ALTER TABLE inventory_return_items ADD COLUMN IF NOT EXISTS quantity INTEGER DEFAULT 1;
 ALTER TABLE inventory_return_items ADD COLUMN IF NOT EXISTS condition VARCHAR(20) DEFAULT 'good'::character varying;
 ALTER TABLE inventory_return_items ADD COLUMN IF NOT EXISTS location_id INTEGER;
 ALTER TABLE inventory_return_items ADD COLUMN IF NOT EXISTS notes TEXT;
 ALTER TABLE inventory_return_items ADD COLUMN IF NOT EXISTS created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
 ALTER TABLE inventory_returns ADD COLUMN IF NOT EXISTS return_number VARCHAR(30);
 ALTER TABLE inventory_returns ADD COLUMN IF NOT EXISTS request_id INTEGER;
 ALTER TABLE inventory_returns ADD COLUMN IF NOT EXISTS returned_by INTEGER;
 ALTER TABLE inventory_returns ADD COLUMN IF NOT EXISTS warehouse_id INTEGER;
 ALTER TABLE inventory_returns ADD COLUMN IF NOT EXISTS return_date DATE;
 ALTER TABLE inventory_returns ADD COLUMN IF NOT EXISTS return_type VARCHAR(30) DEFAULT 'unused'::character varying;
 ALTER TABLE inventory_returns ADD COLUMN IF NOT EXISTS status VARCHAR(20) DEFAULT 'pending'::character varying;
 ALTER TABLE inventory_returns ADD COLUMN IF NOT EXISTS notes TEXT;
 ALTER TABLE inventory_returns ADD COLUMN IF NOT EXISTS received_by INTEGER;
 ALTER TABLE inventory_returns ADD COLUMN IF NOT EXISTS received_at TIMESTAMP;
 ALTER TABLE inventory_returns ADD COLUMN IF NOT EXISTS created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
 ALTER TABLE inventory_rma ADD COLUMN IF NOT EXISTS rma_number VARCHAR(30);
 ALTER TABLE inventory_rma ADD COLUMN IF NOT EXISTS equipment_id INTEGER;
 ALTER TABLE inventory_rma ADD COLUMN IF NOT EXISTS fault_id INTEGER;
 ALTER TABLE inventory_rma ADD COLUMN IF NOT EXISTS vendor_name VARCHAR(200);
 ALTER TABLE inventory_rma ADD COLUMN IF NOT EXISTS vendor_contact VARCHAR(100);
 ALTER TABLE inventory_rma ADD COLUMN IF NOT EXISTS status VARCHAR(20) DEFAULT 'pending'::character varying;
 ALTER TABLE inventory_rma ADD COLUMN IF NOT EXISTS shipped_date DATE;
 ALTER TABLE inventory_rma ADD COLUMN IF NOT EXISTS received_date DATE;
 ALTER TABLE inventory_rma ADD COLUMN IF NOT EXISTS resolution VARCHAR(50);
 ALTER TABLE inventory_rma ADD COLUMN IF NOT EXISTS resolution_notes TEXT;
 ALTER TABLE inventory_rma ADD COLUMN IF NOT EXISTS replacement_equipment_id INTEGER;
 ALTER TABLE inventory_rma ADD COLUMN IF NOT EXISTS created_by INTEGER;
 ALTER TABLE inventory_rma ADD COLUMN IF NOT EXISTS created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
 ALTER TABLE inventory_rma ADD COLUMN IF NOT EXISTS updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
 ALTER TABLE inventory_stock_levels ADD COLUMN IF NOT EXISTS category_id INTEGER;
 ALTER TABLE inventory_stock_levels ADD COLUMN IF NOT EXISTS warehouse_id INTEGER;
 ALTER TABLE inventory_stock_levels ADD COLUMN IF NOT EXISTS min_quantity INTEGER DEFAULT 0;
 ALTER TABLE inventory_stock_levels ADD COLUMN IF NOT EXISTS max_quantity INTEGER DEFAULT 100;
 ALTER TABLE inventory_stock_levels ADD COLUMN IF NOT EXISTS reorder_point INTEGER DEFAULT 10;
 ALTER TABLE inventory_stock_levels ADD COLUMN IF NOT EXISTS is_active BOOLEAN DEFAULT true;
 ALTER TABLE inventory_stock_levels ADD COLUMN IF NOT EXISTS created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
 ALTER TABLE inventory_stock_levels ADD COLUMN IF NOT EXISTS updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
 ALTER TABLE inventory_stock_movements ADD COLUMN IF NOT EXISTS equipment_id INTEGER;
 ALTER TABLE inventory_stock_movements ADD COLUMN IF NOT EXISTS movement_type VARCHAR(30);
 ALTER TABLE inventory_stock_movements ADD COLUMN IF NOT EXISTS from_location_id INTEGER;
 ALTER TABLE inventory_stock_movements ADD COLUMN IF NOT EXISTS to_location_id INTEGER;
 ALTER TABLE inventory_stock_movements ADD COLUMN IF NOT EXISTS from_warehouse_id INTEGER;
 ALTER TABLE inventory_stock_movements ADD COLUMN IF NOT EXISTS to_warehouse_id INTEGER;
 ALTER TABLE inventory_stock_movements ADD COLUMN IF NOT EXISTS quantity INTEGER DEFAULT 1;
 ALTER TABLE inventory_stock_movements ADD COLUMN IF NOT EXISTS reference_type VARCHAR(30);
 ALTER TABLE inventory_stock_movements ADD COLUMN IF NOT EXISTS reference_id INTEGER;
 ALTER TABLE inventory_stock_movements ADD COLUMN IF NOT EXISTS notes TEXT;
 ALTER TABLE inventory_stock_movements ADD COLUMN IF NOT EXISTS performed_by INTEGER;
 ALTER TABLE inventory_stock_movements ADD COLUMN IF NOT EXISTS created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
 ALTER TABLE inventory_stock_request_items ADD COLUMN IF NOT EXISTS request_id INTEGER;
 ALTER TABLE inventory_stock_request_items ADD COLUMN IF NOT EXISTS equipment_id INTEGER;
 ALTER TABLE inventory_stock_request_items ADD COLUMN IF NOT EXISTS category_id INTEGER;
 ALTER TABLE inventory_stock_request_items ADD COLUMN IF NOT EXISTS item_name VARCHAR(200);
 ALTER TABLE inventory_stock_request_items ADD COLUMN IF NOT EXISTS quantity_requested INTEGER DEFAULT 1;
 ALTER TABLE inventory_stock_request_items ADD COLUMN IF NOT EXISTS quantity_approved INTEGER DEFAULT 0;
 ALTER TABLE inventory_stock_request_items ADD COLUMN IF NOT EXISTS quantity_picked INTEGER DEFAULT 0;
 ALTER TABLE inventory_stock_request_items ADD COLUMN IF NOT EXISTS quantity_used INTEGER DEFAULT 0;
 ALTER TABLE inventory_stock_request_items ADD COLUMN IF NOT EXISTS quantity_returned INTEGER DEFAULT 0;
 ALTER TABLE inventory_stock_request_items ADD COLUMN IF NOT EXISTS notes TEXT;
 ALTER TABLE inventory_stock_request_items ADD COLUMN IF NOT EXISTS created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
 ALTER TABLE inventory_stock_requests ADD COLUMN IF NOT EXISTS request_number VARCHAR(30);
 ALTER TABLE inventory_stock_requests ADD COLUMN IF NOT EXISTS requested_by INTEGER;
 ALTER TABLE inventory_stock_requests ADD COLUMN IF NOT EXISTS warehouse_id INTEGER;
 ALTER TABLE inventory_stock_requests ADD COLUMN IF NOT EXISTS request_type VARCHAR(30) DEFAULT 'technician'::character varying;
 ALTER TABLE inventory_stock_requests ADD COLUMN IF NOT EXISTS ticket_id INTEGER;
 ALTER TABLE inventory_stock_requests ADD COLUMN IF NOT EXISTS customer_id INTEGER;
 ALTER TABLE inventory_stock_requests ADD COLUMN IF NOT EXISTS priority VARCHAR(20) DEFAULT 'normal'::character varying;
 ALTER TABLE inventory_stock_requests ADD COLUMN IF NOT EXISTS status VARCHAR(20) DEFAULT 'pending'::character varying;
 ALTER TABLE inventory_stock_requests ADD COLUMN IF NOT EXISTS required_date DATE;
 ALTER TABLE inventory_stock_requests ADD COLUMN IF NOT EXISTS notes TEXT;
 ALTER TABLE inventory_stock_requests ADD COLUMN IF NOT EXISTS approved_by INTEGER;
 ALTER TABLE inventory_stock_requests ADD COLUMN IF NOT EXISTS approved_at TIMESTAMP;
 ALTER TABLE inventory_stock_requests ADD COLUMN IF NOT EXISTS picked_by INTEGER;
 ALTER TABLE inventory_stock_requests ADD COLUMN IF NOT EXISTS picked_at TIMESTAMP;
 ALTER TABLE inventory_stock_requests ADD COLUMN IF NOT EXISTS handed_to INTEGER;
 ALTER TABLE inventory_stock_requests ADD COLUMN IF NOT EXISTS handover_at TIMESTAMP;
 ALTER TABLE inventory_stock_requests ADD COLUMN IF NOT EXISTS handover_signature TEXT;
 ALTER TABLE inventory_stock_requests ADD COLUMN IF NOT EXISTS created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
 ALTER TABLE inventory_stock_requests ADD COLUMN IF NOT EXISTS updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
 ALTER TABLE inventory_thresholds ADD COLUMN IF NOT EXISTS category_id INTEGER;
 ALTER TABLE inventory_thresholds ADD COLUMN IF NOT EXISTS warehouse_id INTEGER;
 ALTER TABLE inventory_thresholds ADD COLUMN IF NOT EXISTS min_quantity INTEGER DEFAULT 5;
 ALTER TABLE inventory_thresholds ADD COLUMN IF NOT EXISTS max_quantity INTEGER DEFAULT 100;
 ALTER TABLE inventory_thresholds ADD COLUMN IF NOT EXISTS reorder_point INTEGER DEFAULT 10;
 ALTER TABLE inventory_thresholds ADD COLUMN IF NOT EXISTS reorder_quantity INTEGER DEFAULT 20;
 ALTER TABLE inventory_thresholds ADD COLUMN IF NOT EXISTS notify_on_low BOOLEAN DEFAULT true;
 ALTER TABLE inventory_thresholds ADD COLUMN IF NOT EXISTS notify_on_excess BOOLEAN DEFAULT false;
 ALTER TABLE inventory_thresholds ADD COLUMN IF NOT EXISTS is_active BOOLEAN DEFAULT true;
 ALTER TABLE inventory_thresholds ADD COLUMN IF NOT EXISTS created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
 ALTER TABLE inventory_thresholds ADD COLUMN IF NOT EXISTS updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
 ALTER TABLE inventory_usage ADD COLUMN IF NOT EXISTS equipment_id INTEGER;
 ALTER TABLE inventory_usage ADD COLUMN IF NOT EXISTS request_item_id INTEGER;
 ALTER TABLE inventory_usage ADD COLUMN IF NOT EXISTS ticket_id INTEGER;
 ALTER TABLE inventory_usage ADD COLUMN IF NOT EXISTS customer_id INTEGER;
 ALTER TABLE inventory_usage ADD COLUMN IF NOT EXISTS employee_id INTEGER;
 ALTER TABLE inventory_usage ADD COLUMN IF NOT EXISTS job_type VARCHAR(50) DEFAULT 'installation'::character varying;
 ALTER TABLE inventory_usage ADD COLUMN IF NOT EXISTS quantity INTEGER DEFAULT 1;
 ALTER TABLE inventory_usage ADD COLUMN IF NOT EXISTS usage_date DATE;
 ALTER TABLE inventory_usage ADD COLUMN IF NOT EXISTS notes TEXT;
 ALTER TABLE inventory_usage ADD COLUMN IF NOT EXISTS recorded_by INTEGER;
 ALTER TABLE inventory_usage ADD COLUMN IF NOT EXISTS created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
 ALTER TABLE inventory_warehouses ADD COLUMN IF NOT EXISTS name VARCHAR(100);
 ALTER TABLE inventory_warehouses ADD COLUMN IF NOT EXISTS code VARCHAR(20);
 ALTER TABLE inventory_warehouses ADD COLUMN IF NOT EXISTS type VARCHAR(30) DEFAULT 'depot'::character varying;
 ALTER TABLE inventory_warehouses ADD COLUMN IF NOT EXISTS address TEXT;
 ALTER TABLE inventory_warehouses ADD COLUMN IF NOT EXISTS phone VARCHAR(20);
 ALTER TABLE inventory_warehouses ADD COLUMN IF NOT EXISTS manager_id INTEGER;
 ALTER TABLE inventory_warehouses ADD COLUMN IF NOT EXISTS is_active BOOLEAN DEFAULT true;
 ALTER TABLE inventory_warehouses ADD COLUMN IF NOT EXISTS notes TEXT;
 ALTER TABLE inventory_warehouses ADD COLUMN IF NOT EXISTS created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
 ALTER TABLE inventory_warehouses ADD COLUMN IF NOT EXISTS updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
 ALTER TABLE invoice_items ADD COLUMN IF NOT EXISTS invoice_id INTEGER;
 ALTER TABLE invoice_items ADD COLUMN IF NOT EXISTS product_id INTEGER;
 ALTER TABLE invoice_items ADD COLUMN IF NOT EXISTS description TEXT;
 ALTER TABLE invoice_items ADD COLUMN IF NOT EXISTS quantity NUMERIC DEFAULT 1;
 ALTER TABLE invoice_items ADD COLUMN IF NOT EXISTS unit_price NUMERIC;
 ALTER TABLE invoice_items ADD COLUMN IF NOT EXISTS tax_rate_id INTEGER;
 ALTER TABLE invoice_items ADD COLUMN IF NOT EXISTS tax_amount NUMERIC DEFAULT 0;
 ALTER TABLE invoice_items ADD COLUMN IF NOT EXISTS discount_percent NUMERIC DEFAULT 0;
 ALTER TABLE invoice_items ADD COLUMN IF NOT EXISTS line_total NUMERIC;
 ALTER TABLE invoice_items ADD COLUMN IF NOT EXISTS sort_order INTEGER DEFAULT 0;
 ALTER TABLE invoices ADD COLUMN IF NOT EXISTS invoice_number VARCHAR(50);
 ALTER TABLE invoices ADD COLUMN IF NOT EXISTS customer_id INTEGER;
 ALTER TABLE invoices ADD COLUMN IF NOT EXISTS order_id INTEGER;
 ALTER TABLE invoices ADD COLUMN IF NOT EXISTS ticket_id INTEGER;
 ALTER TABLE invoices ADD COLUMN IF NOT EXISTS issue_date DATE DEFAULT CURRENT_DATE;
 ALTER TABLE invoices ADD COLUMN IF NOT EXISTS due_date DATE;
 ALTER TABLE invoices ADD COLUMN IF NOT EXISTS status VARCHAR(20) DEFAULT 'draft'::character varying;
 ALTER TABLE invoices ADD COLUMN IF NOT EXISTS subtotal NUMERIC DEFAULT 0;
 ALTER TABLE invoices ADD COLUMN IF NOT EXISTS tax_amount NUMERIC DEFAULT 0;
 ALTER TABLE invoices ADD COLUMN IF NOT EXISTS discount_amount NUMERIC DEFAULT 0;
 ALTER TABLE invoices ADD COLUMN IF NOT EXISTS total_amount NUMERIC DEFAULT 0;
 ALTER TABLE invoices ADD COLUMN IF NOT EXISTS amount_paid NUMERIC DEFAULT 0;
 ALTER TABLE invoices ADD COLUMN IF NOT EXISTS balance_due NUMERIC DEFAULT 0;
 ALTER TABLE invoices ADD COLUMN IF NOT EXISTS currency VARCHAR(10) DEFAULT 'KES'::character varying;
 ALTER TABLE invoices ADD COLUMN IF NOT EXISTS notes TEXT;
 ALTER TABLE invoices ADD COLUMN IF NOT EXISTS terms TEXT;
 ALTER TABLE invoices ADD COLUMN IF NOT EXISTS is_recurring BOOLEAN DEFAULT false;
 ALTER TABLE invoices ADD COLUMN IF NOT EXISTS recurring_interval VARCHAR(20);
 ALTER TABLE invoices ADD COLUMN IF NOT EXISTS next_recurring_date DATE;
 ALTER TABLE invoices ADD COLUMN IF NOT EXISTS created_by INTEGER;
 ALTER TABLE invoices ADD COLUMN IF NOT EXISTS created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
 ALTER TABLE invoices ADD COLUMN IF NOT EXISTS updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
 ALTER TABLE late_rules ADD COLUMN IF NOT EXISTS name VARCHAR(100);
 ALTER TABLE late_rules ADD COLUMN IF NOT EXISTS work_start_time TIME WITHOUT TIME ZONE DEFAULT '09:00:00'::time without time zone;
 ALTER TABLE late_rules ADD COLUMN IF NOT EXISTS grace_minutes INTEGER DEFAULT 15;
 ALTER TABLE late_rules ADD COLUMN IF NOT EXISTS deduction_tiers JSONB DEFAULT '[]'::jsonb;
 ALTER TABLE late_rules ADD COLUMN IF NOT EXISTS currency VARCHAR(10) DEFAULT 'KES'::character varying;
 ALTER TABLE late_rules ADD COLUMN IF NOT EXISTS apply_to_department_id INTEGER;
 ALTER TABLE late_rules ADD COLUMN IF NOT EXISTS is_default BOOLEAN DEFAULT false;
 ALTER TABLE late_rules ADD COLUMN IF NOT EXISTS is_active BOOLEAN DEFAULT true;
 ALTER TABLE late_rules ADD COLUMN IF NOT EXISTS created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
 ALTER TABLE late_rules ADD COLUMN IF NOT EXISTS updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
 ALTER TABLE leave_balances ADD COLUMN IF NOT EXISTS employee_id INTEGER;
 ALTER TABLE leave_balances ADD COLUMN IF NOT EXISTS leave_type_id INTEGER;
 ALTER TABLE leave_balances ADD COLUMN IF NOT EXISTS year INTEGER;
 ALTER TABLE leave_balances ADD COLUMN IF NOT EXISTS entitled_days NUMERIC DEFAULT 0;
 ALTER TABLE leave_balances ADD COLUMN IF NOT EXISTS used_days NUMERIC DEFAULT 0;
 ALTER TABLE leave_balances ADD COLUMN IF NOT EXISTS carried_over NUMERIC DEFAULT 0;
 ALTER TABLE leave_balances ADD COLUMN IF NOT EXISTS accrued_days NUMERIC DEFAULT 0;
 ALTER TABLE leave_balances ADD COLUMN IF NOT EXISTS created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
 ALTER TABLE leave_balances ADD COLUMN IF NOT EXISTS updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
 ALTER TABLE leave_balances ADD COLUMN IF NOT EXISTS pending_days NUMERIC DEFAULT 0;
 ALTER TABLE leave_balances ADD COLUMN IF NOT EXISTS carried_over_days NUMERIC DEFAULT 0;
 ALTER TABLE leave_balances ADD COLUMN IF NOT EXISTS adjusted_days NUMERIC DEFAULT 0;
 ALTER TABLE leave_calendar ADD COLUMN IF NOT EXISTS date DATE;
 ALTER TABLE leave_calendar ADD COLUMN IF NOT EXISTS name VARCHAR(255);
 ALTER TABLE leave_calendar ADD COLUMN IF NOT EXISTS is_public_holiday BOOLEAN DEFAULT false;
 ALTER TABLE leave_calendar ADD COLUMN IF NOT EXISTS branch_id INTEGER;
 ALTER TABLE leave_calendar ADD COLUMN IF NOT EXISTS created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
 ALTER TABLE leave_requests ADD COLUMN IF NOT EXISTS employee_id INTEGER;
 ALTER TABLE leave_requests ADD COLUMN IF NOT EXISTS leave_type_id INTEGER;
 ALTER TABLE leave_requests ADD COLUMN IF NOT EXISTS start_date DATE;
 ALTER TABLE leave_requests ADD COLUMN IF NOT EXISTS end_date DATE;
 ALTER TABLE leave_requests ADD COLUMN IF NOT EXISTS days_requested NUMERIC;
 ALTER TABLE leave_requests ADD COLUMN IF NOT EXISTS reason TEXT;
 ALTER TABLE leave_requests ADD COLUMN IF NOT EXISTS status VARCHAR(20) DEFAULT 'pending'::character varying;
 ALTER TABLE leave_requests ADD COLUMN IF NOT EXISTS approved_by INTEGER;
 ALTER TABLE leave_requests ADD COLUMN IF NOT EXISTS approved_at TIMESTAMP;
 ALTER TABLE leave_requests ADD COLUMN IF NOT EXISTS rejection_reason TEXT;
 ALTER TABLE leave_requests ADD COLUMN IF NOT EXISTS created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
 ALTER TABLE leave_requests ADD COLUMN IF NOT EXISTS updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
 ALTER TABLE leave_types ADD COLUMN IF NOT EXISTS name VARCHAR(50);
 ALTER TABLE leave_types ADD COLUMN IF NOT EXISTS code VARCHAR(20);
 ALTER TABLE leave_types ADD COLUMN IF NOT EXISTS days_per_year INTEGER DEFAULT 0;
 ALTER TABLE leave_types ADD COLUMN IF NOT EXISTS is_paid BOOLEAN DEFAULT true;
 ALTER TABLE leave_types ADD COLUMN IF NOT EXISTS requires_approval BOOLEAN DEFAULT true;
 ALTER TABLE leave_types ADD COLUMN IF NOT EXISTS is_active BOOLEAN DEFAULT true;
 ALTER TABLE leave_types ADD COLUMN IF NOT EXISTS created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
 ALTER TABLE mobile_notifications ADD COLUMN IF NOT EXISTS user_id INTEGER;
 ALTER TABLE mobile_notifications ADD COLUMN IF NOT EXISTS type VARCHAR(50);
 ALTER TABLE mobile_notifications ADD COLUMN IF NOT EXISTS title VARCHAR(255);
 ALTER TABLE mobile_notifications ADD COLUMN IF NOT EXISTS message TEXT;
 ALTER TABLE mobile_notifications ADD COLUMN IF NOT EXISTS data JSONB DEFAULT '{}'::jsonb;
 ALTER TABLE mobile_notifications ADD COLUMN IF NOT EXISTS is_read BOOLEAN DEFAULT false;
 ALTER TABLE mobile_notifications ADD COLUMN IF NOT EXISTS created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
 ALTER TABLE mobile_tokens ADD COLUMN IF NOT EXISTS user_id INTEGER;
 ALTER TABLE mobile_tokens ADD COLUMN IF NOT EXISTS token VARCHAR(64);
 ALTER TABLE mobile_tokens ADD COLUMN IF NOT EXISTS expires_at TIMESTAMP;
 ALTER TABLE mobile_tokens ADD COLUMN IF NOT EXISTS created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
 ALTER TABLE mpesa_b2b_transactions ADD COLUMN IF NOT EXISTS request_id VARCHAR(100);
 ALTER TABLE mpesa_b2b_transactions ADD COLUMN IF NOT EXISTS conversation_id VARCHAR(100);
 ALTER TABLE mpesa_b2b_transactions ADD COLUMN IF NOT EXISTS originator_conversation_id VARCHAR(100);
 ALTER TABLE mpesa_b2b_transactions ADD COLUMN IF NOT EXISTS sender_shortcode VARCHAR(20);
 ALTER TABLE mpesa_b2b_transactions ADD COLUMN IF NOT EXISTS receiver_shortcode VARCHAR(20);
 ALTER TABLE mpesa_b2b_transactions ADD COLUMN IF NOT EXISTS receiver_type VARCHAR(20) DEFAULT 'paybill'::character varying;
 ALTER TABLE mpesa_b2b_transactions ADD COLUMN IF NOT EXISTS amount NUMERIC;
 ALTER TABLE mpesa_b2b_transactions ADD COLUMN IF NOT EXISTS currency VARCHAR(3) DEFAULT 'KES'::character varying;
 ALTER TABLE mpesa_b2b_transactions ADD COLUMN IF NOT EXISTS command_id VARCHAR(50) DEFAULT 'BusinessPayBill'::character varying;
 ALTER TABLE mpesa_b2b_transactions ADD COLUMN IF NOT EXISTS account_reference VARCHAR(100);
 ALTER TABLE mpesa_b2b_transactions ADD COLUMN IF NOT EXISTS remarks TEXT;
 ALTER TABLE mpesa_b2b_transactions ADD COLUMN IF NOT EXISTS status VARCHAR(20) DEFAULT 'pending'::character varying;
 ALTER TABLE mpesa_b2b_transactions ADD COLUMN IF NOT EXISTS result_code VARCHAR(10);
 ALTER TABLE mpesa_b2b_transactions ADD COLUMN IF NOT EXISTS result_desc TEXT;
 ALTER TABLE mpesa_b2b_transactions ADD COLUMN IF NOT EXISTS transaction_id VARCHAR(50);
 ALTER TABLE mpesa_b2b_transactions ADD COLUMN IF NOT EXISTS debit_party_name VARCHAR(200);
 ALTER TABLE mpesa_b2b_transactions ADD COLUMN IF NOT EXISTS credit_party_name VARCHAR(200);
 ALTER TABLE mpesa_b2b_transactions ADD COLUMN IF NOT EXISTS linked_type VARCHAR(50);
 ALTER TABLE mpesa_b2b_transactions ADD COLUMN IF NOT EXISTS linked_id INTEGER;
 ALTER TABLE mpesa_b2b_transactions ADD COLUMN IF NOT EXISTS callback_payload JSONB;
 ALTER TABLE mpesa_b2b_transactions ADD COLUMN IF NOT EXISTS initiated_by INTEGER;
 ALTER TABLE mpesa_b2b_transactions ADD COLUMN IF NOT EXISTS created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
 ALTER TABLE mpesa_b2b_transactions ADD COLUMN IF NOT EXISTS updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
 ALTER TABLE mpesa_b2b_transactions ADD COLUMN IF NOT EXISTS completed_at TIMESTAMP;
 ALTER TABLE mpesa_b2c_transactions ADD COLUMN IF NOT EXISTS request_id VARCHAR(100);
 ALTER TABLE mpesa_b2c_transactions ADD COLUMN IF NOT EXISTS conversation_id VARCHAR(100);
 ALTER TABLE mpesa_b2c_transactions ADD COLUMN IF NOT EXISTS originator_conversation_id VARCHAR(100);
 ALTER TABLE mpesa_b2c_transactions ADD COLUMN IF NOT EXISTS shortcode VARCHAR(20);
 ALTER TABLE mpesa_b2c_transactions ADD COLUMN IF NOT EXISTS initiator_name VARCHAR(100);
 ALTER TABLE mpesa_b2c_transactions ADD COLUMN IF NOT EXISTS phone VARCHAR(20);
 ALTER TABLE mpesa_b2c_transactions ADD COLUMN IF NOT EXISTS amount NUMERIC;
 ALTER TABLE mpesa_b2c_transactions ADD COLUMN IF NOT EXISTS currency VARCHAR(3) DEFAULT 'KES'::character varying;
 ALTER TABLE mpesa_b2c_transactions ADD COLUMN IF NOT EXISTS command_id VARCHAR(50) DEFAULT 'BusinessPayment'::character varying;
 ALTER TABLE mpesa_b2c_transactions ADD COLUMN IF NOT EXISTS purpose VARCHAR(50);
 ALTER TABLE mpesa_b2c_transactions ADD COLUMN IF NOT EXISTS remarks TEXT;
 ALTER TABLE mpesa_b2c_transactions ADD COLUMN IF NOT EXISTS occasion VARCHAR(100);
 ALTER TABLE mpesa_b2c_transactions ADD COLUMN IF NOT EXISTS status VARCHAR(20) DEFAULT 'pending'::character varying;
 ALTER TABLE mpesa_b2c_transactions ADD COLUMN IF NOT EXISTS result_code VARCHAR(10);
 ALTER TABLE mpesa_b2c_transactions ADD COLUMN IF NOT EXISTS result_desc TEXT;
 ALTER TABLE mpesa_b2c_transactions ADD COLUMN IF NOT EXISTS transaction_id VARCHAR(50);
 ALTER TABLE mpesa_b2c_transactions ADD COLUMN IF NOT EXISTS transaction_receipt VARCHAR(100);
 ALTER TABLE mpesa_b2c_transactions ADD COLUMN IF NOT EXISTS receiver_party_public_name VARCHAR(200);
 ALTER TABLE mpesa_b2c_transactions ADD COLUMN IF NOT EXISTS b2c_utility_account_balance NUMERIC;
 ALTER TABLE mpesa_b2c_transactions ADD COLUMN IF NOT EXISTS b2c_working_account_balance NUMERIC;
 ALTER TABLE mpesa_b2c_transactions ADD COLUMN IF NOT EXISTS linked_type VARCHAR(50);
 ALTER TABLE mpesa_b2c_transactions ADD COLUMN IF NOT EXISTS linked_id INTEGER;
 ALTER TABLE mpesa_b2c_transactions ADD COLUMN IF NOT EXISTS callback_payload JSONB;
 ALTER TABLE mpesa_b2c_transactions ADD COLUMN IF NOT EXISTS initiated_by INTEGER;
 ALTER TABLE mpesa_b2c_transactions ADD COLUMN IF NOT EXISTS created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
 ALTER TABLE mpesa_b2c_transactions ADD COLUMN IF NOT EXISTS updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
 ALTER TABLE mpesa_b2c_transactions ADD COLUMN IF NOT EXISTS completed_at TIMESTAMP;
 ALTER TABLE mpesa_c2b_transactions ADD COLUMN IF NOT EXISTS transaction_type VARCHAR(20);
 ALTER TABLE mpesa_c2b_transactions ADD COLUMN IF NOT EXISTS trans_id VARCHAR(50);
 ALTER TABLE mpesa_c2b_transactions ADD COLUMN IF NOT EXISTS trans_time TIMESTAMP;
 ALTER TABLE mpesa_c2b_transactions ADD COLUMN IF NOT EXISTS trans_amount NUMERIC;
 ALTER TABLE mpesa_c2b_transactions ADD COLUMN IF NOT EXISTS business_short_code VARCHAR(20);
 ALTER TABLE mpesa_c2b_transactions ADD COLUMN IF NOT EXISTS bill_ref_number VARCHAR(100);
 ALTER TABLE mpesa_c2b_transactions ADD COLUMN IF NOT EXISTS invoice_number VARCHAR(100);
 ALTER TABLE mpesa_c2b_transactions ADD COLUMN IF NOT EXISTS org_account_balance NUMERIC;
 ALTER TABLE mpesa_c2b_transactions ADD COLUMN IF NOT EXISTS third_party_trans_id VARCHAR(100);
 ALTER TABLE mpesa_c2b_transactions ADD COLUMN IF NOT EXISTS msisdn VARCHAR(20);
 ALTER TABLE mpesa_c2b_transactions ADD COLUMN IF NOT EXISTS first_name VARCHAR(100);
 ALTER TABLE mpesa_c2b_transactions ADD COLUMN IF NOT EXISTS middle_name VARCHAR(100);
 ALTER TABLE mpesa_c2b_transactions ADD COLUMN IF NOT EXISTS last_name VARCHAR(100);
 ALTER TABLE mpesa_c2b_transactions ADD COLUMN IF NOT EXISTS customer_id INTEGER;
 ALTER TABLE mpesa_c2b_transactions ADD COLUMN IF NOT EXISTS status VARCHAR(20) DEFAULT 'received'::character varying;
 ALTER TABLE mpesa_c2b_transactions ADD COLUMN IF NOT EXISTS raw_data JSONB;
 ALTER TABLE mpesa_c2b_transactions ADD COLUMN IF NOT EXISTS created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
 ALTER TABLE mpesa_config ADD COLUMN IF NOT EXISTS config_key VARCHAR(50);
 ALTER TABLE mpesa_config ADD COLUMN IF NOT EXISTS config_value TEXT;
 ALTER TABLE mpesa_config ADD COLUMN IF NOT EXISTS is_encrypted BOOLEAN DEFAULT false;
 ALTER TABLE mpesa_config ADD COLUMN IF NOT EXISTS created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
 ALTER TABLE mpesa_config ADD COLUMN IF NOT EXISTS updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
 ALTER TABLE mpesa_transactions ADD COLUMN IF NOT EXISTS transaction_type VARCHAR(20);
 ALTER TABLE mpesa_transactions ADD COLUMN IF NOT EXISTS merchant_request_id VARCHAR(100);
 ALTER TABLE mpesa_transactions ADD COLUMN IF NOT EXISTS checkout_request_id VARCHAR(100);
 ALTER TABLE mpesa_transactions ADD COLUMN IF NOT EXISTS result_code INTEGER;
 ALTER TABLE mpesa_transactions ADD COLUMN IF NOT EXISTS result_desc TEXT;
 ALTER TABLE mpesa_transactions ADD COLUMN IF NOT EXISTS mpesa_receipt_number VARCHAR(50);
 ALTER TABLE mpesa_transactions ADD COLUMN IF NOT EXISTS transaction_date TIMESTAMP;
 ALTER TABLE mpesa_transactions ADD COLUMN IF NOT EXISTS phone_number VARCHAR(20);
 ALTER TABLE mpesa_transactions ADD COLUMN IF NOT EXISTS amount NUMERIC;
 ALTER TABLE mpesa_transactions ADD COLUMN IF NOT EXISTS account_reference VARCHAR(100);
 ALTER TABLE mpesa_transactions ADD COLUMN IF NOT EXISTS transaction_desc TEXT;
 ALTER TABLE mpesa_transactions ADD COLUMN IF NOT EXISTS customer_id INTEGER;
 ALTER TABLE mpesa_transactions ADD COLUMN IF NOT EXISTS invoice_id INTEGER;
 ALTER TABLE mpesa_transactions ADD COLUMN IF NOT EXISTS status VARCHAR(20) DEFAULT 'pending'::character varying;
 ALTER TABLE mpesa_transactions ADD COLUMN IF NOT EXISTS raw_callback JSONB;
 ALTER TABLE mpesa_transactions ADD COLUMN IF NOT EXISTS created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
 ALTER TABLE mpesa_transactions ADD COLUMN IF NOT EXISTS updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
 ALTER TABLE network_devices ADD COLUMN IF NOT EXISTS name VARCHAR(100);
 ALTER TABLE network_devices ADD COLUMN IF NOT EXISTS device_type VARCHAR(50) DEFAULT 'olt'::character varying;
 ALTER TABLE network_devices ADD COLUMN IF NOT EXISTS vendor VARCHAR(50);
 ALTER TABLE network_devices ADD COLUMN IF NOT EXISTS model VARCHAR(100);
 ALTER TABLE network_devices ADD COLUMN IF NOT EXISTS ip_address VARCHAR(45);
 ALTER TABLE network_devices ADD COLUMN IF NOT EXISTS snmp_version VARCHAR(10) DEFAULT 'v2c'::character varying;
 ALTER TABLE network_devices ADD COLUMN IF NOT EXISTS snmp_community VARCHAR(100) DEFAULT 'public'::character varying;
 ALTER TABLE network_devices ADD COLUMN IF NOT EXISTS snmp_port INTEGER DEFAULT 161;
 ALTER TABLE network_devices ADD COLUMN IF NOT EXISTS snmpv3_username VARCHAR(100);
 ALTER TABLE network_devices ADD COLUMN IF NOT EXISTS snmpv3_auth_protocol VARCHAR(20);
 ALTER TABLE network_devices ADD COLUMN IF NOT EXISTS snmpv3_auth_password VARCHAR(255);
 ALTER TABLE network_devices ADD COLUMN IF NOT EXISTS snmpv3_priv_protocol VARCHAR(20);
 ALTER TABLE network_devices ADD COLUMN IF NOT EXISTS snmpv3_priv_password VARCHAR(255);
 ALTER TABLE network_devices ADD COLUMN IF NOT EXISTS telnet_username VARCHAR(100);
 ALTER TABLE network_devices ADD COLUMN IF NOT EXISTS telnet_password VARCHAR(255);
 ALTER TABLE network_devices ADD COLUMN IF NOT EXISTS telnet_port INTEGER DEFAULT 23;
 ALTER TABLE network_devices ADD COLUMN IF NOT EXISTS ssh_enabled BOOLEAN DEFAULT false;
 ALTER TABLE network_devices ADD COLUMN IF NOT EXISTS ssh_port INTEGER DEFAULT 22;
 ALTER TABLE network_devices ADD COLUMN IF NOT EXISTS location VARCHAR(255);
 ALTER TABLE network_devices ADD COLUMN IF NOT EXISTS status VARCHAR(20) DEFAULT 'unknown'::character varying;
 ALTER TABLE network_devices ADD COLUMN IF NOT EXISTS last_polled TIMESTAMP;
 ALTER TABLE network_devices ADD COLUMN IF NOT EXISTS poll_interval INTEGER DEFAULT 300;
 ALTER TABLE network_devices ADD COLUMN IF NOT EXISTS enabled BOOLEAN DEFAULT true;
 ALTER TABLE network_devices ADD COLUMN IF NOT EXISTS notes TEXT;
 ALTER TABLE network_devices ADD COLUMN IF NOT EXISTS created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
 ALTER TABLE network_devices ADD COLUMN IF NOT EXISTS updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
 ALTER TABLE onu_discovery_log ADD COLUMN IF NOT EXISTS olt_id INTEGER;
 ALTER TABLE onu_discovery_log ADD COLUMN IF NOT EXISTS serial_number VARCHAR(32);
 ALTER TABLE onu_discovery_log ADD COLUMN IF NOT EXISTS frame_slot_port VARCHAR(32);
 ALTER TABLE onu_discovery_log ADD COLUMN IF NOT EXISTS first_seen_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
 ALTER TABLE onu_discovery_log ADD COLUMN IF NOT EXISTS last_seen_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
 ALTER TABLE onu_discovery_log ADD COLUMN IF NOT EXISTS notified BOOLEAN DEFAULT false;
 ALTER TABLE onu_discovery_log ADD COLUMN IF NOT EXISTS notified_at TIMESTAMP;
 ALTER TABLE onu_discovery_log ADD COLUMN IF NOT EXISTS authorized BOOLEAN DEFAULT false;
 ALTER TABLE onu_discovery_log ADD COLUMN IF NOT EXISTS authorized_at TIMESTAMP;
 ALTER TABLE onu_discovery_log ADD COLUMN IF NOT EXISTS onu_type_id INTEGER;
 ALTER TABLE onu_discovery_log ADD COLUMN IF NOT EXISTS equipment_id VARCHAR(100);
 ALTER TABLE onu_signal_history ADD COLUMN IF NOT EXISTS onu_id INTEGER;
 ALTER TABLE onu_signal_history ADD COLUMN IF NOT EXISTS rx_power NUMERIC;
 ALTER TABLE onu_signal_history ADD COLUMN IF NOT EXISTS tx_power NUMERIC;
 ALTER TABLE onu_signal_history ADD COLUMN IF NOT EXISTS status VARCHAR(20);
 ALTER TABLE onu_signal_history ADD COLUMN IF NOT EXISTS recorded_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
 ALTER TABLE onu_uptime_log ADD COLUMN IF NOT EXISTS onu_id INTEGER;
 ALTER TABLE onu_uptime_log ADD COLUMN IF NOT EXISTS status VARCHAR(20);
 ALTER TABLE onu_uptime_log ADD COLUMN IF NOT EXISTS started_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
 ALTER TABLE onu_uptime_log ADD COLUMN IF NOT EXISTS ended_at TIMESTAMP;
 ALTER TABLE onu_uptime_log ADD COLUMN IF NOT EXISTS duration_seconds INTEGER;
 ALTER TABLE orders ADD COLUMN IF NOT EXISTS order_number VARCHAR(20);
 ALTER TABLE orders ADD COLUMN IF NOT EXISTS package_id INTEGER;
 ALTER TABLE orders ADD COLUMN IF NOT EXISTS customer_name VARCHAR(100);
 ALTER TABLE orders ADD COLUMN IF NOT EXISTS customer_email VARCHAR(100);
 ALTER TABLE orders ADD COLUMN IF NOT EXISTS customer_phone VARCHAR(20);
 ALTER TABLE orders ADD COLUMN IF NOT EXISTS customer_address TEXT;
 ALTER TABLE orders ADD COLUMN IF NOT EXISTS customer_id INTEGER;
 ALTER TABLE orders ADD COLUMN IF NOT EXISTS payment_status VARCHAR(20) DEFAULT 'pending'::character varying;
 ALTER TABLE orders ADD COLUMN IF NOT EXISTS payment_method VARCHAR(20);
 ALTER TABLE orders ADD COLUMN IF NOT EXISTS mpesa_transaction_id INTEGER;
 ALTER TABLE orders ADD COLUMN IF NOT EXISTS amount NUMERIC;
 ALTER TABLE orders ADD COLUMN IF NOT EXISTS order_status VARCHAR(20) DEFAULT 'new'::character varying;
 ALTER TABLE orders ADD COLUMN IF NOT EXISTS notes TEXT;
 ALTER TABLE orders ADD COLUMN IF NOT EXISTS ticket_id INTEGER;
 ALTER TABLE orders ADD COLUMN IF NOT EXISTS created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
 ALTER TABLE orders ADD COLUMN IF NOT EXISTS updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
 ALTER TABLE orders ADD COLUMN IF NOT EXISTS salesperson_id INTEGER;
 ALTER TABLE orders ADD COLUMN IF NOT EXISTS commission_paid BOOLEAN DEFAULT false;
 ALTER TABLE orders ADD COLUMN IF NOT EXISTS lead_source VARCHAR(50) DEFAULT 'web'::character varying;
 ALTER TABLE orders ADD COLUMN IF NOT EXISTS created_by INTEGER;
 ALTER TABLE payroll ADD COLUMN IF NOT EXISTS employee_id INTEGER;
 ALTER TABLE payroll ADD COLUMN IF NOT EXISTS pay_period_start DATE;
 ALTER TABLE payroll ADD COLUMN IF NOT EXISTS pay_period_end DATE;
 ALTER TABLE payroll ADD COLUMN IF NOT EXISTS base_salary NUMERIC;
 ALTER TABLE payroll ADD COLUMN IF NOT EXISTS overtime_pay NUMERIC DEFAULT 0;
 ALTER TABLE payroll ADD COLUMN IF NOT EXISTS bonuses NUMERIC DEFAULT 0;
 ALTER TABLE payroll ADD COLUMN IF NOT EXISTS deductions NUMERIC DEFAULT 0;
 ALTER TABLE payroll ADD COLUMN IF NOT EXISTS tax NUMERIC DEFAULT 0;
 ALTER TABLE payroll ADD COLUMN IF NOT EXISTS net_pay NUMERIC;
 ALTER TABLE payroll ADD COLUMN IF NOT EXISTS status VARCHAR(20) DEFAULT 'pending'::character varying;
 ALTER TABLE payroll ADD COLUMN IF NOT EXISTS payment_date DATE;
 ALTER TABLE payroll ADD COLUMN IF NOT EXISTS payment_method VARCHAR(50);
 ALTER TABLE payroll ADD COLUMN IF NOT EXISTS notes TEXT;
 ALTER TABLE payroll ADD COLUMN IF NOT EXISTS created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
 ALTER TABLE payroll ADD COLUMN IF NOT EXISTS updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
 ALTER TABLE payroll ADD COLUMN IF NOT EXISTS allowances NUMERIC DEFAULT 0;
 ALTER TABLE payroll_commissions ADD COLUMN IF NOT EXISTS payroll_id INTEGER;
 ALTER TABLE payroll_commissions ADD COLUMN IF NOT EXISTS employee_id INTEGER;
 ALTER TABLE payroll_commissions ADD COLUMN IF NOT EXISTS commission_type VARCHAR(50) DEFAULT 'ticket'::character varying;
 ALTER TABLE payroll_commissions ADD COLUMN IF NOT EXISTS description TEXT;
 ALTER TABLE payroll_commissions ADD COLUMN IF NOT EXISTS amount NUMERIC;
 ALTER TABLE payroll_commissions ADD COLUMN IF NOT EXISTS details JSONB;
 ALTER TABLE payroll_commissions ADD COLUMN IF NOT EXISTS created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
 ALTER TABLE performance_reviews ADD COLUMN IF NOT EXISTS employee_id INTEGER;
 ALTER TABLE performance_reviews ADD COLUMN IF NOT EXISTS reviewer_id INTEGER;
 ALTER TABLE performance_reviews ADD COLUMN IF NOT EXISTS review_period_start DATE;
 ALTER TABLE performance_reviews ADD COLUMN IF NOT EXISTS review_period_end DATE;
 ALTER TABLE performance_reviews ADD COLUMN IF NOT EXISTS overall_rating INTEGER;
 ALTER TABLE performance_reviews ADD COLUMN IF NOT EXISTS productivity_rating INTEGER;
 ALTER TABLE performance_reviews ADD COLUMN IF NOT EXISTS quality_rating INTEGER;
 ALTER TABLE performance_reviews ADD COLUMN IF NOT EXISTS teamwork_rating INTEGER;
 ALTER TABLE performance_reviews ADD COLUMN IF NOT EXISTS communication_rating INTEGER;
 ALTER TABLE performance_reviews ADD COLUMN IF NOT EXISTS goals_achieved TEXT;
 ALTER TABLE performance_reviews ADD COLUMN IF NOT EXISTS strengths TEXT;
 ALTER TABLE performance_reviews ADD COLUMN IF NOT EXISTS areas_for_improvement TEXT;
 ALTER TABLE performance_reviews ADD COLUMN IF NOT EXISTS goals_next_period TEXT;
 ALTER TABLE performance_reviews ADD COLUMN IF NOT EXISTS comments TEXT;
 ALTER TABLE performance_reviews ADD COLUMN IF NOT EXISTS status VARCHAR(20) DEFAULT 'draft'::character varying;
 ALTER TABLE performance_reviews ADD COLUMN IF NOT EXISTS created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
 ALTER TABLE performance_reviews ADD COLUMN IF NOT EXISTS updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
 ALTER TABLE permissions ADD COLUMN IF NOT EXISTS name VARCHAR(100);
 ALTER TABLE permissions ADD COLUMN IF NOT EXISTS display_name VARCHAR(150);
 ALTER TABLE permissions ADD COLUMN IF NOT EXISTS category VARCHAR(50);
 ALTER TABLE permissions ADD COLUMN IF NOT EXISTS description TEXT;
 ALTER TABLE permissions ADD COLUMN IF NOT EXISTS created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
 ALTER TABLE products_services ADD COLUMN IF NOT EXISTS code VARCHAR(50);
 ALTER TABLE products_services ADD COLUMN IF NOT EXISTS name VARCHAR(200);
 ALTER TABLE products_services ADD COLUMN IF NOT EXISTS description TEXT;
 ALTER TABLE products_services ADD COLUMN IF NOT EXISTS type VARCHAR(20) DEFAULT 'service'::character varying;
 ALTER TABLE products_services ADD COLUMN IF NOT EXISTS unit_price NUMERIC DEFAULT 0;
 ALTER TABLE products_services ADD COLUMN IF NOT EXISTS cost_price NUMERIC DEFAULT 0;
 ALTER TABLE products_services ADD COLUMN IF NOT EXISTS tax_rate_id INTEGER;
 ALTER TABLE products_services ADD COLUMN IF NOT EXISTS income_account_id INTEGER;
 ALTER TABLE products_services ADD COLUMN IF NOT EXISTS expense_account_id INTEGER;
 ALTER TABLE products_services ADD COLUMN IF NOT EXISTS is_active BOOLEAN DEFAULT true;
 ALTER TABLE products_services ADD COLUMN IF NOT EXISTS created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
 ALTER TABLE public_holidays ADD COLUMN IF NOT EXISTS name VARCHAR(100);
 ALTER TABLE public_holidays ADD COLUMN IF NOT EXISTS holiday_date DATE;
 ALTER TABLE public_holidays ADD COLUMN IF NOT EXISTS is_recurring BOOLEAN DEFAULT false;
 ALTER TABLE public_holidays ADD COLUMN IF NOT EXISTS created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
 ALTER TABLE purchase_order_items ADD COLUMN IF NOT EXISTS purchase_order_id INTEGER;
 ALTER TABLE purchase_order_items ADD COLUMN IF NOT EXISTS product_id INTEGER;
 ALTER TABLE purchase_order_items ADD COLUMN IF NOT EXISTS equipment_id INTEGER;
 ALTER TABLE purchase_order_items ADD COLUMN IF NOT EXISTS description TEXT;
 ALTER TABLE purchase_order_items ADD COLUMN IF NOT EXISTS quantity NUMERIC DEFAULT 1;
 ALTER TABLE purchase_order_items ADD COLUMN IF NOT EXISTS received_quantity NUMERIC DEFAULT 0;
 ALTER TABLE purchase_order_items ADD COLUMN IF NOT EXISTS unit_price NUMERIC;
 ALTER TABLE purchase_order_items ADD COLUMN IF NOT EXISTS tax_rate_id INTEGER;
 ALTER TABLE purchase_order_items ADD COLUMN IF NOT EXISTS tax_amount NUMERIC DEFAULT 0;
 ALTER TABLE purchase_order_items ADD COLUMN IF NOT EXISTS line_total NUMERIC;
 ALTER TABLE purchase_order_items ADD COLUMN IF NOT EXISTS sort_order INTEGER DEFAULT 0;
 ALTER TABLE purchase_orders ADD COLUMN IF NOT EXISTS po_number VARCHAR(50);
 ALTER TABLE purchase_orders ADD COLUMN IF NOT EXISTS vendor_id INTEGER;
 ALTER TABLE purchase_orders ADD COLUMN IF NOT EXISTS order_date DATE DEFAULT CURRENT_DATE;
 ALTER TABLE purchase_orders ADD COLUMN IF NOT EXISTS expected_date DATE;
 ALTER TABLE purchase_orders ADD COLUMN IF NOT EXISTS status VARCHAR(20) DEFAULT 'draft'::character varying;
 ALTER TABLE purchase_orders ADD COLUMN IF NOT EXISTS subtotal NUMERIC DEFAULT 0;
 ALTER TABLE purchase_orders ADD COLUMN IF NOT EXISTS tax_amount NUMERIC DEFAULT 0;
 ALTER TABLE purchase_orders ADD COLUMN IF NOT EXISTS total_amount NUMERIC DEFAULT 0;
 ALTER TABLE purchase_orders ADD COLUMN IF NOT EXISTS currency VARCHAR(10) DEFAULT 'KES'::character varying;
 ALTER TABLE purchase_orders ADD COLUMN IF NOT EXISTS notes TEXT;
 ALTER TABLE purchase_orders ADD COLUMN IF NOT EXISTS approved_by INTEGER;
 ALTER TABLE purchase_orders ADD COLUMN IF NOT EXISTS approved_at TIMESTAMP;
 ALTER TABLE purchase_orders ADD COLUMN IF NOT EXISTS created_by INTEGER;
 ALTER TABLE purchase_orders ADD COLUMN IF NOT EXISTS created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
 ALTER TABLE purchase_orders ADD COLUMN IF NOT EXISTS updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
 ALTER TABLE quote_items ADD COLUMN IF NOT EXISTS quote_id INTEGER;
 ALTER TABLE quote_items ADD COLUMN IF NOT EXISTS product_id INTEGER;
 ALTER TABLE quote_items ADD COLUMN IF NOT EXISTS description TEXT;
 ALTER TABLE quote_items ADD COLUMN IF NOT EXISTS quantity NUMERIC DEFAULT 1;
 ALTER TABLE quote_items ADD COLUMN IF NOT EXISTS unit_price NUMERIC;
 ALTER TABLE quote_items ADD COLUMN IF NOT EXISTS tax_rate_id INTEGER;
 ALTER TABLE quote_items ADD COLUMN IF NOT EXISTS tax_amount NUMERIC DEFAULT 0;
 ALTER TABLE quote_items ADD COLUMN IF NOT EXISTS discount_percent NUMERIC DEFAULT 0;
 ALTER TABLE quote_items ADD COLUMN IF NOT EXISTS line_total NUMERIC;
 ALTER TABLE quote_items ADD COLUMN IF NOT EXISTS sort_order INTEGER DEFAULT 0;
 ALTER TABLE quotes ADD COLUMN IF NOT EXISTS quote_number VARCHAR(50);
 ALTER TABLE quotes ADD COLUMN IF NOT EXISTS customer_id INTEGER;
 ALTER TABLE quotes ADD COLUMN IF NOT EXISTS issue_date DATE DEFAULT CURRENT_DATE;
 ALTER TABLE quotes ADD COLUMN IF NOT EXISTS expiry_date DATE;
 ALTER TABLE quotes ADD COLUMN IF NOT EXISTS status VARCHAR(20) DEFAULT 'draft'::character varying;
 ALTER TABLE quotes ADD COLUMN IF NOT EXISTS subtotal NUMERIC DEFAULT 0;
 ALTER TABLE quotes ADD COLUMN IF NOT EXISTS tax_amount NUMERIC DEFAULT 0;
 ALTER TABLE quotes ADD COLUMN IF NOT EXISTS discount_amount NUMERIC DEFAULT 0;
 ALTER TABLE quotes ADD COLUMN IF NOT EXISTS total_amount NUMERIC DEFAULT 0;
 ALTER TABLE quotes ADD COLUMN IF NOT EXISTS currency VARCHAR(10) DEFAULT 'KES'::character varying;
 ALTER TABLE quotes ADD COLUMN IF NOT EXISTS notes TEXT;
 ALTER TABLE quotes ADD COLUMN IF NOT EXISTS terms TEXT;
 ALTER TABLE quotes ADD COLUMN IF NOT EXISTS converted_to_invoice_id INTEGER;
 ALTER TABLE quotes ADD COLUMN IF NOT EXISTS created_by INTEGER;
 ALTER TABLE quotes ADD COLUMN IF NOT EXISTS created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
 ALTER TABLE quotes ADD COLUMN IF NOT EXISTS updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
 ALTER TABLE radius_alert_log ADD COLUMN IF NOT EXISTS subscription_id INTEGER;
 ALTER TABLE radius_alert_log ADD COLUMN IF NOT EXISTS alert_type VARCHAR(30);
 ALTER TABLE radius_alert_log ADD COLUMN IF NOT EXISTS days_before INTEGER;
 ALTER TABLE radius_alert_log ADD COLUMN IF NOT EXISTS threshold_percent INTEGER;
 ALTER TABLE radius_alert_log ADD COLUMN IF NOT EXISTS message TEXT;
 ALTER TABLE radius_alert_log ADD COLUMN IF NOT EXISTS sent_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
 ALTER TABLE radius_billing ADD COLUMN IF NOT EXISTS subscription_id INTEGER;
 ALTER TABLE radius_billing ADD COLUMN IF NOT EXISTS package_id INTEGER;
 ALTER TABLE radius_billing ADD COLUMN IF NOT EXISTS amount NUMERIC;
 ALTER TABLE radius_billing ADD COLUMN IF NOT EXISTS billing_type VARCHAR(20);
 ALTER TABLE radius_billing ADD COLUMN IF NOT EXISTS period_start DATE;
 ALTER TABLE radius_billing ADD COLUMN IF NOT EXISTS period_end DATE;
 ALTER TABLE radius_billing ADD COLUMN IF NOT EXISTS payment_id INTEGER;
 ALTER TABLE radius_billing ADD COLUMN IF NOT EXISTS status VARCHAR(20) DEFAULT 'pending'::character varying;
 ALTER TABLE radius_billing ADD COLUMN IF NOT EXISTS invoice_number VARCHAR(50);
 ALTER TABLE radius_billing ADD COLUMN IF NOT EXISTS created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
 ALTER TABLE radius_billing ADD COLUMN IF NOT EXISTS payment_method VARCHAR(50);
 ALTER TABLE radius_billing ADD COLUMN IF NOT EXISTS transaction_ref VARCHAR(100);
 ALTER TABLE radius_invoices ADD COLUMN IF NOT EXISTS subscription_id INTEGER;
 ALTER TABLE radius_invoices ADD COLUMN IF NOT EXISTS invoice_number VARCHAR(30);
 ALTER TABLE radius_invoices ADD COLUMN IF NOT EXISTS amount NUMERIC;
 ALTER TABLE radius_invoices ADD COLUMN IF NOT EXISTS tax_amount NUMERIC DEFAULT 0;
 ALTER TABLE radius_invoices ADD COLUMN IF NOT EXISTS total_amount NUMERIC;
 ALTER TABLE radius_invoices ADD COLUMN IF NOT EXISTS description TEXT;
 ALTER TABLE radius_invoices ADD COLUMN IF NOT EXISTS due_date DATE;
 ALTER TABLE radius_invoices ADD COLUMN IF NOT EXISTS status VARCHAR(20) DEFAULT 'unpaid'::character varying;
 ALTER TABLE radius_invoices ADD COLUMN IF NOT EXISTS paid_at TIMESTAMP;
 ALTER TABLE radius_invoices ADD COLUMN IF NOT EXISTS payment_method VARCHAR(30);
 ALTER TABLE radius_invoices ADD COLUMN IF NOT EXISTS transaction_ref VARCHAR(100);
 ALTER TABLE radius_invoices ADD COLUMN IF NOT EXISTS created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
 ALTER TABLE radius_ip_pools ADD COLUMN IF NOT EXISTS pool_name VARCHAR(50);
 ALTER TABLE radius_ip_pools ADD COLUMN IF NOT EXISTS nas_id INTEGER;
 ALTER TABLE radius_ip_pools ADD COLUMN IF NOT EXISTS ip_address VARCHAR(45);
 ALTER TABLE radius_ip_pools ADD COLUMN IF NOT EXISTS status VARCHAR(20) DEFAULT 'available'::character varying;
 ALTER TABLE radius_ip_pools ADD COLUMN IF NOT EXISTS assigned_to INTEGER;
 ALTER TABLE radius_ip_pools ADD COLUMN IF NOT EXISTS assigned_at TIMESTAMP;
 ALTER TABLE radius_ip_pools ADD COLUMN IF NOT EXISTS created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
 ALTER TABLE radius_nas ADD COLUMN IF NOT EXISTS name VARCHAR(100);
 ALTER TABLE radius_nas ADD COLUMN IF NOT EXISTS ip_address VARCHAR(45);
 ALTER TABLE radius_nas ADD COLUMN IF NOT EXISTS secret VARCHAR(100);
 ALTER TABLE radius_nas ADD COLUMN IF NOT EXISTS nas_type VARCHAR(50) DEFAULT 'mikrotik'::character varying;
 ALTER TABLE radius_nas ADD COLUMN IF NOT EXISTS ports INTEGER DEFAULT 1812;
 ALTER TABLE radius_nas ADD COLUMN IF NOT EXISTS description TEXT;
 ALTER TABLE radius_nas ADD COLUMN IF NOT EXISTS api_enabled BOOLEAN DEFAULT false;
 ALTER TABLE radius_nas ADD COLUMN IF NOT EXISTS api_port INTEGER DEFAULT 8728;
 ALTER TABLE radius_nas ADD COLUMN IF NOT EXISTS api_username VARCHAR(100);
 ALTER TABLE radius_nas ADD COLUMN IF NOT EXISTS api_password_encrypted TEXT;
 ALTER TABLE radius_nas ADD COLUMN IF NOT EXISTS is_active BOOLEAN DEFAULT true;
 ALTER TABLE radius_nas ADD COLUMN IF NOT EXISTS created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
 ALTER TABLE radius_nas ADD COLUMN IF NOT EXISTS updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
 ALTER TABLE radius_nas ADD COLUMN IF NOT EXISTS expired_pool VARCHAR(100) DEFAULT 'expired-pool';
 ALTER TABLE radius_packages ADD COLUMN IF NOT EXISTS name VARCHAR(100);
 ALTER TABLE radius_packages ADD COLUMN IF NOT EXISTS description TEXT;
 ALTER TABLE radius_packages ADD COLUMN IF NOT EXISTS package_type VARCHAR(20) DEFAULT 'pppoe'::character varying;
 ALTER TABLE radius_packages ADD COLUMN IF NOT EXISTS billing_type VARCHAR(20) DEFAULT 'monthly'::character varying;
 ALTER TABLE radius_packages ADD COLUMN IF NOT EXISTS price NUMERIC DEFAULT 0;
 ALTER TABLE radius_packages ADD COLUMN IF NOT EXISTS validity_days INTEGER DEFAULT 30;
 ALTER TABLE radius_packages ADD COLUMN IF NOT EXISTS data_quota_mb BIGINT;
 ALTER TABLE radius_packages ADD COLUMN IF NOT EXISTS download_speed VARCHAR(20);
 ALTER TABLE radius_packages ADD COLUMN IF NOT EXISTS upload_speed VARCHAR(20);
 ALTER TABLE radius_packages ADD COLUMN IF NOT EXISTS burst_download VARCHAR(20);
 ALTER TABLE radius_packages ADD COLUMN IF NOT EXISTS burst_upload VARCHAR(20);
 ALTER TABLE radius_packages ADD COLUMN IF NOT EXISTS burst_threshold VARCHAR(20);
 ALTER TABLE radius_packages ADD COLUMN IF NOT EXISTS burst_time VARCHAR(20);
 ALTER TABLE radius_packages ADD COLUMN IF NOT EXISTS priority INTEGER DEFAULT 8;
 ALTER TABLE radius_packages ADD COLUMN IF NOT EXISTS address_pool VARCHAR(100);
 ALTER TABLE radius_packages ADD COLUMN IF NOT EXISTS ip_binding BOOLEAN DEFAULT false;
 ALTER TABLE radius_packages ADD COLUMN IF NOT EXISTS simultaneous_sessions INTEGER DEFAULT 1;
 ALTER TABLE radius_packages ADD COLUMN IF NOT EXISTS fup_enabled BOOLEAN DEFAULT false;
 ALTER TABLE radius_packages ADD COLUMN IF NOT EXISTS fup_quota_mb BIGINT;
 ALTER TABLE radius_packages ADD COLUMN IF NOT EXISTS fup_download_speed VARCHAR(20);
 ALTER TABLE radius_packages ADD COLUMN IF NOT EXISTS fup_upload_speed VARCHAR(20);
 ALTER TABLE radius_packages ADD COLUMN IF NOT EXISTS is_active BOOLEAN DEFAULT true;
 ALTER TABLE radius_packages ADD COLUMN IF NOT EXISTS created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
 ALTER TABLE radius_packages ADD COLUMN IF NOT EXISTS updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
 ALTER TABLE radius_promotions ADD COLUMN IF NOT EXISTS name VARCHAR(100);
 ALTER TABLE radius_promotions ADD COLUMN IF NOT EXISTS description TEXT;
 ALTER TABLE radius_promotions ADD COLUMN IF NOT EXISTS package_id INTEGER;
 ALTER TABLE radius_promotions ADD COLUMN IF NOT EXISTS discount_type VARCHAR(20) DEFAULT 'percent'::character varying;
 ALTER TABLE radius_promotions ADD COLUMN IF NOT EXISTS discount_value NUMERIC;
 ALTER TABLE radius_promotions ADD COLUMN IF NOT EXISTS promo_code VARCHAR(30);
 ALTER TABLE radius_promotions ADD COLUMN IF NOT EXISTS start_date DATE;
 ALTER TABLE radius_promotions ADD COLUMN IF NOT EXISTS end_date DATE;
 ALTER TABLE radius_promotions ADD COLUMN IF NOT EXISTS max_uses INTEGER;
 ALTER TABLE radius_promotions ADD COLUMN IF NOT EXISTS current_uses INTEGER DEFAULT 0;
 ALTER TABLE radius_promotions ADD COLUMN IF NOT EXISTS is_active BOOLEAN DEFAULT true;
 ALTER TABLE radius_promotions ADD COLUMN IF NOT EXISTS created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
 ALTER TABLE radius_redirect_rules ADD COLUMN IF NOT EXISTS name VARCHAR(100);
 ALTER TABLE radius_redirect_rules ADD COLUMN IF NOT EXISTS condition_type VARCHAR(30);
 ALTER TABLE radius_redirect_rules ADD COLUMN IF NOT EXISTS redirect_url TEXT;
 ALTER TABLE radius_redirect_rules ADD COLUMN IF NOT EXISTS walled_garden TEXT;
 ALTER TABLE radius_redirect_rules ADD COLUMN IF NOT EXISTS is_active BOOLEAN DEFAULT true;
 ALTER TABLE radius_redirect_rules ADD COLUMN IF NOT EXISTS created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
 ALTER TABLE radius_referrals ADD COLUMN IF NOT EXISTS referrer_subscription_id INTEGER;
 ALTER TABLE radius_referrals ADD COLUMN IF NOT EXISTS referred_subscription_id INTEGER;
 ALTER TABLE radius_referrals ADD COLUMN IF NOT EXISTS referral_code VARCHAR(20);
 ALTER TABLE radius_referrals ADD COLUMN IF NOT EXISTS reward_type VARCHAR(30) DEFAULT 'days'::character varying;
 ALTER TABLE radius_referrals ADD COLUMN IF NOT EXISTS reward_value NUMERIC DEFAULT 7;
 ALTER TABLE radius_referrals ADD COLUMN IF NOT EXISTS status VARCHAR(20) DEFAULT 'pending'::character varying;
 ALTER TABLE radius_referrals ADD COLUMN IF NOT EXISTS rewarded_at TIMESTAMP;
 ALTER TABLE radius_referrals ADD COLUMN IF NOT EXISTS created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
 ALTER TABLE radius_sessions ADD COLUMN IF NOT EXISTS subscription_id INTEGER;
 ALTER TABLE radius_sessions ADD COLUMN IF NOT EXISTS acct_session_id VARCHAR(64);
 ALTER TABLE radius_sessions ADD COLUMN IF NOT EXISTS nas_id INTEGER;
 ALTER TABLE radius_sessions ADD COLUMN IF NOT EXISTS nas_ip_address VARCHAR(45);
 ALTER TABLE radius_sessions ADD COLUMN IF NOT EXISTS nas_port_id VARCHAR(50);
 ALTER TABLE radius_sessions ADD COLUMN IF NOT EXISTS framed_ip_address VARCHAR(45);
 ALTER TABLE radius_sessions ADD COLUMN IF NOT EXISTS mac_address VARCHAR(17);
 ALTER TABLE radius_sessions ADD COLUMN IF NOT EXISTS session_start TIMESTAMP;
 ALTER TABLE radius_sessions ADD COLUMN IF NOT EXISTS session_end TIMESTAMP;
 ALTER TABLE radius_sessions ADD COLUMN IF NOT EXISTS session_duration INTEGER DEFAULT 0;
 ALTER TABLE radius_sessions ADD COLUMN IF NOT EXISTS input_octets BIGINT DEFAULT 0;
 ALTER TABLE radius_sessions ADD COLUMN IF NOT EXISTS output_octets BIGINT DEFAULT 0;
 ALTER TABLE radius_sessions ADD COLUMN IF NOT EXISTS input_packets BIGINT DEFAULT 0;
 ALTER TABLE radius_sessions ADD COLUMN IF NOT EXISTS output_packets BIGINT DEFAULT 0;
 ALTER TABLE radius_sessions ADD COLUMN IF NOT EXISTS terminate_cause VARCHAR(50);
 ALTER TABLE radius_sessions ADD COLUMN IF NOT EXISTS status VARCHAR(20) DEFAULT 'active'::character varying;
 ALTER TABLE radius_sessions ADD COLUMN IF NOT EXISTS created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
 ALTER TABLE radius_sessions ADD COLUMN IF NOT EXISTS username VARCHAR(100);
 ALTER TABLE radius_sessions ADD COLUMN IF NOT EXISTS started_at TIMESTAMP;
 ALTER TABLE radius_sessions ADD COLUMN IF NOT EXISTS stopped_at TIMESTAMP;
 ALTER TABLE radius_subscriptions ADD COLUMN IF NOT EXISTS customer_id INTEGER;
 ALTER TABLE radius_subscriptions ADD COLUMN IF NOT EXISTS package_id INTEGER;
 ALTER TABLE radius_subscriptions ADD COLUMN IF NOT EXISTS username VARCHAR(100);
 ALTER TABLE radius_subscriptions ADD COLUMN IF NOT EXISTS password_encrypted TEXT;
 ALTER TABLE radius_subscriptions ADD COLUMN IF NOT EXISTS access_type VARCHAR(20) DEFAULT 'pppoe'::character varying;
 ALTER TABLE radius_subscriptions ADD COLUMN IF NOT EXISTS static_ip VARCHAR(45);
 ALTER TABLE radius_subscriptions ADD COLUMN IF NOT EXISTS mac_address VARCHAR(17);
 ALTER TABLE radius_subscriptions ADD COLUMN IF NOT EXISTS status VARCHAR(20) DEFAULT 'active'::character varying;
 ALTER TABLE radius_subscriptions ADD COLUMN IF NOT EXISTS start_date DATE;
 ALTER TABLE radius_subscriptions ADD COLUMN IF NOT EXISTS expiry_date DATE;
 ALTER TABLE radius_subscriptions ADD COLUMN IF NOT EXISTS data_used_mb BIGINT DEFAULT 0;
 ALTER TABLE radius_subscriptions ADD COLUMN IF NOT EXISTS last_session_start TIMESTAMP;
 ALTER TABLE radius_subscriptions ADD COLUMN IF NOT EXISTS last_session_end TIMESTAMP;
 ALTER TABLE radius_subscriptions ADD COLUMN IF NOT EXISTS auto_renew BOOLEAN DEFAULT true;
 ALTER TABLE radius_subscriptions ADD COLUMN IF NOT EXISTS grace_period_days INTEGER DEFAULT 3;
 ALTER TABLE radius_subscriptions ADD COLUMN IF NOT EXISTS notes TEXT;
 ALTER TABLE radius_subscriptions ADD COLUMN IF NOT EXISTS nas_id INTEGER;
 ALTER TABLE radius_subscriptions ADD COLUMN IF NOT EXISTS created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
 ALTER TABLE radius_subscriptions ADD COLUMN IF NOT EXISTS updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
 ALTER TABLE radius_subscriptions ADD COLUMN IF NOT EXISTS password VARCHAR(100);
 ALTER TABLE radius_subscriptions ADD COLUMN IF NOT EXISTS credit_balance NUMERIC DEFAULT 0;
 ALTER TABLE radius_subscriptions ADD COLUMN IF NOT EXISTS credit_limit NUMERIC DEFAULT 0;
 ALTER TABLE radius_subscriptions ADD COLUMN IF NOT EXISTS referral_code VARCHAR(20);
 ALTER TABLE radius_usage_logs ADD COLUMN IF NOT EXISTS subscription_id INTEGER;
 ALTER TABLE radius_usage_logs ADD COLUMN IF NOT EXISTS log_date DATE;
 ALTER TABLE radius_usage_logs ADD COLUMN IF NOT EXISTS download_mb NUMERIC DEFAULT 0;
 ALTER TABLE radius_usage_logs ADD COLUMN IF NOT EXISTS upload_mb NUMERIC DEFAULT 0;
 ALTER TABLE radius_usage_logs ADD COLUMN IF NOT EXISTS session_count INTEGER DEFAULT 0;
 ALTER TABLE radius_usage_logs ADD COLUMN IF NOT EXISTS session_time_seconds INTEGER DEFAULT 0;
 ALTER TABLE radius_usage_logs ADD COLUMN IF NOT EXISTS created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
 ALTER TABLE radius_vouchers ADD COLUMN IF NOT EXISTS batch_id VARCHAR(50);
 ALTER TABLE radius_vouchers ADD COLUMN IF NOT EXISTS code VARCHAR(20);
 ALTER TABLE radius_vouchers ADD COLUMN IF NOT EXISTS package_id INTEGER;
 ALTER TABLE radius_vouchers ADD COLUMN IF NOT EXISTS status VARCHAR(20) DEFAULT 'unused'::character varying;
 ALTER TABLE radius_vouchers ADD COLUMN IF NOT EXISTS validity_minutes INTEGER DEFAULT 60;
 ALTER TABLE radius_vouchers ADD COLUMN IF NOT EXISTS data_limit_mb INTEGER;
 ALTER TABLE radius_vouchers ADD COLUMN IF NOT EXISTS used_by_subscription_id INTEGER;
 ALTER TABLE radius_vouchers ADD COLUMN IF NOT EXISTS used_at TIMESTAMP;
 ALTER TABLE radius_vouchers ADD COLUMN IF NOT EXISTS expires_at TIMESTAMP;
 ALTER TABLE radius_vouchers ADD COLUMN IF NOT EXISTS created_by INTEGER;
 ALTER TABLE radius_vouchers ADD COLUMN IF NOT EXISTS created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
 ALTER TABLE radpostauth ADD COLUMN IF NOT EXISTS username VARCHAR(100);
 ALTER TABLE radpostauth ADD COLUMN IF NOT EXISTS pass VARCHAR(255);
 ALTER TABLE radpostauth ADD COLUMN IF NOT EXISTS reply VARCHAR(32);
 ALTER TABLE radpostauth ADD COLUMN IF NOT EXISTS authdate TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
 ALTER TABLE radpostauth ADD COLUMN IF NOT EXISTS nasipaddress VARCHAR(45);
 ALTER TABLE radpostauth ADD COLUMN IF NOT EXISTS calledstationid VARCHAR(50);
 ALTER TABLE radpostauth ADD COLUMN IF NOT EXISTS callingstationid VARCHAR(50);
 ALTER TABLE role_permissions ADD COLUMN IF NOT EXISTS role_id INTEGER;
 ALTER TABLE role_permissions ADD COLUMN IF NOT EXISTS permission_id INTEGER;
 ALTER TABLE role_permissions ADD COLUMN IF NOT EXISTS created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
 ALTER TABLE roles ADD COLUMN IF NOT EXISTS name VARCHAR(50);
 ALTER TABLE roles ADD COLUMN IF NOT EXISTS display_name VARCHAR(100);
 ALTER TABLE roles ADD COLUMN IF NOT EXISTS description TEXT;
 ALTER TABLE roles ADD COLUMN IF NOT EXISTS is_system BOOLEAN DEFAULT false;
 ALTER TABLE roles ADD COLUMN IF NOT EXISTS created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
 ALTER TABLE roles ADD COLUMN IF NOT EXISTS updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
 ALTER TABLE salary_advance_repayments ADD COLUMN IF NOT EXISTS advance_id INTEGER;
 ALTER TABLE salary_advance_repayments ADD COLUMN IF NOT EXISTS amount NUMERIC;
 ALTER TABLE salary_advance_repayments ADD COLUMN IF NOT EXISTS repayment_date DATE;
 ALTER TABLE salary_advance_repayments ADD COLUMN IF NOT EXISTS payroll_id INTEGER;
 ALTER TABLE salary_advance_repayments ADD COLUMN IF NOT EXISTS notes TEXT;
 ALTER TABLE salary_advance_repayments ADD COLUMN IF NOT EXISTS created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
 ALTER TABLE salary_advances ADD COLUMN IF NOT EXISTS employee_id INTEGER;
 ALTER TABLE salary_advances ADD COLUMN IF NOT EXISTS requested_amount NUMERIC;
 ALTER TABLE salary_advances ADD COLUMN IF NOT EXISTS approved_amount NUMERIC;
 ALTER TABLE salary_advances ADD COLUMN IF NOT EXISTS repayment_schedule VARCHAR(20) DEFAULT 'monthly'::character varying;
 ALTER TABLE salary_advances ADD COLUMN IF NOT EXISTS installments INTEGER DEFAULT 1;
 ALTER TABLE salary_advances ADD COLUMN IF NOT EXISTS outstanding_balance NUMERIC;
 ALTER TABLE salary_advances ADD COLUMN IF NOT EXISTS status VARCHAR(20) DEFAULT 'pending'::character varying;
 ALTER TABLE salary_advances ADD COLUMN IF NOT EXISTS requested_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
 ALTER TABLE salary_advances ADD COLUMN IF NOT EXISTS approved_by INTEGER;
 ALTER TABLE salary_advances ADD COLUMN IF NOT EXISTS approved_at TIMESTAMP;
 ALTER TABLE salary_advances ADD COLUMN IF NOT EXISTS disbursed_at TIMESTAMP;
 ALTER TABLE salary_advances ADD COLUMN IF NOT EXISTS notes TEXT;
 ALTER TABLE salary_advances ADD COLUMN IF NOT EXISTS created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
 ALTER TABLE salary_advances ADD COLUMN IF NOT EXISTS updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
 ALTER TABLE salary_advances ADD COLUMN IF NOT EXISTS mpesa_b2c_transaction_id INTEGER;
 ALTER TABLE salary_advances ADD COLUMN IF NOT EXISTS disbursement_status VARCHAR(20) DEFAULT 'pending'::character varying;
 ALTER TABLE sales_commissions ADD COLUMN IF NOT EXISTS salesperson_id INTEGER;
 ALTER TABLE sales_commissions ADD COLUMN IF NOT EXISTS order_id INTEGER;
 ALTER TABLE sales_commissions ADD COLUMN IF NOT EXISTS order_amount NUMERIC;
 ALTER TABLE sales_commissions ADD COLUMN IF NOT EXISTS commission_type VARCHAR(20);
 ALTER TABLE sales_commissions ADD COLUMN IF NOT EXISTS commission_rate NUMERIC;
 ALTER TABLE sales_commissions ADD COLUMN IF NOT EXISTS commission_amount NUMERIC;
 ALTER TABLE sales_commissions ADD COLUMN IF NOT EXISTS status VARCHAR(20) DEFAULT 'pending'::character varying;
 ALTER TABLE sales_commissions ADD COLUMN IF NOT EXISTS paid_at TIMESTAMP;
 ALTER TABLE sales_commissions ADD COLUMN IF NOT EXISTS notes TEXT;
 ALTER TABLE sales_commissions ADD COLUMN IF NOT EXISTS created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
 ALTER TABLE salespersons ADD COLUMN IF NOT EXISTS employee_id INTEGER;
 ALTER TABLE salespersons ADD COLUMN IF NOT EXISTS user_id INTEGER;
 ALTER TABLE salespersons ADD COLUMN IF NOT EXISTS name VARCHAR(100);
 ALTER TABLE salespersons ADD COLUMN IF NOT EXISTS email VARCHAR(100);
 ALTER TABLE salespersons ADD COLUMN IF NOT EXISTS phone VARCHAR(20);
 ALTER TABLE salespersons ADD COLUMN IF NOT EXISTS commission_type VARCHAR(20) DEFAULT 'percentage'::character varying;
 ALTER TABLE salespersons ADD COLUMN IF NOT EXISTS commission_value NUMERIC DEFAULT 0;
 ALTER TABLE salespersons ADD COLUMN IF NOT EXISTS total_sales NUMERIC DEFAULT 0;
 ALTER TABLE salespersons ADD COLUMN IF NOT EXISTS total_commission NUMERIC DEFAULT 0;
 ALTER TABLE salespersons ADD COLUMN IF NOT EXISTS is_active BOOLEAN DEFAULT true;
 ALTER TABLE salespersons ADD COLUMN IF NOT EXISTS notes TEXT;
 ALTER TABLE salespersons ADD COLUMN IF NOT EXISTS created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
 ALTER TABLE salespersons ADD COLUMN IF NOT EXISTS updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
 ALTER TABLE schema_migrations ADD COLUMN IF NOT EXISTS version VARCHAR(50);
 ALTER TABLE schema_migrations ADD COLUMN IF NOT EXISTS applied_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
 ALTER TABLE service_fee_types ADD COLUMN IF NOT EXISTS name VARCHAR(100);
 ALTER TABLE service_fee_types ADD COLUMN IF NOT EXISTS description TEXT;
 ALTER TABLE service_fee_types ADD COLUMN IF NOT EXISTS default_amount NUMERIC DEFAULT 0;
 ALTER TABLE service_fee_types ADD COLUMN IF NOT EXISTS currency VARCHAR(10) DEFAULT 'KES'::character varying;
 ALTER TABLE service_fee_types ADD COLUMN IF NOT EXISTS is_active BOOLEAN DEFAULT true;
 ALTER TABLE service_fee_types ADD COLUMN IF NOT EXISTS display_order INTEGER DEFAULT 0;
 ALTER TABLE service_fee_types ADD COLUMN IF NOT EXISTS created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
 ALTER TABLE service_fee_types ADD COLUMN IF NOT EXISTS updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
 ALTER TABLE service_packages ADD COLUMN IF NOT EXISTS name VARCHAR(100);
 ALTER TABLE service_packages ADD COLUMN IF NOT EXISTS slug VARCHAR(100);
 ALTER TABLE service_packages ADD COLUMN IF NOT EXISTS description TEXT;
 ALTER TABLE service_packages ADD COLUMN IF NOT EXISTS speed VARCHAR(50);
 ALTER TABLE service_packages ADD COLUMN IF NOT EXISTS speed_unit VARCHAR(10) DEFAULT 'Mbps'::character varying;
 ALTER TABLE service_packages ADD COLUMN IF NOT EXISTS price NUMERIC;
 ALTER TABLE service_packages ADD COLUMN IF NOT EXISTS currency VARCHAR(10) DEFAULT 'KES'::character varying;
 ALTER TABLE service_packages ADD COLUMN IF NOT EXISTS billing_cycle VARCHAR(20) DEFAULT 'monthly'::character varying;
 ALTER TABLE service_packages ADD COLUMN IF NOT EXISTS features JSONB DEFAULT '[]'::jsonb;
 ALTER TABLE service_packages ADD COLUMN IF NOT EXISTS is_popular BOOLEAN DEFAULT false;
 ALTER TABLE service_packages ADD COLUMN IF NOT EXISTS is_active BOOLEAN DEFAULT true;
 ALTER TABLE service_packages ADD COLUMN IF NOT EXISTS display_order INTEGER DEFAULT 0;
 ALTER TABLE service_packages ADD COLUMN IF NOT EXISTS badge_text VARCHAR(50);
 ALTER TABLE service_packages ADD COLUMN IF NOT EXISTS badge_color VARCHAR(20);
 ALTER TABLE service_packages ADD COLUMN IF NOT EXISTS icon VARCHAR(50) DEFAULT 'wifi'::character varying;
 ALTER TABLE service_packages ADD COLUMN IF NOT EXISTS created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
 ALTER TABLE service_packages ADD COLUMN IF NOT EXISTS updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
 ALTER TABLE settings ADD COLUMN IF NOT EXISTS setting_key VARCHAR(100);
 ALTER TABLE settings ADD COLUMN IF NOT EXISTS setting_value TEXT;
 ALTER TABLE settings ADD COLUMN IF NOT EXISTS created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
 ALTER TABLE settings ADD COLUMN IF NOT EXISTS updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
 ALTER TABLE settings ADD COLUMN IF NOT EXISTS setting_group VARCHAR(50);
 ALTER TABLE sla_business_hours ADD COLUMN IF NOT EXISTS day_of_week INTEGER;
 ALTER TABLE sla_business_hours ADD COLUMN IF NOT EXISTS start_time TIME WITHOUT TIME ZONE DEFAULT '08:00:00'::time without time zone;
 ALTER TABLE sla_business_hours ADD COLUMN IF NOT EXISTS end_time TIME WITHOUT TIME ZONE DEFAULT '17:00:00'::time without time zone;
 ALTER TABLE sla_business_hours ADD COLUMN IF NOT EXISTS is_working_day BOOLEAN DEFAULT true;
 ALTER TABLE sla_business_hours ADD COLUMN IF NOT EXISTS created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
 ALTER TABLE sla_holidays ADD COLUMN IF NOT EXISTS name VARCHAR(100);
 ALTER TABLE sla_holidays ADD COLUMN IF NOT EXISTS holiday_date DATE;
 ALTER TABLE sla_holidays ADD COLUMN IF NOT EXISTS is_recurring BOOLEAN DEFAULT false;
 ALTER TABLE sla_holidays ADD COLUMN IF NOT EXISTS created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
 ALTER TABLE sla_policies ADD COLUMN IF NOT EXISTS name VARCHAR(100);
 ALTER TABLE sla_policies ADD COLUMN IF NOT EXISTS description TEXT;
 ALTER TABLE sla_policies ADD COLUMN IF NOT EXISTS priority VARCHAR(20);
 ALTER TABLE sla_policies ADD COLUMN IF NOT EXISTS response_time_hours INTEGER DEFAULT 4;
 ALTER TABLE sla_policies ADD COLUMN IF NOT EXISTS resolution_time_hours INTEGER DEFAULT 24;
 ALTER TABLE sla_policies ADD COLUMN IF NOT EXISTS escalation_time_hours INTEGER;
 ALTER TABLE sla_policies ADD COLUMN IF NOT EXISTS escalation_to INTEGER;
 ALTER TABLE sla_policies ADD COLUMN IF NOT EXISTS notify_on_breach BOOLEAN DEFAULT true;
 ALTER TABLE sla_policies ADD COLUMN IF NOT EXISTS is_active BOOLEAN DEFAULT true;
 ALTER TABLE sla_policies ADD COLUMN IF NOT EXISTS is_default BOOLEAN DEFAULT false;
 ALTER TABLE sla_policies ADD COLUMN IF NOT EXISTS created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
 ALTER TABLE sla_policies ADD COLUMN IF NOT EXISTS updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
 ALTER TABLE sms_logs ADD COLUMN IF NOT EXISTS ticket_id INTEGER;
 ALTER TABLE sms_logs ADD COLUMN IF NOT EXISTS recipient_phone VARCHAR(20);
 ALTER TABLE sms_logs ADD COLUMN IF NOT EXISTS recipient_type VARCHAR(20);
 ALTER TABLE sms_logs ADD COLUMN IF NOT EXISTS message TEXT;
 ALTER TABLE sms_logs ADD COLUMN IF NOT EXISTS status VARCHAR(20) DEFAULT 'pending'::character varying;
 ALTER TABLE sms_logs ADD COLUMN IF NOT EXISTS sent_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
 ALTER TABLE tax_rates ADD COLUMN IF NOT EXISTS name VARCHAR(100);
 ALTER TABLE tax_rates ADD COLUMN IF NOT EXISTS rate NUMERIC DEFAULT 16.00;
 ALTER TABLE tax_rates ADD COLUMN IF NOT EXISTS type VARCHAR(20) DEFAULT 'percentage'::character varying;
 ALTER TABLE tax_rates ADD COLUMN IF NOT EXISTS is_inclusive BOOLEAN DEFAULT false;
 ALTER TABLE tax_rates ADD COLUMN IF NOT EXISTS is_default BOOLEAN DEFAULT false;
 ALTER TABLE tax_rates ADD COLUMN IF NOT EXISTS is_active BOOLEAN DEFAULT true;
 ALTER TABLE tax_rates ADD COLUMN IF NOT EXISTS created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
 ALTER TABLE team_members ADD COLUMN IF NOT EXISTS team_id INTEGER;
 ALTER TABLE team_members ADD COLUMN IF NOT EXISTS employee_id INTEGER;
 ALTER TABLE team_members ADD COLUMN IF NOT EXISTS joined_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
 ALTER TABLE teams ADD COLUMN IF NOT EXISTS name VARCHAR(100);
 ALTER TABLE teams ADD COLUMN IF NOT EXISTS description TEXT;
 ALTER TABLE teams ADD COLUMN IF NOT EXISTS leader_id INTEGER;
 ALTER TABLE teams ADD COLUMN IF NOT EXISTS is_active BOOLEAN DEFAULT true;
 ALTER TABLE teams ADD COLUMN IF NOT EXISTS created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
 ALTER TABLE teams ADD COLUMN IF NOT EXISTS updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
 ALTER TABLE teams ADD COLUMN IF NOT EXISTS branch_id INTEGER;
 ALTER TABLE technician_kit_items ADD COLUMN IF NOT EXISTS kit_id INTEGER;
 ALTER TABLE technician_kit_items ADD COLUMN IF NOT EXISTS equipment_id INTEGER;
 ALTER TABLE technician_kit_items ADD COLUMN IF NOT EXISTS category_id INTEGER;
 ALTER TABLE technician_kit_items ADD COLUMN IF NOT EXISTS quantity INTEGER DEFAULT 1;
 ALTER TABLE technician_kit_items ADD COLUMN IF NOT EXISTS issued_quantity INTEGER DEFAULT 0;
 ALTER TABLE technician_kit_items ADD COLUMN IF NOT EXISTS returned_quantity INTEGER DEFAULT 0;
 ALTER TABLE technician_kit_items ADD COLUMN IF NOT EXISTS status VARCHAR(20) DEFAULT 'issued'::character varying;
 ALTER TABLE technician_kit_items ADD COLUMN IF NOT EXISTS notes TEXT;
 ALTER TABLE technician_kit_items ADD COLUMN IF NOT EXISTS created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
 ALTER TABLE technician_kits ADD COLUMN IF NOT EXISTS kit_number VARCHAR(30);
 ALTER TABLE technician_kits ADD COLUMN IF NOT EXISTS employee_id INTEGER;
 ALTER TABLE technician_kits ADD COLUMN IF NOT EXISTS name VARCHAR(100);
 ALTER TABLE technician_kits ADD COLUMN IF NOT EXISTS description TEXT;
 ALTER TABLE technician_kits ADD COLUMN IF NOT EXISTS status VARCHAR(20) DEFAULT 'active'::character varying;
 ALTER TABLE technician_kits ADD COLUMN IF NOT EXISTS issued_date DATE;
 ALTER TABLE technician_kits ADD COLUMN IF NOT EXISTS issued_by INTEGER;
 ALTER TABLE technician_kits ADD COLUMN IF NOT EXISTS returned_date DATE;
 ALTER TABLE technician_kits ADD COLUMN IF NOT EXISTS notes TEXT;
 ALTER TABLE technician_kits ADD COLUMN IF NOT EXISTS created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
 ALTER TABLE technician_kits ADD COLUMN IF NOT EXISTS updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
 ALTER TABLE ticket_categories ADD COLUMN IF NOT EXISTS key VARCHAR(50);
 ALTER TABLE ticket_categories ADD COLUMN IF NOT EXISTS label VARCHAR(100);
 ALTER TABLE ticket_categories ADD COLUMN IF NOT EXISTS description TEXT;
 ALTER TABLE ticket_categories ADD COLUMN IF NOT EXISTS color VARCHAR(20) DEFAULT 'primary'::character varying;
 ALTER TABLE ticket_categories ADD COLUMN IF NOT EXISTS display_order INTEGER DEFAULT 0;
 ALTER TABLE ticket_categories ADD COLUMN IF NOT EXISTS is_active BOOLEAN DEFAULT true;
 ALTER TABLE ticket_categories ADD COLUMN IF NOT EXISTS created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
 ALTER TABLE ticket_categories ADD COLUMN IF NOT EXISTS updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
 ALTER TABLE ticket_comments ADD COLUMN IF NOT EXISTS ticket_id INTEGER;
 ALTER TABLE ticket_comments ADD COLUMN IF NOT EXISTS user_id INTEGER;
 ALTER TABLE ticket_comments ADD COLUMN IF NOT EXISTS comment TEXT;
 ALTER TABLE ticket_comments ADD COLUMN IF NOT EXISTS is_internal BOOLEAN DEFAULT false;
 ALTER TABLE ticket_comments ADD COLUMN IF NOT EXISTS created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
 ALTER TABLE ticket_commission_rates ADD COLUMN IF NOT EXISTS category VARCHAR(50);
 ALTER TABLE ticket_commission_rates ADD COLUMN IF NOT EXISTS rate NUMERIC DEFAULT 0;
 ALTER TABLE ticket_commission_rates ADD COLUMN IF NOT EXISTS currency VARCHAR(10) DEFAULT 'KES'::character varying;
 ALTER TABLE ticket_commission_rates ADD COLUMN IF NOT EXISTS description TEXT;
 ALTER TABLE ticket_commission_rates ADD COLUMN IF NOT EXISTS is_active BOOLEAN DEFAULT true;
 ALTER TABLE ticket_commission_rates ADD COLUMN IF NOT EXISTS created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
 ALTER TABLE ticket_commission_rates ADD COLUMN IF NOT EXISTS updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
 ALTER TABLE ticket_commission_rates ADD COLUMN IF NOT EXISTS require_sla_compliance BOOLEAN DEFAULT false;
 ALTER TABLE ticket_earnings ADD COLUMN IF NOT EXISTS ticket_id INTEGER;
 ALTER TABLE ticket_earnings ADD COLUMN IF NOT EXISTS employee_id INTEGER;
 ALTER TABLE ticket_earnings ADD COLUMN IF NOT EXISTS team_id INTEGER;
 ALTER TABLE ticket_earnings ADD COLUMN IF NOT EXISTS category VARCHAR(50);
 ALTER TABLE ticket_earnings ADD COLUMN IF NOT EXISTS full_rate NUMERIC;
 ALTER TABLE ticket_earnings ADD COLUMN IF NOT EXISTS earned_amount NUMERIC;
 ALTER TABLE ticket_earnings ADD COLUMN IF NOT EXISTS share_count INTEGER DEFAULT 1;
 ALTER TABLE ticket_earnings ADD COLUMN IF NOT EXISTS currency VARCHAR(10) DEFAULT 'KES'::character varying;
 ALTER TABLE ticket_earnings ADD COLUMN IF NOT EXISTS status VARCHAR(20) DEFAULT 'pending'::character varying;
 ALTER TABLE ticket_earnings ADD COLUMN IF NOT EXISTS payroll_id INTEGER;
 ALTER TABLE ticket_earnings ADD COLUMN IF NOT EXISTS created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
 ALTER TABLE ticket_earnings ADD COLUMN IF NOT EXISTS sla_compliant BOOLEAN DEFAULT true;
 ALTER TABLE ticket_earnings ADD COLUMN IF NOT EXISTS sla_note TEXT;
 ALTER TABLE ticket_escalations ADD COLUMN IF NOT EXISTS ticket_id INTEGER;
 ALTER TABLE ticket_escalations ADD COLUMN IF NOT EXISTS escalated_by INTEGER;
 ALTER TABLE ticket_escalations ADD COLUMN IF NOT EXISTS escalated_to INTEGER;
 ALTER TABLE ticket_escalations ADD COLUMN IF NOT EXISTS reason TEXT;
 ALTER TABLE ticket_escalations ADD COLUMN IF NOT EXISTS previous_priority VARCHAR(20);
 ALTER TABLE ticket_escalations ADD COLUMN IF NOT EXISTS new_priority VARCHAR(20);
 ALTER TABLE ticket_escalations ADD COLUMN IF NOT EXISTS previous_assigned_to INTEGER;
 ALTER TABLE ticket_escalations ADD COLUMN IF NOT EXISTS status VARCHAR(20) DEFAULT 'active'::character varying;
 ALTER TABLE ticket_escalations ADD COLUMN IF NOT EXISTS resolved_at TIMESTAMP;
 ALTER TABLE ticket_escalations ADD COLUMN IF NOT EXISTS resolution_notes TEXT;
 ALTER TABLE ticket_escalations ADD COLUMN IF NOT EXISTS created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
 ALTER TABLE ticket_satisfaction_ratings ADD COLUMN IF NOT EXISTS ticket_id INTEGER;
 ALTER TABLE ticket_satisfaction_ratings ADD COLUMN IF NOT EXISTS customer_id INTEGER;
 ALTER TABLE ticket_satisfaction_ratings ADD COLUMN IF NOT EXISTS rating INTEGER;
 ALTER TABLE ticket_satisfaction_ratings ADD COLUMN IF NOT EXISTS feedback TEXT;
 ALTER TABLE ticket_satisfaction_ratings ADD COLUMN IF NOT EXISTS rated_by_name VARCHAR(100);
 ALTER TABLE ticket_satisfaction_ratings ADD COLUMN IF NOT EXISTS rated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
 ALTER TABLE ticket_satisfaction_ratings ADD COLUMN IF NOT EXISTS created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
 ALTER TABLE ticket_service_fees ADD COLUMN IF NOT EXISTS ticket_id INTEGER;
 ALTER TABLE ticket_service_fees ADD COLUMN IF NOT EXISTS fee_type_id INTEGER;
 ALTER TABLE ticket_service_fees ADD COLUMN IF NOT EXISTS fee_name VARCHAR(100);
 ALTER TABLE ticket_service_fees ADD COLUMN IF NOT EXISTS amount NUMERIC DEFAULT 0;
 ALTER TABLE ticket_service_fees ADD COLUMN IF NOT EXISTS currency VARCHAR(10) DEFAULT 'KES'::character varying;
 ALTER TABLE ticket_service_fees ADD COLUMN IF NOT EXISTS notes TEXT;
 ALTER TABLE ticket_service_fees ADD COLUMN IF NOT EXISTS is_paid BOOLEAN DEFAULT false;
 ALTER TABLE ticket_service_fees ADD COLUMN IF NOT EXISTS paid_at TIMESTAMP;
 ALTER TABLE ticket_service_fees ADD COLUMN IF NOT EXISTS payment_reference VARCHAR(100);
 ALTER TABLE ticket_service_fees ADD COLUMN IF NOT EXISTS created_by INTEGER;
 ALTER TABLE ticket_service_fees ADD COLUMN IF NOT EXISTS created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
 ALTER TABLE ticket_sla_logs ADD COLUMN IF NOT EXISTS ticket_id INTEGER;
 ALTER TABLE ticket_sla_logs ADD COLUMN IF NOT EXISTS event_type VARCHAR(50);
 ALTER TABLE ticket_sla_logs ADD COLUMN IF NOT EXISTS details TEXT;
 ALTER TABLE ticket_sla_logs ADD COLUMN IF NOT EXISTS created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
 ALTER TABLE ticket_status_tokens ADD COLUMN IF NOT EXISTS ticket_id INTEGER;
 ALTER TABLE ticket_status_tokens ADD COLUMN IF NOT EXISTS employee_id INTEGER;
 ALTER TABLE ticket_status_tokens ADD COLUMN IF NOT EXISTS token_hash VARCHAR(255);
 ALTER TABLE ticket_status_tokens ADD COLUMN IF NOT EXISTS allowed_statuses TEXT DEFAULT 'In Progress,Resolved,Closed'::text;
 ALTER TABLE ticket_status_tokens ADD COLUMN IF NOT EXISTS expires_at TIMESTAMP;
 ALTER TABLE ticket_status_tokens ADD COLUMN IF NOT EXISTS max_uses INTEGER DEFAULT 10;
 ALTER TABLE ticket_status_tokens ADD COLUMN IF NOT EXISTS used_count INTEGER DEFAULT 0;
 ALTER TABLE ticket_status_tokens ADD COLUMN IF NOT EXISTS created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
 ALTER TABLE ticket_status_tokens ADD COLUMN IF NOT EXISTS last_used_at TIMESTAMP;
 ALTER TABLE ticket_status_tokens ADD COLUMN IF NOT EXISTS is_active BOOLEAN DEFAULT true;
 ALTER TABLE ticket_status_tokens ADD COLUMN IF NOT EXISTS token_lookup VARCHAR(32);
 ALTER TABLE ticket_templates ADD COLUMN IF NOT EXISTS name VARCHAR(100);
 ALTER TABLE ticket_templates ADD COLUMN IF NOT EXISTS category VARCHAR(50);
 ALTER TABLE ticket_templates ADD COLUMN IF NOT EXISTS subject VARCHAR(200);
 ALTER TABLE ticket_templates ADD COLUMN IF NOT EXISTS content TEXT;
 ALTER TABLE ticket_templates ADD COLUMN IF NOT EXISTS is_active BOOLEAN DEFAULT true;
 ALTER TABLE ticket_templates ADD COLUMN IF NOT EXISTS created_by INTEGER;
 ALTER TABLE ticket_templates ADD COLUMN IF NOT EXISTS created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
 ALTER TABLE ticket_templates ADD COLUMN IF NOT EXISTS updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
 ALTER TABLE tickets ADD COLUMN IF NOT EXISTS ticket_number VARCHAR(20);
 ALTER TABLE tickets ADD COLUMN IF NOT EXISTS customer_id INTEGER;
 ALTER TABLE tickets ADD COLUMN IF NOT EXISTS assigned_to INTEGER;
 ALTER TABLE tickets ADD COLUMN IF NOT EXISTS subject VARCHAR(200);
 ALTER TABLE tickets ADD COLUMN IF NOT EXISTS description TEXT;
 ALTER TABLE tickets ADD COLUMN IF NOT EXISTS category VARCHAR(50);
 ALTER TABLE tickets ADD COLUMN IF NOT EXISTS priority VARCHAR(20) DEFAULT 'medium'::character varying;
 ALTER TABLE tickets ADD COLUMN IF NOT EXISTS status VARCHAR(20) DEFAULT 'open'::character varying;
 ALTER TABLE tickets ADD COLUMN IF NOT EXISTS created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
 ALTER TABLE tickets ADD COLUMN IF NOT EXISTS updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
 ALTER TABLE tickets ADD COLUMN IF NOT EXISTS resolved_at TIMESTAMP;
 ALTER TABLE tickets ADD COLUMN IF NOT EXISTS team_id INTEGER;
 ALTER TABLE tickets ADD COLUMN IF NOT EXISTS sla_policy_id INTEGER;
 ALTER TABLE tickets ADD COLUMN IF NOT EXISTS first_response_at TIMESTAMP;
 ALTER TABLE tickets ADD COLUMN IF NOT EXISTS sla_response_due TIMESTAMP;
 ALTER TABLE tickets ADD COLUMN IF NOT EXISTS sla_resolution_due TIMESTAMP;
 ALTER TABLE tickets ADD COLUMN IF NOT EXISTS sla_response_breached BOOLEAN DEFAULT false;
 ALTER TABLE tickets ADD COLUMN IF NOT EXISTS sla_resolution_breached BOOLEAN DEFAULT false;
 ALTER TABLE tickets ADD COLUMN IF NOT EXISTS sla_paused_at TIMESTAMP;
 ALTER TABLE tickets ADD COLUMN IF NOT EXISTS sla_paused_duration INTEGER DEFAULT 0;
 ALTER TABLE tickets ADD COLUMN IF NOT EXISTS source VARCHAR(50) DEFAULT 'internal'::character varying;
 ALTER TABLE tickets ADD COLUMN IF NOT EXISTS created_by INTEGER;
 ALTER TABLE tickets ADD COLUMN IF NOT EXISTS is_escalated BOOLEAN DEFAULT false;
 ALTER TABLE tickets ADD COLUMN IF NOT EXISTS escalation_count INTEGER DEFAULT 0;
 ALTER TABLE tickets ADD COLUMN IF NOT EXISTS satisfaction_rating INTEGER;
 ALTER TABLE tickets ADD COLUMN IF NOT EXISTS closed_at TIMESTAMP;
 ALTER TABLE tickets ADD COLUMN IF NOT EXISTS branch_id INTEGER;
 ALTER TABLE tr069_devices ADD COLUMN IF NOT EXISTS onu_id INTEGER;
 ALTER TABLE tr069_devices ADD COLUMN IF NOT EXISTS device_id VARCHAR(255);
 ALTER TABLE tr069_devices ADD COLUMN IF NOT EXISTS serial_number VARCHAR(64);
 ALTER TABLE tr069_devices ADD COLUMN IF NOT EXISTS manufacturer VARCHAR(64);
 ALTER TABLE tr069_devices ADD COLUMN IF NOT EXISTS model VARCHAR(64);
 ALTER TABLE tr069_devices ADD COLUMN IF NOT EXISTS last_inform TIMESTAMP;
 ALTER TABLE tr069_devices ADD COLUMN IF NOT EXISTS created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
 ALTER TABLE tr069_devices ADD COLUMN IF NOT EXISTS updated_at TIMESTAMP;
 ALTER TABLE tr069_devices ADD COLUMN IF NOT EXISTS ip_address VARCHAR(45);
 ALTER TABLE user_notifications ADD COLUMN IF NOT EXISTS user_id INTEGER;
 ALTER TABLE user_notifications ADD COLUMN IF NOT EXISTS type VARCHAR(50) DEFAULT 'info'::character varying;
 ALTER TABLE user_notifications ADD COLUMN IF NOT EXISTS title VARCHAR(255);
 ALTER TABLE user_notifications ADD COLUMN IF NOT EXISTS message TEXT;
 ALTER TABLE user_notifications ADD COLUMN IF NOT EXISTS reference_id INTEGER;
 ALTER TABLE user_notifications ADD COLUMN IF NOT EXISTS is_read BOOLEAN DEFAULT false;
 ALTER TABLE user_notifications ADD COLUMN IF NOT EXISTS created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
 ALTER TABLE user_notifications ADD COLUMN IF NOT EXISTS link VARCHAR(500);
 ALTER TABLE users ADD COLUMN IF NOT EXISTS name VARCHAR(100);
 ALTER TABLE users ADD COLUMN IF NOT EXISTS email VARCHAR(100);
 ALTER TABLE users ADD COLUMN IF NOT EXISTS phone VARCHAR(20);
 ALTER TABLE users ADD COLUMN IF NOT EXISTS role VARCHAR(20) DEFAULT 'technician'::character varying;
 ALTER TABLE users ADD COLUMN IF NOT EXISTS created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
 ALTER TABLE users ADD COLUMN IF NOT EXISTS password_hash VARCHAR(255);
 ALTER TABLE users ADD COLUMN IF NOT EXISTS role_id INTEGER;
 ALTER TABLE vendor_bill_items ADD COLUMN IF NOT EXISTS bill_id INTEGER;
 ALTER TABLE vendor_bill_items ADD COLUMN IF NOT EXISTS account_id INTEGER;
 ALTER TABLE vendor_bill_items ADD COLUMN IF NOT EXISTS description TEXT;
 ALTER TABLE vendor_bill_items ADD COLUMN IF NOT EXISTS quantity NUMERIC DEFAULT 1;
 ALTER TABLE vendor_bill_items ADD COLUMN IF NOT EXISTS unit_price NUMERIC;
 ALTER TABLE vendor_bill_items ADD COLUMN IF NOT EXISTS tax_rate_id INTEGER;
 ALTER TABLE vendor_bill_items ADD COLUMN IF NOT EXISTS tax_amount NUMERIC DEFAULT 0;
 ALTER TABLE vendor_bill_items ADD COLUMN IF NOT EXISTS line_total NUMERIC;
 ALTER TABLE vendor_bill_items ADD COLUMN IF NOT EXISTS sort_order INTEGER DEFAULT 0;
 ALTER TABLE vendor_bills ADD COLUMN IF NOT EXISTS bill_number VARCHAR(50);
 ALTER TABLE vendor_bills ADD COLUMN IF NOT EXISTS vendor_id INTEGER;
 ALTER TABLE vendor_bills ADD COLUMN IF NOT EXISTS purchase_order_id INTEGER;
 ALTER TABLE vendor_bills ADD COLUMN IF NOT EXISTS bill_date DATE DEFAULT CURRENT_DATE;
 ALTER TABLE vendor_bills ADD COLUMN IF NOT EXISTS due_date DATE;
 ALTER TABLE vendor_bills ADD COLUMN IF NOT EXISTS status VARCHAR(20) DEFAULT 'unpaid'::character varying;
 ALTER TABLE vendor_bills ADD COLUMN IF NOT EXISTS subtotal NUMERIC DEFAULT 0;
 ALTER TABLE vendor_bills ADD COLUMN IF NOT EXISTS tax_amount NUMERIC DEFAULT 0;
 ALTER TABLE vendor_bills ADD COLUMN IF NOT EXISTS total_amount NUMERIC DEFAULT 0;
 ALTER TABLE vendor_bills ADD COLUMN IF NOT EXISTS amount_paid NUMERIC DEFAULT 0;
 ALTER TABLE vendor_bills ADD COLUMN IF NOT EXISTS balance_due NUMERIC DEFAULT 0;
 ALTER TABLE vendor_bills ADD COLUMN IF NOT EXISTS currency VARCHAR(10) DEFAULT 'KES'::character varying;
 ALTER TABLE vendor_bills ADD COLUMN IF NOT EXISTS reference VARCHAR(100);
 ALTER TABLE vendor_bills ADD COLUMN IF NOT EXISTS notes TEXT;
 ALTER TABLE vendor_bills ADD COLUMN IF NOT EXISTS created_by INTEGER;
 ALTER TABLE vendor_bills ADD COLUMN IF NOT EXISTS created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
 ALTER TABLE vendor_bills ADD COLUMN IF NOT EXISTS updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
 ALTER TABLE vendor_bills ADD COLUMN IF NOT EXISTS reminder_enabled BOOLEAN DEFAULT false;
 ALTER TABLE vendor_bills ADD COLUMN IF NOT EXISTS reminder_days_before INTEGER DEFAULT 3;
 ALTER TABLE vendor_bills ADD COLUMN IF NOT EXISTS last_reminder_sent TIMESTAMP;
 ALTER TABLE vendor_bills ADD COLUMN IF NOT EXISTS reminder_count INTEGER DEFAULT 0;
 ALTER TABLE vendor_payments ADD COLUMN IF NOT EXISTS payment_number VARCHAR(50);
 ALTER TABLE vendor_payments ADD COLUMN IF NOT EXISTS vendor_id INTEGER;
 ALTER TABLE vendor_payments ADD COLUMN IF NOT EXISTS bill_id INTEGER;
 ALTER TABLE vendor_payments ADD COLUMN IF NOT EXISTS payment_date DATE DEFAULT CURRENT_DATE;
 ALTER TABLE vendor_payments ADD COLUMN IF NOT EXISTS amount NUMERIC;
 ALTER TABLE vendor_payments ADD COLUMN IF NOT EXISTS payment_method VARCHAR(50);
 ALTER TABLE vendor_payments ADD COLUMN IF NOT EXISTS reference VARCHAR(100);
 ALTER TABLE vendor_payments ADD COLUMN IF NOT EXISTS notes TEXT;
 ALTER TABLE vendor_payments ADD COLUMN IF NOT EXISTS status VARCHAR(20) DEFAULT 'completed'::character varying;
 ALTER TABLE vendor_payments ADD COLUMN IF NOT EXISTS created_by INTEGER;
 ALTER TABLE vendor_payments ADD COLUMN IF NOT EXISTS created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
 ALTER TABLE vendors ADD COLUMN IF NOT EXISTS name VARCHAR(200);
 ALTER TABLE vendors ADD COLUMN IF NOT EXISTS contact_person VARCHAR(100);
 ALTER TABLE vendors ADD COLUMN IF NOT EXISTS email VARCHAR(100);
 ALTER TABLE vendors ADD COLUMN IF NOT EXISTS phone VARCHAR(50);
 ALTER TABLE vendors ADD COLUMN IF NOT EXISTS address TEXT;
 ALTER TABLE vendors ADD COLUMN IF NOT EXISTS city VARCHAR(100);
 ALTER TABLE vendors ADD COLUMN IF NOT EXISTS country VARCHAR(100) DEFAULT 'Kenya'::character varying;
 ALTER TABLE vendors ADD COLUMN IF NOT EXISTS tax_pin VARCHAR(50);
 ALTER TABLE vendors ADD COLUMN IF NOT EXISTS payment_terms INTEGER DEFAULT 30;
 ALTER TABLE vendors ADD COLUMN IF NOT EXISTS currency VARCHAR(10) DEFAULT 'KES'::character varying;
 ALTER TABLE vendors ADD COLUMN IF NOT EXISTS notes TEXT;
 ALTER TABLE vendors ADD COLUMN IF NOT EXISTS is_active BOOLEAN DEFAULT true;
 ALTER TABLE vendors ADD COLUMN IF NOT EXISTS created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
 ALTER TABLE vendors ADD COLUMN IF NOT EXISTS updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
 ALTER TABLE vlan_history ADD COLUMN IF NOT EXISTS vlan_record_id INTEGER;
 ALTER TABLE vlan_history ADD COLUMN IF NOT EXISTS in_octets BIGINT DEFAULT 0;
 ALTER TABLE vlan_history ADD COLUMN IF NOT EXISTS out_octets BIGINT DEFAULT 0;
 ALTER TABLE vlan_history ADD COLUMN IF NOT EXISTS in_rate BIGINT DEFAULT 0;
 ALTER TABLE vlan_history ADD COLUMN IF NOT EXISTS out_rate BIGINT DEFAULT 0;
 ALTER TABLE vlan_history ADD COLUMN IF NOT EXISTS recorded_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
 ALTER TABLE whatsapp_conversations ADD COLUMN IF NOT EXISTS chat_id VARCHAR(100);
 ALTER TABLE whatsapp_conversations ADD COLUMN IF NOT EXISTS phone VARCHAR(30);
 ALTER TABLE whatsapp_conversations ADD COLUMN IF NOT EXISTS contact_name VARCHAR(150);
 ALTER TABLE whatsapp_conversations ADD COLUMN IF NOT EXISTS customer_id INTEGER;
 ALTER TABLE whatsapp_conversations ADD COLUMN IF NOT EXISTS is_group BOOLEAN DEFAULT false;
 ALTER TABLE whatsapp_conversations ADD COLUMN IF NOT EXISTS unread_count INTEGER DEFAULT 0;
 ALTER TABLE whatsapp_conversations ADD COLUMN IF NOT EXISTS last_message_at TIMESTAMP;
 ALTER TABLE whatsapp_conversations ADD COLUMN IF NOT EXISTS last_message_preview TEXT;
 ALTER TABLE whatsapp_conversations ADD COLUMN IF NOT EXISTS status VARCHAR(20) DEFAULT 'active'::character varying;
 ALTER TABLE whatsapp_conversations ADD COLUMN IF NOT EXISTS assigned_to INTEGER;
 ALTER TABLE whatsapp_conversations ADD COLUMN IF NOT EXISTS created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
 ALTER TABLE whatsapp_conversations ADD COLUMN IF NOT EXISTS updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
 ALTER TABLE whatsapp_logs ADD COLUMN IF NOT EXISTS ticket_id INTEGER;
 ALTER TABLE whatsapp_logs ADD COLUMN IF NOT EXISTS recipient_phone VARCHAR(20);
 ALTER TABLE whatsapp_logs ADD COLUMN IF NOT EXISTS recipient_type VARCHAR(20);
 ALTER TABLE whatsapp_logs ADD COLUMN IF NOT EXISTS message TEXT;
 ALTER TABLE whatsapp_logs ADD COLUMN IF NOT EXISTS status VARCHAR(20) DEFAULT 'pending'::character varying;
 ALTER TABLE whatsapp_logs ADD COLUMN IF NOT EXISTS sent_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
 ALTER TABLE whatsapp_logs ADD COLUMN IF NOT EXISTS order_id INTEGER;
 ALTER TABLE whatsapp_logs ADD COLUMN IF NOT EXISTS complaint_id INTEGER;
 ALTER TABLE whatsapp_logs ADD COLUMN IF NOT EXISTS message_type VARCHAR(50) DEFAULT 'custom'::character varying;
 ALTER TABLE whatsapp_messages ADD COLUMN IF NOT EXISTS conversation_id INTEGER;
 ALTER TABLE whatsapp_messages ADD COLUMN IF NOT EXISTS message_id VARCHAR(150);
 ALTER TABLE whatsapp_messages ADD COLUMN IF NOT EXISTS direction VARCHAR(10) DEFAULT 'incoming'::character varying;
 ALTER TABLE whatsapp_messages ADD COLUMN IF NOT EXISTS sender_phone VARCHAR(30);
 ALTER TABLE whatsapp_messages ADD COLUMN IF NOT EXISTS sender_name VARCHAR(150);
 ALTER TABLE whatsapp_messages ADD COLUMN IF NOT EXISTS message_type VARCHAR(30) DEFAULT 'text'::character varying;
 ALTER TABLE whatsapp_messages ADD COLUMN IF NOT EXISTS body TEXT;
 ALTER TABLE whatsapp_messages ADD COLUMN IF NOT EXISTS media_url TEXT;
 ALTER TABLE whatsapp_messages ADD COLUMN IF NOT EXISTS media_mime_type VARCHAR(100);
 ALTER TABLE whatsapp_messages ADD COLUMN IF NOT EXISTS media_filename VARCHAR(255);
 ALTER TABLE whatsapp_messages ADD COLUMN IF NOT EXISTS is_read BOOLEAN DEFAULT false;
 ALTER TABLE whatsapp_messages ADD COLUMN IF NOT EXISTS is_delivered BOOLEAN DEFAULT false;
 ALTER TABLE whatsapp_messages ADD COLUMN IF NOT EXISTS sent_by INTEGER;
 ALTER TABLE whatsapp_messages ADD COLUMN IF NOT EXISTS timestamp TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
 ALTER TABLE whatsapp_messages ADD COLUMN IF NOT EXISTS raw_data JSONB;
 ALTER TABLE whatsapp_messages ADD COLUMN IF NOT EXISTS created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
 ALTER TABLE wireguard_peers ADD COLUMN IF NOT EXISTS server_id INTEGER;
 ALTER TABLE wireguard_peers ADD COLUMN IF NOT EXISTS name VARCHAR(100);
 ALTER TABLE wireguard_peers ADD COLUMN IF NOT EXISTS description TEXT;
 ALTER TABLE wireguard_peers ADD COLUMN IF NOT EXISTS public_key TEXT;
 ALTER TABLE wireguard_peers ADD COLUMN IF NOT EXISTS private_key_encrypted TEXT;
 ALTER TABLE wireguard_peers ADD COLUMN IF NOT EXISTS preshared_key_encrypted TEXT;
 ALTER TABLE wireguard_peers ADD COLUMN IF NOT EXISTS allowed_ips TEXT;
 ALTER TABLE wireguard_peers ADD COLUMN IF NOT EXISTS endpoint VARCHAR(255);
 ALTER TABLE wireguard_peers ADD COLUMN IF NOT EXISTS persistent_keepalive INTEGER DEFAULT 25;
 ALTER TABLE wireguard_peers ADD COLUMN IF NOT EXISTS last_handshake_at TIMESTAMP;
 ALTER TABLE wireguard_peers ADD COLUMN IF NOT EXISTS rx_bytes BIGINT DEFAULT 0;
 ALTER TABLE wireguard_peers ADD COLUMN IF NOT EXISTS tx_bytes BIGINT DEFAULT 0;
 ALTER TABLE wireguard_peers ADD COLUMN IF NOT EXISTS is_active BOOLEAN DEFAULT true;
 ALTER TABLE wireguard_peers ADD COLUMN IF NOT EXISTS is_olt_site BOOLEAN DEFAULT false;
 ALTER TABLE wireguard_peers ADD COLUMN IF NOT EXISTS olt_id INTEGER;
 ALTER TABLE wireguard_peers ADD COLUMN IF NOT EXISTS created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
 ALTER TABLE wireguard_peers ADD COLUMN IF NOT EXISTS updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
 ALTER TABLE wireguard_servers ADD COLUMN IF NOT EXISTS name VARCHAR(100);
 ALTER TABLE wireguard_servers ADD COLUMN IF NOT EXISTS enabled BOOLEAN DEFAULT true;
 ALTER TABLE wireguard_servers ADD COLUMN IF NOT EXISTS interface_name VARCHAR(20) DEFAULT 'wg0'::character varying;
 ALTER TABLE wireguard_servers ADD COLUMN IF NOT EXISTS interface_addr VARCHAR(50);
 ALTER TABLE wireguard_servers ADD COLUMN IF NOT EXISTS listen_port INTEGER DEFAULT 51820;
 ALTER TABLE wireguard_servers ADD COLUMN IF NOT EXISTS public_key TEXT;
 ALTER TABLE wireguard_servers ADD COLUMN IF NOT EXISTS private_key_encrypted TEXT;
 ALTER TABLE wireguard_servers ADD COLUMN IF NOT EXISTS preshared_key_encrypted TEXT;
 ALTER TABLE wireguard_servers ADD COLUMN IF NOT EXISTS mtu INTEGER DEFAULT 1420;
 ALTER TABLE wireguard_servers ADD COLUMN IF NOT EXISTS dns_servers VARCHAR(255);
 ALTER TABLE wireguard_servers ADD COLUMN IF NOT EXISTS post_up_cmd TEXT;
 ALTER TABLE wireguard_servers ADD COLUMN IF NOT EXISTS post_down_cmd TEXT;
 ALTER TABLE wireguard_servers ADD COLUMN IF NOT EXISTS health_status VARCHAR(50) DEFAULT 'unknown'::character varying;
 ALTER TABLE wireguard_servers ADD COLUMN IF NOT EXISTS last_handshake_at TIMESTAMP;
 ALTER TABLE wireguard_servers ADD COLUMN IF NOT EXISTS created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
 ALTER TABLE wireguard_servers ADD COLUMN IF NOT EXISTS updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
 ALTER TABLE wireguard_settings ADD COLUMN IF NOT EXISTS setting_key VARCHAR(100);
 ALTER TABLE wireguard_settings ADD COLUMN IF NOT EXISTS setting_value TEXT;
 ALTER TABLE wireguard_settings ADD COLUMN IF NOT EXISTS created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
 ALTER TABLE wireguard_settings ADD COLUMN IF NOT EXISTS updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
 ALTER TABLE wireguard_subnets ADD COLUMN IF NOT EXISTS vpn_peer_id INTEGER;
 ALTER TABLE wireguard_subnets ADD COLUMN IF NOT EXISTS network_cidr VARCHAR(50);
 ALTER TABLE wireguard_subnets ADD COLUMN IF NOT EXISTS description VARCHAR(255);
 ALTER TABLE wireguard_subnets ADD COLUMN IF NOT EXISTS subnet_type VARCHAR(50) DEFAULT 'management'::character varying;
 ALTER TABLE wireguard_subnets ADD COLUMN IF NOT EXISTS is_olt_management BOOLEAN DEFAULT false;
 ALTER TABLE wireguard_subnets ADD COLUMN IF NOT EXISTS is_tr069_range BOOLEAN DEFAULT false;
 ALTER TABLE wireguard_subnets ADD COLUMN IF NOT EXISTS is_active BOOLEAN DEFAULT true;
 ALTER TABLE wireguard_subnets ADD COLUMN IF NOT EXISTS created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
 ALTER TABLE wireguard_sync_logs ADD COLUMN IF NOT EXISTS server_id INTEGER;
 ALTER TABLE wireguard_sync_logs ADD COLUMN IF NOT EXISTS success BOOLEAN DEFAULT false;
 ALTER TABLE wireguard_sync_logs ADD COLUMN IF NOT EXISTS message TEXT;
 ALTER TABLE wireguard_sync_logs ADD COLUMN IF NOT EXISTS synced_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP;
